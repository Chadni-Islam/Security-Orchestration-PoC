,id,taskid,type,name,description,scriptName ,tags,condition,scriptarguments,nexttasks,conditions
0,0,9191bc70-1a40-4150-83d9-66731d89243f,start,,,,,,,,
0,3,c4b25dd8-ef84-429f-8edc-a162b3dbf000,playbook,Account Enrichment - Generic,Enrich Accounts using one or more integrations,,,,,,
0,4,e0ffa563-92e4-428b-81ed-c0fe3eeeb2f7,title,Interact with the user,,,,,,,
0,5,343205d4-9062-4954-8d57-ac3ab134d5f6,title,Enrich indicators,,,,,,,
0,8,faf6fad5-f040-47b2-8802-73c06b1ef6d2,title,Enrich source IP,,,,,,,
0,9,f4690b1b-98cd-4309-82be-53e760d502ee,title,Enrich destination IP,,,,,,,
0,10,f68c6b42-4b24-426c-81e0-417984626f2a,title,Enrich source user,,,,,,,
0,11,7b6dfef6-28ec-4daf-8b44-e0d813674886,condition,Does the source user account have an email address?,Verify that the source user account has an associated email address.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'Account.Username'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}, 'ignorecase': True}]], 'accessor': 'Email.Address', 'transformers': [{'operator': 'general.uniq'}]}}, 'iscontext': True}}]]}"
0,12,7a5f3223-0418-418a-8872-ca221ab74c5a,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'Account.Username'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}, 'ignorecase': True}]], 'accessor': 'Email.Address', 'transformers': [{'operator': 'general.uniq'}]}}, 'iscontext': True}}]]}"
0,13,0e9d5518-3755-4d4b-8254-631b021ad18a,regular,Request user to confirm account activity,Send an email to the source user email address to confirm whether they recognize the suspicious activity.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'Account.Username'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}, 'ignorecase': True}]], 'accessor': 'Email.Address', 'transformers': [{'operator': 'general.uniq'}]}}, 'iscontext': True}}]]}"
0,14,cf2e6c57-c2cb-41cb-822d-eb13f2658fee,condition,Get user response,Use the user response (yes or no) to direct the playbook.,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'Account.Username'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}, 'ignorecase': True}]], 'accessor': 'Email.Address', 'transformers': [{'operator': 'general.uniq'}]}}, 'iscontext': True}}]]}"
0,17,10c28bdf-caae-47d7-8c1b-c5a7198b2349,condition,Was the manager's ID returned?,Verify that the manager ID (DN) of the source user account was returned in context.,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,19,6ba49d12-a2e7-40bb-85d2-2a7849adc774,regular,Get manager's info,Retrieve the AD account information for the manager of the source user account.,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,20,160c3d44-9b6f-4207-8df9-69f7c6ac3eb7,playbook,IP Enrichment - Generic,,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,21,74b00019-68dc-4e52-8b6e-8eb97721b8cb,playbook,IP Enrichment - Generic,,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,22,e0dc594d-6a63-47e7-85d1-cadb733f3544,title,User confirmed account activity,,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,23,d78f9aeb-aaab-47c1-8359-4518d529c00a,title,User denied account activity,,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,24,7201e19f-4202-41ec-8b24-246679d7621f,regular,Set severity to low,Set the incident severity to low.,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,25,eb5afea3-4cbc-4ec6-82f5-d9b80ac4ed1b,regular,Close Investigation,Close the investigation.,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,26,38e9a862-18da-401c-88e7-9ed6e2b0e9a4,regular,Set severity to high,Set the incident severity to high.,,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,27,b914ceed-2615-4c1b-8d64-74b2a8da5cd0,regular,Assign to analyst,"Assign the incident to an analyst based on the analyst’s organizational role.
",,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,28,8ae1ca42-1f1d-4ae7-883e-814705b8aae2,regular,Manually remediate  the incident,"Review the incident to determine if the account activity is malicious.

If malicious, consider the following:
* Quarantine the account/ endpoint 
* Revoke the account password
* Query the account/ IPs logs in the SIEM
* Block the external IPs in the firewall/ proxy
* Check the account's privileges and change if needed",,AccessQ1,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Account', 'accessor': 'Manager'}}, 'iscontext': True}}]]}"
0,0,9191bc70-1a40-4150-83d9-66731d89243f,start,,,,,,,,
0,1,0397e09e-ea98-47a4-8148-7df722f74fe4,title,QRadar alert,,,,,,,
0,2,6f12a822-db6c-40b7-813d-714a77e77f1f,playbook,QRadar - Get offense correlations,,,,,,,
0,3,552536df-def5-4b43-862d-27dfd4fc368b,playbook,Access Investigation - Generic,,,,,,,
0,4,f5971b5b-220a-4d33-814f-5a1b428cc6b5,title,Investigate access incident,,,,,,,
0,5,12caaa45-7f58-4a12-8c36-319eaa965335,title,Done,,,,,,,
0,7,062be244-4158-4ac7-8f2b-ce9e6693ccca,regular,Set QRadar information into access custom fields,"Set the information retrieved from QRadar into the access incident custom fields:
* Dest
* Src
* Src User",,,,,,
0,0,065b25dc-7aad-4356-8bee-261b189251b3,start,,,,,,,,
0,1,be4d8a4d-14b5-4541-8d40-1df25ef145c6,condition,Is AD configured?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,2,c7455a4b-be90-45c3-83be-a290e2660432,regular,Query AD to get user details,Query “Active Directory” for the email address info,,,,,,
0,3,561f7e3c-e8cf-4f68-8bbe-64c7cb608995,title,User Enrichment Done,,,,,,,
0,4,7e9ec3ab-29e0-458a-8a61-7ca559f4b428,condition,Check if there is an Email address,Check if there is an Email address.,,,,,,
0,0,03bb7183-afc8-4bcd-8f32-5c35d41fdcad,start,,,,,,,,
0,1,8dcf9277-f035-41b2-8165-8ea8d70541a4,condition,Is there a username to query?,Checks if there's a username to query,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,2,97aaf60a-4203-4577-8548-a61287d8b988,title,Active Directory,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,3,b3c42fed-7e9b-428e-8fd6-142c05a2cbd1,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,4,64684715-e0fd-44e4-8ba8-973e87eec920,condition,Is Active Directory enabled?,"Checks if there's an active ""Active Directory"" instance",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,5,1f64970f-99a7-477e-83c0-f54dc2e7e4ec,regular,Get Account info from Active Directory,"Query ""Active Directory"" for the username's info",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,7,34d20cba-51b1-4f99-8689-7b1bf0e108f4,condition,Is Active Directory v2 enabled?,"Checks if there's an active ""Active Directory"" instance",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,8,35f69528-ad0b-4672-8864-c4e62cb11c4f,regular,Get Account info from Active Directory,"Retrieves detailed information about a user account. The user can be specified by name, email address, or as an Active Directory Distinguished Name (DN). If no filter is specified, all users are returned.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,0,03bb7183-afc8-4bcd-8f32-5c35d41fdcad,start,,,,,,,,
0,1,f4d7cbdd-cd4a-48bd-8360-740b97fba2e0,condition,Is there an account to enrich?,Checks if there is at least one username to enrich.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,3,ee0fc2dd-d3aa-4e72-82ac-f12d9bd4a9fa,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,4,98e13761-b371-4380-8815-9081204309db,condition,Is Active Directory Query v2 enabled?,Checks if there’s an active instance of the Active Directory Query v2 integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Active Directory Query v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,5,97ec5ca3-8754-49ff-8797-627ef7e6cd33,regular,Get account info from Active Directory,Queries Active Directory and returns information for the specified username.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Active Directory Query v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,0,03bb7183-afc8-4bcd-8f32-5c35d41fdcad,start,,,,,,,,
0,1,f4d7cbdd-cd4a-48bd-8360-740b97fba2e0,condition,Is there an account to enrich?,Checks if there is at least one username to enrich.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,3,ee0fc2dd-d3aa-4e72-82ac-f12d9bd4a9fa,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,4,6d452be6-9cf3-47e7-8424-180ff698cb8b,condition,Is Active Directory enabled?,Checks if there is an active instance of the Active Directory integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'activedir'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,5,34511610-25f6-4cba-88be-5efe1ce7a69e,regular,Get account info from Active Directory,Queries Active Directory for the username's information.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'activedir'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,0,065b25dc-7aad-4356-8bee-261b189251b3,start,,,,,,,,
0,1,be4d8a4d-14b5-4541-8d40-1df25ef145c6,condition,Is AD configured?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,2,c205b05d-8d32-47e8-8f88-a5a2ce0e86fa,regular,Query AD to get user details,,,,,,,
0,3,561f7e3c-e8cf-4f68-8bbe-64c7cb608995,title,User Enrichment Done,,,,,,,
0,0,e25e2919-33a2-4f71-8465-f9099c562d10,start,,,,,,,,
0,3,2874eab4-7137-43d3-8ff4-4be014c9b7b0,condition,Is MineMeld enabled?,"Verify that there is a valid instance of Minemeld enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Palo Alto Minemeld'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,4,d09ed85f-25e6-481e-8529-5e74257252e6,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Palo Alto Minemeld'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,6,c588f1f8-6de6-40e5-8933-080fcf299252,title,Add indicator to the Miner,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Palo Alto Minemeld'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,7,e545269b-d484-46e7-8e04-a067bc76d086,condition,Verify indicator and Miner name,"Verify that the playbook input includes the following inputs:
* MineMeld Miner
* Indicators (one or more)",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Indicator'}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.MinerName'}, 'iscontext': True}}]]}"
0,8,9209143b-1ebc-409a-8de7-c5c45dcd561f,regular,Add indicator to Miner,Add Indictor to the MineMeld Miner.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Indicator'}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.MinerName'}, 'iscontext': True}}]]}"
0,0,438120e9-1d87-4bf5-8b48-1000633050e3,start,,start,,,,,,
0,2,474e6e86-127d-46e3-8a9e-9efee132001a,regular,archer-get-file,Downloads file from Archer to Demisto's context,,,,,,
0,0,d042890c-556f-415a-8b61-a12119407553,start,,,,,,,,
0,1,f8237bac-e860-407c-810a-1a5ce6e14802,regular,Arcsight - Get Case info,Get a specific case from ESM,,,,,,
0,2,a53d4bfb-3250-4e1f-8014-2c5d0a19e5cf,regular,Arcsight - get Event ID below the Case,Returns all case event IDs,,,,,,
0,3,b5fab90a-0f15-40ba-8233-43ed42be978c,regular,Get the Events below the Case,,,,,,,
0,4,3371774c-a2ba-4ea3-8acb-aaeeae8195f7,condition,Is FetchID set?,,,,,,,
0,5,a8d523d4-a25e-45a9-8553-fccb9b49d585,condition,Is ID label included?,,,,,,,
0,7,00fc9870-1af2-47d1-828b-24dbbd6f02cc,regular,User - please insert Arcsight Case Resource ID,,,,,,,
0,9,c2788a78-f0a8-488e-887b-428e224ceaac,title,Get case and event info,,,,,,,
0,10,65602a3e-3b1f-4134-80f1-7f056a937775,regular,Get Base Events below the top-level event,,,,,,,
0,11,29025200-cf8e-4d69-80f1-166eb6b3a034,condition,Does Case included IDs for related Events?,,,,,,,
0,12,5c12898b-66b7-4400-8ff9-f7c3632c007a,title,Done,,,,,,,
0,13,6b37cdf2-9072-49ae-848c-ea00e953a603,condition,Do we have IDs for underlying base events?,,,,,,,
0,18,ca867694-bf54-4fe8-85cd-946633455ef9,regular,Set FetchID from user input,Change the properties of an incident,,,,,,
0,19,b0d9eacc-8d9f-4345-8a1e-ac1b94c1c018,regular,Set FetchID <-- ID label,Change the properties of an incident,,,,,,
0,0,bb01d4bd-76d4-4d60-897b-d169fc413163,start,,Playbook start point,,,,,,
0,5,7c6ff621-6640-4c67-8fda-45c0fbb577ac,condition,Is ATD Available?,"Verify that there is a valid instance of McAfee ATD enabled.
",,,,,,
0,6,35ddeef4-f49f-493d-8679-80624dd4d1d8,title,End,,,,,,,
0,7,b9b463d1-6023-4afe-8a69-cdcb3de19822,condition,Is there a file to detonate?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,8,626ec891-11a0-41af-8432-5e7efabe0d2b,regular,ATD - Detonate File,etonate the file in McAfee ATD,,,,,,
0,0,bb01d4bd-76d4-4d60-897b-d169fc413163,start,,Playbook start point,,,,,,
0,5,7c6ff621-6640-4c67-8fda-45c0fbb577ac,condition,Is ATD Available?,"Verify that there is a valid instance of McAfee ATD enabled.
",,,,,,
0,6,35ddeef4-f49f-493d-8679-80624dd4d1d8,title,End,,,,,,,
0,7,b9b463d1-6023-4afe-8a69-cdcb3de19822,condition,Is there a file to detonate?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,8,626ec891-11a0-41af-8432-5e7efabe0d2b,regular,ATD - Detonate File,etonate the file in McAfee ATD,,,,,,
0,0,cf22dcbc-af9c-42fa-8963-205d412e6965,start,,,,,,,,
0,2,19ace356-7eb1-491e-8b42-9d755950312c,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,5,aa6d7b50-e89e-4046-8245-91d4e430544d,title,Done,,,,,,,
0,6,840243b7-07df-471e-8cab-7dc8080ce28c,condition,Is there a File to scan?,Look for files to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,7,03079660-b680-41d1-847d-4d667e3bc404,condition,Is BitDam enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'BitDam'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,2610cf49-d119-4065-861c-c7b3a5ffd0c8,regular,BitDam Get Verdict,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'BitDam'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,9,5f4539b9-bf85-42e5-8892-f12714a02869,regular,Set file to context,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'BitDam'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,699619cb-33c2-4b32-88ef-ba0844c2cddf,condition,Is File type supported?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PDF|DOT|DOCX|DOCM|DOTX|DOTM|RTF|XLS|XLT|XLSX|XLSM|XLTX|XLTM|XLSB|XLAM|CSV|PPT|PPTX|PPTM|POTX|POTM|PPAM|PPSX|PPSM|PPS)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PDF|DOT|DOCX|DOCM|DOTX|DOTM|RTF|XLS|XLT|XLSX|XLSM|XLTX|XLTM|XLSB|XLAM|CSV|PPT|PPTX|PPTM|POTX|POTM|PPAM|PPSX|PPSM|PPS)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PDF|DOT|DOCX|DOCM|DOTX|DOTM|RTF|XLS|XLT|XLSX|XLSM|XLTX|XLTM|XLSB|XLAM|CSV|PPT|PPTX|PPTM|POTX|POTM|PPAM|PPSX|PPSM|PPS)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,12,5e010413-b8e7-4562-8fc6-cddc2168851f,regular,BItDam Upload File,Upload a file sample to BitDam's service,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PDF|DOT|DOCX|DOCM|DOTX|DOTM|RTF|XLS|XLT|XLSX|XLSM|XLTX|XLTM|XLSB|XLAM|CSV|PPT|PPTX|PPTM|POTX|POTM|PPAM|PPSX|PPSM|PPS)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PDF|DOT|DOCX|DOCM|DOTX|DOTM|RTF|XLS|XLT|XLSX|XLSM|XLTX|XLTM|XLSB|XLAM|CSV|PPT|PPTX|PPTM|POTX|POTM|PPAM|PPSX|PPSM|PPS)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PDF|DOT|DOCX|DOCM|DOTX|DOTM|RTF|XLS|XLT|XLSX|XLSM|XLTX|XLTM|XLSB|XLAM|CSV|PPT|PPTX|PPTM|POTX|POTM|PPAM|PPSX|PPSM|PPS)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,0,b95110b7-ba18-42a5-87ad-c5d37915401c,start,,,,,,,,
0,2,1808d949-f921-4957-8796-7bbedd822ad9,title,Done,,,,,,,
0,5,0b958771-7e06-4239-899f-f7d133be6938,title,Block accounts,,,,,,,
0,8,2c5a17dd-e019-4e20-8f5b-4333678a26e0,condition,Is there a username to block?,Verify that the playbook input includes at least one username to block.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Username'}, 'iscontext': True}}]]}"
0,12,5da07472-33bb-451d-8562-365e05f456ec,condition,Is Active Directory enabled?,"Verify that there is a valid instance of Active Directory enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'activedir'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,13,c8b9285e-4d21-4070-89b6-33c611531812,regular,Disable account in active directory,Disable the account using Active Directory.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'activedir'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,0,73040a0e-cca5-4197-8089-f46650317040,start,,,,,,,,
0,2,81cfb3e4-cb04-4c91-8bc7-d23980939d7e,regular,Get host information from Carbon Black Enterprise Response,Query  Carbon Black Enterprise Response for the host,,,,,,
0,3,36d3a39d-ae26-4db6-8ed5-228172276852,regular,Isolate hostname,Carbon Black Response - isolate the host,,,,,,
0,4,d35be2d6-6709-40d0-846e-dc9aef142e30,title,Done,,,,,,,
0,5,27405cc3-bf4c-4879-87ad-880b99941e9a,condition,Is Carbon Black Enterprise Response enabled?,Check if Carbon black active in the system.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'carbonblack'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,0,5e4385e3-76c2-48e2-80a4-c3798cdae027,start,,,,,,,,
0,1,0ee119bc-c1cf-435e-866c-69c8273f8e0d,regular,Add the MD5 to the blacklist,"Adds the MD5 hash to the blacklist in Carbon Black, which blocks the execution of files with that hash on the managed endpoints.",,,,,,
0,2,f4665f30-1aca-401f-8011-8f6b76ee97ca,regular,Get a list of blacklisted hashes,"Returns a list of blacklisted hashes, with each list entry describing one blacklisted hash.",,,,,,
0,4,82a3b953-f23a-4292-8662-14f58fe4e337,condition,Is the MD5 currently blacklisted?,Checks whether the MD5 is already on the blacklist. This prevents blacklisting an MD5 hash that is already blacklisted.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'CbResponse.BlockedHashes.MD5'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.MD5'}, 'iscontext': True}}], [{'operator': 'isTrue', 'left': {'value': {'simple': 'CbResponse.BlockedHashes.Enabled'}, 'iscontext': True}}]]}"
0,5,1447c8cb-2fa3-43ee-80d6-128a35bdcefa,title,Hash Is Already Blocked,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'CbResponse.BlockedHashes.MD5'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.MD5'}, 'iscontext': True}}], [{'operator': 'isTrue', 'left': {'value': {'simple': 'CbResponse.BlockedHashes.Enabled'}, 'iscontext': True}}]]}"
0,6,351582dc-a7a4-4ea0-843a-59c6770d0285,condition,Is Carbon Black Enterprise Response enabled?,Checks if Carbon Black Enterprise Response integration is enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'carbonblack-v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,7,bcd55436-7475-40ae-8cf1-e7e94ca27567,title,No Integration / No MD5,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'carbonblack-v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,8,ff0935b7-054b-4729-82a3-5588d553d9d0,condition,Is there an MD5 to block?,"Checks if there is a value for the MD5 input field. This task does not verify that the value is actually an MD5 hash, just that the value for the MD5 field exists.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.MD5'}, 'iscontext': True}}]]}"
0,9,2c14bf01-7fd9-45f8-8554-86d0c1332d81,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.MD5'}, 'iscontext': True}}]]}"
0,0,49ac9316-5f77-48f9-8d21-9f05c335c2e4,start,,,,,,,,
0,2,e3fbf02a-78a1-4329-837e-a6116bcf92af,playbook,Block File - Carbon Black Response,,,,,,,
0,3,fceba42b-c11f-4521-8b0a-f86d410adc0e,title,Done,,,,,,,
0,0,b95110b7-ba18-42a5-87ad-c5d37915401c,start,,,,,,,,
0,2,1808d949-f921-4957-8796-7bbedd822ad9,title,Done,,,,,,,
0,3,8102ebf2-e72a-4139-8532-fc4e3e1f0ba2,playbook,Block IP - Generic,,,,,,,
0,4,0b19553d-6281-43ac-8bfc-583b1bfd6171,playbook,Block URL - Generic,,,,,,,
0,5,ba10aaed-dffd-4eae-8dcd-16807997f52f,playbook,Block Account - Generic,"This playbook blocks malicious usernames using all integrations that you have enabled.

Supported integrations for this playbook:
* Active Directory",,,,,,
0,7,903a8a58-46c8-4ab0-8b6e-d83e35f442fb,title,Block indicators,,,,,,,
0,8,90693a3c-4767-46ac-8199-0bc4706264bf,playbook,Block File - Generic,,,,,,,
0,0,b95110b7-ba18-42a5-87ad-c5d37915401c,start,,,,,,,,
0,2,1808d949-f921-4957-8796-7bbedd822ad9,title,Done,,,,,,,
0,5,cea4b9a9-d2a5-42c6-84e7-7eab6d6ab7a8,title,Block IPs,,,,,,,
0,6,077714b6-f53e-4ab4-8679-d2c172e67a59,regular,Block IP with Check Point Firewall,Block the IPs using Check Point Firewall.,,,,,,
0,7,cc26e2d3-b22c-4e90-819e-5a1dc485c2db,condition,Is Check Point Firewall enabled?,Verify that there is a valid instance of Check Point Firewall enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Check Point'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'Active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,8,3f8eeba3-99f9-484c-8f73-a0c6d9bd02bb,condition,Is there an IP to block?,Verify that the playbook input includes at least one IP to block.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,9,bebb5a4e-9e67-4334-86e2-4cf1064abc72,condition,Is Palo Alto Networks Panorama enabled?,Verify that there is a valid instance of Palo Alto Networks Panorama enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,10,7e800325-00ed-4c5a-8838-a40f28680299,regular,Block IP with Palo Alto Networks Panorama,Block the IPs using Palo Alto Networks Panorama.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,11,dbee1e60-454a-4043-8676-7f5bb3006b00,playbook,Add Indicator to Miner - Minemeld,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,12,43617e2e-a00d-4569-8d43-80b6e732798e,condition,Is Zscaler enabled?,Verify that there is a valid instance of Zscaler enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Zscaler'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,13,6c6d1f99-8689-49d7-8c7c-f9ddcdd2a782,regular,Block IP with Zscaler,Block the IPs using Zscaler.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Zscaler'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,0,b95110b7-ba18-42a5-87ad-c5d37915401c,start,,,,,,,,
0,2,1808d949-f921-4957-8796-7bbedd822ad9,title,Done,,,,,,,
0,5,f414f4c2-03f8-4219-8428-048557b1758b,title,Block URLs,,,,,,,
0,8,ad6bb4b2-ea87-4c6e-893c-a31e27e82e55,condition,Is there a URL to block?,Verify that the playbook input includes at least one URL to block.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,11,2d0fc7d4-b827-43c9-8b7a-bf592e7a1c1f,playbook,Add Indicator to Miner - Minemeld,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,12,a2108a1a-7365-45e7-8c07-a5a6fcdd8b95,condition,Is Zscaler enabled?,Verify that there is a valid instance of Zscaler enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Zscaler'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,13,adb7b441-33c8-4fe9-8883-7af9a776e0d3,regular,Block URL with Zscaler,Block the URLS using Zscaler.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Zscaler'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,0,b0106ff2-1f84-4336-811c-501b301327a3,start,start_task,,,,,,,
0,1,6bb644a4-ab7a-4f6c-82ff-c2543048a30d,title,Prepare,,,,,,,
0,2,3608118f-e307-4a7e-8478-a74fe26a8747,regular,Trigger an update of our IoC repository from all available Threat Intel sources,,,,,,,
0,3,2ec8a165-89f6-44b7-8329-8258b97edec4,regular,Retrieve fresh lists of C&C IoCs from repository,"Retrieve IoCs from repository into the incident context - IP addresses, domains, URLs",,,,,,
0,4,e0c2eca8-a6bd-4924-835b-4264c1d5a673,title,Hunt,,,,,,,
0,5,efa206e7-f25b-44fe-8c31-8a8a8b322336,regular,Query netflow records for traffic to C&C IPs,Query the data repository where netflow records are continuously aggregated.,,,,,,
0,6,4ddbe71f-9a61-4f7c-8dd4-50673f386a1a,regular,Search web proxy logs for C&C URLs,,,,,,,
0,7,bbefe0d0-cde1-4f50-8bdc-f469f3c80264,regular,Search the organization's DNS server logs for C&C domains,,,,,,,
0,8,388ef341-1a5b-4352-8328-2af51d604196,regular,Search Endpoint monitoring infrastructure for communication with C&C IPs,,,,,,,
0,9,d36f548c-3e55-42e5-8059-73e1adf0371e,regular,Search Firewall and IPS logs for C&C IPs,Check if any traffic was attempted to a C&C IP and blocked by our Network Security controls such as Firewalls and IPSs,,,,,,
0,10,e8beb59e-d7fd-4bc4-8c5d-f29bfa3370ce,title,Validate findings,,,,,,,
0,11,20253d8e-c1d5-4918-82d1-aeac6837d061,condition,Did we uncover any suspected C&C communication?,,,,,,,
0,12,66696f7e-2a82-4d91-880d-a68502b214a5,regular,Review correlations with past investigations in case management / incident tracking,"Have any of our IoCs appeared in a past investigation? What did we know about them then, and what was the conclusion?",,,,,,
0,13,45237e6a-0780-41c5-8f55-d6aeefda3db1,regular,Review reputation data for each indicator,"Review displayed reputation data for IPs, domains and URLs using all reputation sources",,,,,,
0,14,69cd0199-8b53-4358-89ed-63677ad5c20c,condition,Is PassiveTotal Available?,,,,,,,
0,15,0f052e94-da1b-49b1-898f-4de332126b3f,regular,Review PassiveTotal enrichment data for the indicators,"Has PassiveTotal marked the domain as ""ever compromised""? Does it associate the domain with a known malware?",,,,,,
0,16,0d2eda66-3682-4884-892e-82d33324855d,condition,Is CrowdStrike Intel Available?,,,,,,,
0,17,2676407a-39f4-4dae-8f1e-b72e52bcd409,regular,Get and review CrowdStrike indicator information,,,,,,,
0,18,1127e16d-2f20-4090-89a2-e000f2cd9461,condition,Do the found IoCs include domain names?,,,,,,,
0,19,a71b6494-370c-486a-84ac-1a3c58118c11,regular,Review the domains' Whois information,,,,,,,
0,20,caae4dd9-e7c0-458c-84a9-90db5c2e6fac,regular,Retrieve DNS history for these domains,,,,,,,
0,21,c91818be-5898-46ee-8263-a2f531216e5e,regular,Review IP reputation for the IPs to which this domain resolved at the time,,,,,,,
0,22,5823c9d5-90cc-41cf-87c5-7b94b692f96e,regular,Summarize the list of validated malicious indicators,,,,,,,
0,23,b7ee6752-2787-4142-8802-0d3ae23033c7,title,Respond,,,,,,,
0,24,9ac6e273-1fa9-42e3-8367-031ce8a663f3,condition,Have any machines been confirmed as compromised?,,,,,,,
0,25,7b632ce1-d607-40a1-8704-1097f5df2e72,regular,Isolate compromised hosts from network,,,,,,,
0,26,1a83ba02-3043-423b-8f6e-b91e3ed5de09,regular,Disable compromised AD user account(s),"Block access to the compromised user account in AD pending investigation and cleanup, after which the account will be reinstated by an Active Directory administrator with the required permissions.",,,,,,
0,27,bd9b46ea-07eb-46ee-8308-46888a11640b,regular,"Lock / Rotate any other compromised accounts, keys and credentials","If the machine contained any authentication keys, accounts to internal company resources and information systems, these should be locked and revoked, and reinstated later with new passwords.",,,,,,
0,28,00d3bb90-f069-4f86-8b0d-b68573ec9ddc,condition,Is Slack Available?,,,,,,,
0,29,e7c70fba-f94f-4a02-8041-ef0bbf35baf0,regular,Retrieve the user's phone number from Active Directory,,,,,,,
0,30,9f4c6dba-dd4b-4673-86a8-19de7b29b237,condition,Is Twilio Available?,,,,,,,
0,31,dcf67394-61f2-49bb-8e0d-bc4fe64777b8,regular,Call the user and tell them that their machine is being isolated and investigated,,,,,,,
0,32,322e404d-bfed-49fd-824d-67dc96c95596,regular,SMS the user that their machine is being isolated and investigated,,,,,,,
0,33,3c17b8bd-e79e-4a02-8b1d-83e10fd749a8,regular,Tell the user on Slack that their machine is being isolated and investigated,,,,,,,
0,34,c43c578d-8337-42b4-8fbc-73e178f6d0d5,regular,Open separate incidents to further investigate each compromised host,,,,,,,
0,35,789a66bc-3116-4084-8c04-61b840d818ce,title,Remediate and Wrap up,,,,,,,
0,36,6f288fd3-3fb2-49af-8036-96f1063cd098,condition,Have the machines been cleaned successfully?,,,,,,,
0,37,ba3b890e-71b4-4f4d-8fd1-b33f295fd72e,regular,Open a ticket for IT to reimage the machine,,,,,,,
0,38,c3330605-13ed-4282-8d71-6150364e16d2,regular,Restore network access for cleaned up hosts,,,,,,,
0,39,bd76719e-c055-464d-868f-da361e6d134c,regular,Reinstate locked user accounts with new credentials,,,,,,,
0,40,a80fd4c5-d1b2-4095-88a8-242e4ae17db5,condition,Is Slack Available?,,,,,,,
0,41,b195772e-ba3d-4283-8cd5-2103d953285d,regular,Retrieve the user's phone number from Active Directory,,,,,,,
0,42,18edd09f-be16-4da9-872c-3934845a255d,condition,Is Twilio Available?,,,,,,,
0,43,2c7bfecc-9b5d-43ba-8e1b-a35265824fef,regular,Call the user and tell them that their accounts have been reinstated,,,,,,,
0,44,59e491df-f254-42fe-8e01-5956b8eba874,regular,SMS the user that their account has been reinstated,Optionally - include the temporary random password generated for the account. The user will have to choose a new password on first login.,,,,,,
0,45,5d519042-711d-4b60-826c-c3566049f1e6,regular,Notify the user via Slack that their account has been reinstated,Optionally - include the temporary random password generated for the account. The user will have to choose a new password on first login.,,,,,,
0,46,1a2dbd58-f17d-437d-8573-54a8339d3ccb,regular,Deploy validated IoCs with high confidence rating against future attacks,,,,,,,
0,47,e1c5da88-1515-496c-8501-1b5b4c504f93,regular,Share the validated IoCs with partner organizations,"Include any information gleaned about attribution to a known threat actor, especially if the actor is known to be targeting your industrial sector.",,,,,,
0,48,a5a8e072-2d12-46ad-8448-1c958924aa4d,regular,Issue report to CISO by email,,,,,,,
0,49,a38ffd8c-2fc9-4c28-8726-a9f59033aaca,regular,Expose Configured Integrations,,,,,,,
0,0,d1afa5d6-4a69-47ca-84a6-202ed4d1140f,start,,start,,,,,,
0,1,c787c282-0901-4da4-81a5-7d0361be8707,regular,Re-scan a domain,Initiates a re-scan of a domain that was already scanned.,,,,,,
0,2,469ba851-6113-4383-8abc-1fde81438f0f,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,6,2312cdca-7415-418f-8702-6c03401bf3db,regular,Get domain issues,Get the issues located under the provided domain.,,,,,,
0,8,b571543e-e4af-488c-8b0d-af3806f7ccc4,condition,Leaked credentials reported?,Checks if leaked credentials were reported.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'containsGeneral', 'left': {'value': {'complex': {'root': 'C2sec', 'accessor': 'Domain.Issue.Component'}}, 'iscontext': True}, 'right': {'value': {'simple': 'credential'}}}]]}"
0,9,4c4aaef8-4481-4daf-840d-a5e72041c222,regular,Get leaked credentials report,Retrieves a report for leaked credentials.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'containsGeneral', 'left': {'value': {'complex': {'root': 'C2sec', 'accessor': 'Domain.Issue.Component'}}, 'iscontext': True}, 'right': {'value': {'simple': 'credential'}}}]]}"
0,10,0eda1184-3b5b-4e9a-8510-56cdd0bd4c38,condition,Application vulnerabilities reported?,Checks if application vulnerabilities were reported.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'containsGeneral', 'left': {'value': {'simple': 'C2sec.Issue.component'}, 'iscontext': True}, 'right': {'value': {'simple': 'application'}}}]]}"
0,11,b530da9b-d948-4749-876d-455a61a35a6e,regular,Get application vulnerabilities report,Retrieves a report for application vulnerabilities.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'containsGeneral', 'left': {'value': {'simple': 'C2sec.Issue.component'}, 'iscontext': True}, 'right': {'value': {'simple': 'application'}}}]]}"
0,13,637adabc-b7f4-4227-88b8-fdba3ab17bd3,regular,Get network services exposed report,Retrieves a report for exposed network services.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'containsGeneral', 'left': {'value': {'simple': 'C2sec.Issue.component'}, 'iscontext': True}, 'right': {'value': {'simple': 'application'}}}]]}"
0,14,60398f3f-7ea9-4f3b-8b2f-51ceba4f8560,title,Done,Playbook finishes.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'containsGeneral', 'left': {'value': {'simple': 'C2sec.Issue.component'}, 'iscontext': True}, 'right': {'value': {'simple': 'application'}}}]]}"
0,15,8538fb1e-092a-4708-8dac-91aab140bf80,condition,Is C2sec enabled?,Checks is there is an active instance of the C2sec integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'C2sec irisk'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,16,0bb2491c-c83a-43b3-8266-57462038006e,regular,Query scan result,Retrieves the latest scan results from C2sec.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'C2sec irisk'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,3eded69b-617e-4212-86b7-2537474285f3,start,,,,,,,,
0,6,5f92bc72-085f-4c03-8404-82f83dac6c62,regular,"Set severity to ""High""",Set the severity level to High.,,,,,,
0,10,483350d5-ab17-44cd-87b3-0e2360ce3577,title,Done,,,,,,,
0,21,a91ad8e7-d063-4466-8137-711519c902f2,condition,Is there a Qualys severity?,Check if there is a “QualysSeverity” in the playbook inputs.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.QualysSeverity'}}, 'iscontext': True}}]]}"
0,22,52fae7c2-b907-4877-8a6a-ed1fbf0ad988,condition,Assign severity level based on Qualys vulnerability score,"Severity level is assigned according to:

* High = 4+
* Medium = 2-3
* Low = 1",,,,,,"{'label': 'HIGH', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.QualysSeverity', 'filters': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'inputs.QualysSeverity'}, 'iscontext': True}, 'right': {'value': {'simple': '4'}}}]]}}, 'iscontext': True}}]]}"
0,23,89c78898-8fef-4807-8a3d-1c4f042c4eb2,regular,"Set severity to ""Medium""",Set the severity level to Medium.,,,,,,"{'label': 'HIGH', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.QualysSeverity', 'filters': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'inputs.QualysSeverity'}, 'iscontext': True}, 'right': {'value': {'simple': '4'}}}]]}}, 'iscontext': True}}]]}"
0,24,84f71501-bcb9-481c-85d5-2efa59f1c1a4,regular,"Set severity to ""Low""",Set the severity level to Low.,,,,,,"{'label': 'HIGH', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.QualysSeverity', 'filters': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'inputs.QualysSeverity'}, 'iscontext': True}, 'right': {'value': {'simple': '4'}}}]]}}, 'iscontext': True}}]]}"
0,25,1487586f-f1f8-4136-8d7e-444a34750493,title,Calculate using Qualys Vulnerability Management,,,,,,,"{'label': 'HIGH', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.QualysSeverity', 'filters': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'inputs.QualysSeverity'}, 'iscontext': True}, 'right': {'value': {'simple': '4'}}}]]}}, 'iscontext': True}}]]}"
0,26,aa7b1201-afbc-4d7b-89f5-e21011257699,title,Calculate using Nexpose Vulnerability Management,,,,,,,"{'label': 'HIGH', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.QualysSeverity', 'filters': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'inputs.QualysSeverity'}, 'iscontext': True}, 'right': {'value': {'simple': '4'}}}]]}}, 'iscontext': True}}]]}"
0,27,9712ee01-9cb9-4dfa-80b3-aa3beadf990c,condition,Is there a Nexpose severity?,Check if there is a “NexposeSeverity” in the playbook inputs.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.NexposeSeverity'}}, 'iscontext': True}}]]}"
0,28,d5f43287-75c2-4799-8374-95677a68c876,condition,Assign severity level based on Nexpose vulnerability score,"Severity level is assigned according to:

* High = Critical
* Medium = Severe
* Low = Moderate",,,,,,"{'label': 'HIGH', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.NexposeSeverity', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'inputs.NexposeSeverity'}, 'iscontext': True}, 'right': {'value': {'simple': 'Critical'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,0,3eded69b-617e-4212-86b7-2537474285f3,start,,,,,,,,
0,7,75a46609-7bfd-4575-8945-2f9efd0cf549,title,Check for critical entities,,,,,,,
0,8,3856c4b6-073b-418e-8f17-5b768396bd92,condition,Is there a username?,"Check if there is a “username” in the playbook inputs.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'inputs.Account.Username'}, 'iscontext': True}}]]}"
0,9,3cf82887-19ce-4df3-8283-51151f9e773f,condition,"Is there a username on the ""CriticalUsers"" list?","Check if a username is on the ""CriticalUsers"" list.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'StringContainsArray', 'left': {'value': {'complex': {'root': 'inputs.CriticalUsers', 'transformers': [{'operator': 'join', 'args': {'separator': {}}}]}}, 'iscontext': True}, 'right': {'value': {'complex': {'root': 'inputs.Account', 'accessor': 'Username'}}, 'iscontext': True}}]]}"
0,10,483350d5-ab17-44cd-87b3-0e2360ce3577,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'StringContainsArray', 'left': {'value': {'complex': {'root': 'inputs.CriticalUsers', 'transformers': [{'operator': 'join', 'args': {'separator': {}}}]}}, 'iscontext': True}, 'right': {'value': {'complex': {'root': 'inputs.Account', 'accessor': 'Username'}}, 'iscontext': True}}]]}"
0,11,0b05b0cc-13d4-4486-8d8f-81c37b9a3d9f,regular,"Set severity to ""Critical""","Set the severity level to ""Critical"" (asset is par of a critical list).",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'StringContainsArray', 'left': {'value': {'complex': {'root': 'inputs.CriticalUsers', 'transformers': [{'operator': 'join', 'args': {'separator': {}}}]}}, 'iscontext': True}, 'right': {'value': {'complex': {'root': 'inputs.Account', 'accessor': 'Username'}}, 'iscontext': True}}]]}"
0,12,33af52c8-d90f-4ac0-87e0-3113e82a0b80,condition,Is there a hostname?,"Check if there is a ""hostname"" in the playbook inputs.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'inputs.Endpoint.Hostname'}, 'iscontext': True}}]]}"
0,13,925fd06c-a9a1-4a41-8dff-64eb5bd3664c,condition,"Is there a hostname on the ""CriticalEndpoints"" list?","Check if a hostname is on the ""CriticalEndpoints"" list.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'StringContainsArray', 'left': {'value': {'simple': 'inputs.CriticalEndpoints'}, 'iscontext': True}, 'right': {'value': {'complex': {'root': 'inputs.Endpoint', 'accessor': 'Hostname'}}, 'iscontext': True}}]]}"
0,15,731ac547-3975-48b5-85d0-e26a89643dc3,condition,"Is there an user account AD group that is part of the ""CriticalGroups"" list.","Check if an user account AD group in context is part of the ""CriticalGroups"" group.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'StringContainsArray', 'left': {'value': {'complex': {'root': 'inputs.CriticalGroups'}}, 'iscontext': True}, 'right': {'value': {'complex': {'root': 'inputs.Account', 'accessor': 'Groups'}}, 'iscontext': True}}]]}"
0,16,0cd3dad7-aab6-43cb-88d6-f8dd1f56c681,condition,"Is there an endpoint AD group that is part of the ""CriticalGroups"" list.","Check if an Endpoint AD group in context is part of the ""CriticalGroups"" group.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'StringContainsArray', 'left': {'value': {'simple': 'inputs.CriticalGroups'}, 'iscontext': True}, 'right': {'value': {'complex': {'root': 'inputs.Endpoint', 'accessor': 'Groups'}}, 'iscontext': True}}]]}"
0,17,14767daa-c047-4b25-8b0a-4ff39c7d131b,condition,Are there AD groups for an Endpoint?,Check if an endpoint has AD groups in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'inputs.Endpoint.Groups'}, 'iscontext': True}}]]}"
0,18,06676a0c-e523-4206-8b5a-15fea9e3d568,condition,Are there AD groups for a user account?,Check if a User account has AD groups in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'inputs.Account.Groups'}, 'iscontext': True}}]]}"
0,0,3eded69b-617e-4212-86b7-2537474285f3,start,,,,,,,,
0,7,75a46609-7bfd-4575-8945-2f9efd0cf549,title,Check for critical entities,,,,,,,
0,8,f4e2ace0-c9ab-4c54-841c-95d434cb7227,condition,Is there a username?,"Check if there is a “username” in the playbook inputs.
",,,,,,
0,9,ea578ea4-875c-4ae3-8162-7b41d864e2af,condition,"Is there a username on the ""CriticalUsers"" list?","Check if a username is on the ""CriticalUsers"" list.",,,,,,
0,10,483350d5-ab17-44cd-87b3-0e2360ce3577,title,Done,,,,,,,
0,11,0b05b0cc-13d4-4486-8d8f-81c37b9a3d9f,regular,"Set severity to ""Critical""","Set the severity level to ""Critical"" (asset is par of a critical list).",,,,,,
0,12,f6985ac2-dd5e-4865-817a-3d07de2da4da,condition,Is there a hostname?,"Check if there is a ""hostname"" in the playbook inputs.",,,,,,
0,13,1ed6f6b8-e7a7-452a-86ca-6f3d991c6f32,condition,"Is there a hostname on the ""CriticalEndpoints"" list?","Check if a hostname is on the ""CriticalEndpoints"" list.",,,,,,
0,15,b9ee1c8b-b8ec-4cd2-84b3-326aa728e80b,condition,"Is there an user account AD group that is part of the ""CriticalGroups"" list.","Check if an user account AD group in context is part of the ""CriticalGroups"" group.",,,,,,
0,16,4eab20ec-d53b-4267-80f7-2d78be5bbfb3,condition,"Is there an endpoint AD group that is part of the ""CriticalGroups"" list.","Check if an Endpoint AD group in context is part of the ""CriticalGroups"" group.",,,,,,
0,17,0946dd47-669f-45fb-8f16-8db390988570,condition,Are there AD groups for an Endpoint?,Check if an endpoint has AD groups in context.,,,,,,
0,18,febc930e-d0c6-4114-87cc-c0b1531d2adf,condition,Are there AD groups for a user account?,Check if a User account has AD groups in context.,,,,,,
0,0,3eded69b-617e-4212-86b7-2537474285f3,start,,,,,,,,
0,1,5d35b08e-ffa6-43f6-85c9-2e71151c47ec,title,Check indicators,,,,,,,
0,2,236ea4d7-76ba-4755-805c-0f31c337a97c,condition,Do we have indicator reputation?,Check if we have indicators with reputation scores,,,,,,
0,3,0ad04484-3751-4f73-8d31-b542a6ed8ffa,condition,Change severity based on indicators reputation,Calculate the highest severity out of all of the indicators,,,,,,
0,4,fdc260d5-c59b-496e-8cd0-d21ece4f8455,regular,"Set severity to ""Low""",Set incident's severity to Low - all of the indicators in context have a non malicious reputation,,,,,,
0,5,6d897748-c603-4671-8219-32ba8993e568,regular,"Set severity to ""Medium"" ",Set incident's severity to Medium - an indicator had a suspicious reputation,,,,,,
0,6,b1fdd275-3e1b-477f-887b-fdb351d21314,regular,"Set severity to ""High"" ",Set incident's severity to High - an indicator had a malicious reputation,,,,,,
0,7,75a46609-7bfd-4575-8945-2f9efd0cf549,title,Check for critical entities,,,,,,,
0,8,a64636b5-7a83-4489-8216-8cb92c7e9bcb,condition,Do we have a username?,Check if we have an Account entity in context with a Username attribute,,,,,,
0,9,7bf2d20e-3223-4936-86fb-f1c757078ec7,condition,"Is the username part of ""CriticalUsers"" list?","Check if a Username in context is part of the ""CriticalUsers"" group",,,,,,
0,10,483350d5-ab17-44cd-87b3-0e2360ce3577,title,Done,,,,,,,
0,11,c4b5f8e7-8133-4122-8e88-ea69e15f0803,regular,"Set severity to ""Critical""",Set incident's severity to Critical - Some entity is part of a critical group,,,,,,
0,12,a2608eb5-ae95-472b-8f0c-d66da4aea6b1,condition,Do we have a hostname?,Check if we have an Endpoint entity in context with a Hostname attribute,,,,,,
0,13,9a382918-6ddb-46c2-8266-395c2098454b,condition,"Is the hostname part of ""CriticalEndpoints"" list?","Check if a Hostname in context is part of the ""CriticalEndpoints"" group",,,,,,
0,15,e1630137-4cb3-4031-866e-1fa9e66282f8,condition,Is the Account part of a critical active directory group?,"Check if an Account in context is part of the ""CriticalGroups"" group",,,,,,
0,16,1c5b9cb6-6063-4e7b-8a58-d2533901dddc,condition,Is the Endpoint part of a critical active directory group?,"Check if an Endpoint in context is part of the ""CriticalGroups"" group",,,,,,
0,17,f28ae149-d9e7-4f6f-8858-ea4634b41465,condition,Do we have the Endpoint AD groups?,Check if the endpoint has AD groups in context,,,,,,
0,18,5d855f43-e087-406d-8578-b12f9d929c69,condition,Do we have the username AD groups?,Check if the user has AD groups in context,,,,,,
0,0,3eded69b-617e-4212-86b7-2537474285f3,start,,,,,,,,
0,4,faa9ae4a-e658-4ab7-8d99-07994fba39a1,regular,"Assign the incident severity level  to ""Low""","Assign the incident severity level  to ""Low"".",,,,,,
0,5,7d9b6b23-3401-47f9-843d-cfa2a9679ef7,regular,"Assign the incident severity level  to ""Medium""","Assign the incident severity level  to ""Medium"".",,,,,,
0,6,26d70778-7064-49a2-880b-e167ae80b3ab,regular,"Assign the incident severity level  to ""High""","Assign the incident severity level  to ""High"".",,,,,,
0,10,483350d5-ab17-44cd-87b3-0e2360ce3577,title,Done,,,,,,,
0,11,d932e9f2-4ac2-4b27-8f83-8b0c71c398e1,regular,"Assign the incident severity level  to ""Critical""","Assign the incident severity level  to ""Critical"".",,,,,,
0,13,1850d92e-938e-4f29-827a-ff8dd4d1da40,playbook,Calculate Severity - Critical assets,"Determines if a critical assest is associated with the invesigation. The playbook returns a severity level of ""Critical"" if a critical asset is associated with the investigation.

This playbook verifies if a User Account or an Endpoint is part of a critical list or a critical AD group. ",,,,,,
0,14,09ef8f5b-0c54-4f0d-8d15-44daa61c60d5,playbook,Calculate Severity - DBotScore,"Calculate incident severity by indicators reputation and user/endpoint membership in critical groups.

Note - current severity will be overwritten and new severity may be lower than the current one.

Playbook inputs:
* CriticalUsers - Comma separated array with usernames of critical users
* CriticalEndpoints - Comma separated array with hostnames of critical endpoints
* CriticalGroups - Comma separated array with DN of critical Active Directory groups
* QualysSeverity - A Qualys severity score (1-5) to calculate severity from",,,,,,
0,15,9cb71dfd-3f18-403f-8351-c370d5a58987,condition,Set severity based on the highest returned severity level,Determines the severity level based on the highest result of all severity calculations.,,,,,,"{'label': 'Critical', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Severity', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'Severity'}, 'iscontext': True}, 'right': {'value': {'simple': 'critical'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,16,e628aa74-143a-4068-8a75-3abd96479000,playbook,Calculate Severity - 3rd-party integrations,Calculates the incident severity level according to the methodology of a 3rd-party integration.,,,,,,"{'label': 'Critical', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Severity', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'Severity'}, 'iscontext': True}, 'right': {'value': {'simple': 'critical'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,0,3eded69b-617e-4212-86b7-2537474285f3,start,,,,,,,,
0,1,5d35b08e-ffa6-43f6-85c9-2e71151c47ec,title,Check indicators,,,,,,,
0,3,f7e27994-5d98-4b80-8a0c-341830fdc0af,condition,Change severity based on indicators reputation,Calculate the highest severity out of all of the indicators,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,4,fdc260d5-c59b-496e-8cd0-d21ece4f8455,regular,"Set severity to ""Low""",Set incident's severity to Low - all of the indicators in context have a non malicious reputation,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,5,6d897748-c603-4671-8219-32ba8993e568,regular,"Set severity to ""Medium"" ",Set incident's severity to Medium - an indicator had a suspicious reputation,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,6,b1fdd275-3e1b-477f-887b-fdb351d21314,regular,"Set severity to ""High"" ",Set incident's severity to High - an indicator had a malicious reputation,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,7,75a46609-7bfd-4575-8945-2f9efd0cf549,title,Check for critical entities,,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,8,a64636b5-7a83-4489-8216-8cb92c7e9bcb,condition,Do we have a username?,Check if we have an Account entity in context with a Username attribute,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,9,7bf2d20e-3223-4936-86fb-f1c757078ec7,condition,"Is the username part of ""CriticalUsers"" list?","Check if a Username in context is part of the ""CriticalUsers"" group",,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,10,483350d5-ab17-44cd-87b3-0e2360ce3577,title,Done,,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,11,c4b5f8e7-8133-4122-8e88-ea69e15f0803,regular,"Set severity to ""Critical""",Set incident's severity to Critical - Some entity is part of a critical group,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,12,a2608eb5-ae95-472b-8f0c-d66da4aea6b1,condition,Do we have a hostname?,Check if we have an Endpoint entity in context with a Hostname attribute,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,13,9a382918-6ddb-46c2-8266-395c2098454b,condition,"Is the hostname part of ""CriticalEndpoints"" list?","Check if a Hostname in context is part of the ""CriticalEndpoints"" group",,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,15,e1630137-4cb3-4031-866e-1fa9e66282f8,condition,Is the Account part of a critical active directory group?,"Check if an Account in context is part of the ""CriticalGroups"" group",,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,16,1c5b9cb6-6063-4e7b-8a58-d2533901dddc,condition,Is the Endpoint part of a critical active directory group?,"Check if an Endpoint in context is part of the ""CriticalGroups"" group",,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,17,f28ae149-d9e7-4f6f-8858-ea4634b41465,condition,Do we have the Endpoint AD groups?,Check if the endpoint has AD groups in context,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,18,5d855f43-e087-406d-8578-b12f9d929c69,condition,Do we have the username AD groups?,Check if the user has AD groups in context,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,19,7c533dd7-9f3d-4e6e-8336-e2e68df5e9c8,condition,Check if an indicator's score exists,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore'}}, 'iscontext': True}}]]}"
0,20,72dd5ec9-0650-41a5-8e7d-db6849db35ba,title,Calculate from 3rd-party input,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore'}}, 'iscontext': True}}]]}"
0,21,b003aaf2-586f-46a3-8bee-76c110d8bb75,condition,Is there a Qualys severity?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.QualysSeverity'}}, 'iscontext': True}}]]}"
0,22,127f0e43-3179-4df7-8c4b-6a9877353e40,condition,Change severity based Qualys vulnerability score,,,,,,,"{'label': 'HIGH', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.QualysSeverity', 'filters': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'inputs.QualysSeverity'}, 'iscontext': True}, 'right': {'value': {'simple': '4'}}}]]}}, 'iscontext': True}}]]}"
0,0,3eded69b-617e-4212-86b7-2537474285f3,start,,,,,,,,
0,3,82b8a6ea-cf8a-4637-84ac-392ea9461a05,condition,Assign severity level based on indicators DBotScore,"Severity level is assigned according to:

* High = 3
* Medium = 2
* Low = 1",,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,6,aaf529b9-0621-40db-8b44-4894fb2acab2,regular,"Set severity to ""High"" ",Set the severity level to High (indicator had a malicious reputation).,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,10,483350d5-ab17-44cd-87b3-0e2360ce3577,title,Done,,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,20,d3642b7d-204b-4a95-853f-3fe3957dcf6a,regular,"Set severity to ""Medium"" ",Set the severity level to Medium (indicator had a suspicious reputation).,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,21,63d15a24-dfb3-45f6-8782-b8e54d1c5b16,regular,"Set severity to ""Low"" ",Set the severity level to Low (indicator had a good reputation).,,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,22,5943c193-e53b-4399-8408-f402c98f7c7e,regular,Set context,"Set the DBotsScore into context.
",,,,,,"{'label': 'High', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'DBotScore', 'filters': [[{'operator': 'number.greaterThan', 'left': {'value': {'simple': 'DBotScore.Score'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}}, 'iscontext': True}}]]}"
0,23,bc537b91-59eb-4e1d-84c5-06ee46cc72c8,condition,Is there a DBotScore?,Check if there is a “DBotScore” in the playbook inputs.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.DBotScore'}, 'iscontext': True}}]]}"
0,0,a68f66e4-9f00-4be5-82d5-66a604a8e127,start,start_task,,,,,,,
0,8,ee3ec982-b1ea-4c96-81d6-6b1ea068cfb4,regular,Search observed hashes in the Bit9 file catalog,Searching The Bit9 file catalog for the hashes,,,,,,
0,9,0f461a0b-6e31-4537-8b10-564d6c2e0dfa,regular,Check if the hashes are included in any Bit9 rules,"If the hashes have been approved or blocked in the past, they will be in existing rules. It is useful to see whether the hash was in some blacklist or whitelist or a person marked them as such, possibly with a comment explaining their reasons.",,,,,,
0,10,ec572e1b-78cf-4daf-8185-688d7b04041b,condition,Is CarbonBlack Protection enabled?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,11,b403c310-7926-4e04-8c81-ce7a9defb5c4,title,Done,Done,,,,,,
0,12,71e0a3f7-355e-41b2-8623-b6a606e9e79f,condition,Do we have files to hunt?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,0,729a5739-da09-4d2f-8a3c-abc427e3efd2,start,,Playbook start point,,,,,,
0,1,1a3ea7e1-aaf3-4df0-89f6-70e2680bda7a,regular,CBFindHash,Search Carbon Black for connection to specified md5 hash(es).,,,,,,
0,2,c687c04f-ba90-4572-800a-923193bacc32,condition,Is Carbon Black enabled?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,3,189b725f-2b0a-42cc-8148-95395f810983,title,Done,Done,,,,,,
0,4,a4a842fc-727c-4a64-883d-873968708ded,condition,Do we have files to hunt?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,0,1048472f-83e3-4b55-8d84-8e9fafbbd6cf,start,start_task,,,,,,,
0,1,230eed7b-c702-4c0f-87f0-700bd9d630b1,regular,Determine list of devices to be backed up,,,,,,,
0,2,6eb6a468-79cc-460b-8e2c-cada1799b034,regular,Trigger backup on each device,,,,,,,
0,3,143e5bcf-7746-409b-8c53-ff761a2d4b99,regular,Show status for initiated backup tasks,,,,,,,
0,4,1e1e3c6f-5703-47ea-8d70-871327266a2b,condition,Have any backups failed?,,,,,,,
0,5,3fb51d97-0e06-4b4d-8d3d-44a10e657cc4,regular,Open ticket on ServiceNow with list of problematic devices,,,,,,,
0,6,36723772-43f0-4619-872f-f54d53770054,regular,Retrieve the backup files from the devices,,,,,,,
0,7,d187c4cc-630c-4edd-8048-40678669101b,regular,Email a report of backup results,,,,,,,
0,8,65e21959-2a73-48ab-8b31-0aa8b55e66d9,regular,CloseInvestigation,,,,,,,
0,0,7cfa3cf6-82b0-452f-8c52-85355d20008a,start,,,,,,,,
0,3,ed6e2d6c-2eac-4e07-8a0d-8412d8700a52,title,Done,,,,,,,
0,4,6b7bfc47-d31a-4296-8cc5-0522912daa56,condition,Was device found?,Check if there was any machine match to the hostname,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'FalconHostDevices'}, 'iscontext': True}}]]}"
0,5,dcdf99c6-c7ad-48fa-895c-2730fe3821d6,regular,Get host information from CrowdStrike Falcon Host,Get host information from CrowdStrike Falcon Host,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'FalconHostDevices'}, 'iscontext': True}}]]}"
0,6,bea25d30-36cf-4ca9-8909-1a6ac435bcc1,regular,Get device ID,Get CrowdStrike device id,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'FalconHostDevices'}, 'iscontext': True}}]]}"
0,0,e4894164-409a-4adc-87bc-96a530ba8a27,start,,,,,,,,
0,1,295e9ac6-c665-4a4e-8d23-a0903a666143,condition,Are there domains to hunt?,Check if a context key is set. Can also optionally provide a value argument to compare against context data for this key.,,,,,,
0,2,ddaf36d8-5125-4b61-8f48-190aee2586f0,condition,Are there MD5s to hunt?,Check if a context key is set. Can also optionally provide a value argument to compare against context data for this key.,,,,,,
0,3,ca2f470d-41dd-4d21-8c26-98a5169bc0cd,condition,Are there SHA1s to hunt?,Check if a context key is set. Can also optionally provide a value argument to compare against context data for this key.,,,,,,
0,4,0f812845-70a9-4408-83cf-74c92d1915a2,condition,Are there SHA256s to hunt?,Check if a context key is set. Can also optionally provide a value argument to compare against context data for this key.,,,,,,
0,5,892f37be-8fb0-493f-8c86-b64fedf6b049,regular,Hunt for devices accessing bad domains,Returns a list of device IDs on which an indicator ran,,,,,,
0,6,79c5b224-634c-4ea7-8604-a94bd0637419,regular,Hunt for devices running MD5,"Returns a list of device IDs on which an indicator ran
",,,,,,
0,7,f42da4b9-e44a-47f7-8bd3-58ebc367fd29,regular,Hunt for devices accessing SHA1,Returns a list of device IDs on which an indicator ran,,,,,,
0,8,85fdaa12-b5f9-44c3-81e9-029353b53de2,regular,Hunt for devices accessing SHA256,Returns a list of device IDs on which an indicator ran,,,,,,
0,9,fee08a36-3893-425d-8329-77cea06d0d53,title,Get device details and email,,,,,,,
0,11,ee1c2ef3-3993-4227-8e33-cd0baedeff6a,regular,Get device details,,,,,,,
0,12,ef5f10f1-f006-47d8-84b7-fed029b29add,regular,Notify analyst to review information,,,,,,,
0,13,4fde6e6e-c916-4a95-83e0-d716d9e58435,regular,Analyst - review information,,,,,,,
0,14,6275c1bc-a359-444b-89aa-c6baf47db456,condition,Found any devices?,,,,,,,
0,15,063c114f-096a-476d-894c-18f3d802fc0f,title,Done,,,,,,,
0,16,9ba5d50c-d454-4b3e-8149-847fdfff135c,condition,Is FalconHost enabled?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,17,06bbd1d4-24bf-4daa-8a57-b1925c9426ae,title,Hunt for indicators,,,,,,,
0,0,c1de2f2b-64cb-4df5-8490-07c49e7255b6,start,,start,,,,,,
0,1,edb32e9f-570f-4418-8522-b121f7bd5233,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,c8400cff-bb6a-4ba7-8032-69e0322c54cf,condition,Is there any active Cuckoo instance?,Check for active instance,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cuckoo Sandbox'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,087ea815-c0b4-4604-8b43-099927639fa9,condition,Is there any file to detonate?,Check if file exist,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,6,4d966bd6-db01-4c5f-8cb3-da14e5f1058b,regular,Send file to Cuckoo,send file to Cuckoo,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,7,b5eb756b-903d-4f8e-8b09-f8bcad28627c,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,8,f1f53022-58b9-4d86-82f1-89ef2b0d7da2,regular,Get task report,get task report,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,9,d2d7357c-0e0f-472f-89fd-e2ac9d46bcc4,regular,Sleep (let the sandbox create the task),sleep,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,10,fb2f1eb0-0d65-4367-8df7-40a015704047,regular,View task,view task,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,11,c530de05-cebe-438a-81f8-9c19f317cbbe,regular,Get Screenshots,Get screenshots from the machine running the file,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,0,ac486e14-1500-41db-8579-c2acb8b805ef,start,,starting test,,,,,,
0,1,470c6166-f089-4486-80c1-2e0ab0d650eb,condition,Is there any active Cuckoo instance?,Check for active instance,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cuckoo Sandbox'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,2,1e9c332f-bfcc-4323-899c-c29476110b53,condition,Is there a URL?,Check for URL,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,3,1ee9c8d9-b62b-4e27-858f-ae9735ddb857,regular,Send URL to Cuckoo,create task from url,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,4,9ad01520-9f27-44be-8a20-2caa2ce4b1c4,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,6,bee9857d-c4a9-4e9f-8939-822514c68078,title,Done,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,7,244fc667-b769-4232-809c-424cf5d174f0,regular,Get task report,get task report,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,8,f9d3406d-4b34-44e7-88eb-b2523f8e0897,regular,Sleep (let the sandbox create the task),sleep,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,9,666d7185-d292-42cf-8d42-882e5f80c0d8,regular,View task,view task,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,0,8a9b5f57-93dc-4f6e-847a-472c93c1af17,start,,,,,,,,
0,1,8bb9a465-c8c6-4c01-855c-949ae425e1ee,condition,Are there any CVE IDs?,Verify that the playbook input includes at least one CVE ID to enrich.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.CVE', 'accessor': 'ID'}}, 'iscontext': True}}]]}"
0,2,1c1df4a5-6a12-4724-8cf5-586f7743fc57,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.CVE', 'accessor': 'ID'}}, 'iscontext': True}}]]}"
0,3,f7b01173-8ceb-4a00-843c-ae25be38be72,title,Enrich CVE,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.CVE', 'accessor': 'ID'}}, 'iscontext': True}}]]}"
0,4,ec903a88-c4cd-4c15-8cf4-3e2065626e24,condition,Is XFE enabled?,Verify that there's a valid instance of XFE enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'XFE'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,5,306a2d9e-6bf5-483e-8dae-7f65b705e535,condition,"Is ""CVE Search"" enabled?","Verify that there's a valid instance of ""CVE Search"" enabled.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'CVE Search'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,7674b375-bbfd-4ac0-877a-42110ffc1a89,regular,"Get CVE info from ""CVE Search""","Retrieve CVE information from ""CVE Search"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'CVE Search'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,7,64e794a4-8cf1-4f18-8d0c-0dd74d6f295e,regular,Get CVE info from XFE,Retrieve CVE information from XFE.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'CVE Search'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,a8dc9bc9-7c74-4b59-86a4-aa7c09063fd0,condition,Should the system retrieve the CVE reputation?,Is the GetReputation input set to 'True'?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.GetReputation'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,9,f779358d-7e46-4afd-8b42-b48167adb764,regular,Retrieve CVE reputation,Retrieve CVE reputation using one or more integrations.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.GetReputation'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,0,816b1abc-8a51-4b98-8edb-8f200d16f878,start,,,,,,,,
0,3,ffd5619d-eb26-4f14-8d71-b62e1e6bc97d,regular,Add the endpoint as a System to this incident,Add the relevant endpoint to the System,,,,,,
0,4,a3cd0e59-5d57-4782-8795-0ea3811ec4d6,regular,d2 agent - Get process list,,,,,,,
0,5,7411d33a-9c1c-494f-8422-c972b524abe2,regular,d2 agent - Get hardware details,Get Hardware details from endpoint,,,,,,
0,6,34499d4a-e00a-4886-8882-e5bcddf3a892,regular,d2 agent - Get active users,,,,,,,
0,7,bfdb339a-a8b5-4b46-822c-23b4d515787e,condition,Does 'Host' input exist?,Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,8,51867be7-4781-4482-87aa-2181e138b651,condition,Any files on endpoint that we should collect?,,,,,,,
0,11,6289197b-4aa9-4e44-8b96-d5abd1a9dbb3,regular,d2 agent - Collect file from endpoint,,,,,,,
0,12,b58ccd0e-1dbf-474b-8c8c-9de42f74d7bb,title,Done,,,,,,,
0,14,3d43e539-869a-4386-8395-2e7c6e2c91bc,title,Collect data from endpoint,,,,,,,
0,15,3a82031b-c9ed-4dff-8336-12c8279afc02,condition,Is the OS type Windows?,,,,,,,
0,0,d43d5bc7-608a-4580-856a-6c07aaf1b3dc,start,,,,,,,,
0,1,88dfca43-623f-4ab4-8b4a-c76e522c7f5f,regular,Prepare phishing data,Prepare emails data to machine learning model,,,,,,
0,2,ee891512-2e90-40eb-8e62-46242df2a75f,regular,Train model,Train the machine learning model,,,,,,
0,7,47b24192-7505-4410-838d-4036ab392f2b,regular,Model evaluation ,Evaluate the model  ,,,,,,
0,8,f44bf907-a56b-4fc9-8db0-a79831c9b27a,title,Done,,,,,,,
0,9,3c14c89b-6d87-4dba-813b-4d783f81ad85,condition,Is model trained?,Check if the model successfully trained,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'DBotTextClassifier'}, 'iscontext': True}}]]}"
0,10,c20fcbea-60ac-49c6-8659-bf3bc09033d2,condition,Historical data exist,Do we have file with historic data we want to load?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'inputs.historicalDataFileListName'}, 'iscontext': True}}]]}"
0,11,c87ef0d3-71bc-4d0d-8110-e8fc6e838cfa,regular,Get historical file,Dump the file to the war room (from base64 list),,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'inputs.historicalDataFileListName'}, 'iscontext': True}}]]}"
0,0,3f296bee-5970-4a35-819b-30ace9905ff7,start,,,,,,,,
0,1,831b0954-1008-49f0-84e1-43dc7c585ec0,playbook,DBotCreatePhishingClassifier,"Create a phishing classifier using machine learning technique, based on email content",,,,,,
0,2,f2153861-94b2-4de6-8883-546b3e4dc5b9,title,Done,,,,,,,
0,3,a0577456-3576-460d-8ede-15c6569f611a,regular,Close incident,Close the investigation - we want to close the incident if the playbook successfully finished.,,,,,,
0,4,cd901cee-98fa-416b-8e39-519218a516ea,regular,Clean context,Clear all context data,,,,,,
0,0,5f144764-22dd-48bf-8179-b44b7576d050,start,,,,,,,,
0,1,5afc1cd3-d846-4353-8977-95adfe1c70a5,condition,Do we have MD5 hashes?,Checks if there's any MD5 indicators to enrich,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.MD5'}, 'iscontext': True}}]]}"
0,2,b1bed29a-6cbe-4238-8c4d-3203457bdc73,regular,Get MD5 internal Dbot score,"Query DBot for indicators' pre-existing reputation. If exist, the score will be added to the incident's context",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.MD5'}, 'iscontext': True}}]]}"
0,3,d1a4161a-90a1-4f74-8d55-8ec4919d5f56,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.MD5'}, 'iscontext': True}}]]}"
0,4,ca10b1e8-fb57-42ca-8443-df8e39f3630c,condition,Is there an Email address to check?,Checks if there's any Email indicators to enrich,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,5,c84e302e-2844-414f-8b19-71f7b3e0fd18,regular,Get Email address internal Dbot score,"Query DBot for indicators' pre-existing reputation. If exist, the score will be added to the incident's context",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,6,236e4b6d-3833-4b6c-8b4b-760976caed6e,condition,Do we have URLs?,Checks if there's any URL indicators to enrich,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,7,47908ce9-33ad-4e39-835b-246f3cdfbe53,regular,Get URL internal Dbot score,"Query DBot for indicators' pre-existing reputation. If exist, the score will be added to the incident's context",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,8,eb495689-5df3-44b3-8272-d2cc2dc36d51,condition,Do we have IP Addresses?,Checks if there's any IP indicators to enrich,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,9,2efb0c7e-9166-4646-8ad1-041fd257a55c,regular,Get IP internal Dbot score,"Query DBot for indicators' pre-existing reputation. If exist, the score will be added to the incident's context",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,10,d510fe26-bf16-4596-8f67-51e37732383f,title,File,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,11,a6ee34a5-0587-4d40-8e83-752e3261bbd1,condition,Do we have SHA256 hashes?,Checks if there's any SHA256 indicators to enrich,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.SHA256'}, 'iscontext': True}}]]}"
0,12,102eceb6-41fb-4b97-8279-c4ebfeb5bc63,regular,Get SHA256 internal Dbot score,"Query DBot for indicators' pre-existing reputation. If exist, the score will be added to the incident's context",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.SHA256'}, 'iscontext': True}}]]}"
0,13,525d4fb2-26b9-4d8f-8960-b8c12362ee4f,condition,Do we have SHA1 hashes?,Checks if there's any SHA1 indicators to enrich,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.SHA1'}, 'iscontext': True}}]]}"
0,14,4168a3e7-0f00-4e0a-8517-7dde46cf63db,regular,Get SHA256 internal Dbot score,"Query DBot for indicators' pre-existing reputation. If exist, the score will be added to the incident's context",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.SHA1'}, 'iscontext': True}}]]}"
0,0,4bb4cba3-1da4-4356-831e-87ca6523087a,start,,,,,,,,
0,1,48f0cedf-fad2-47db-81fd-348b062f41fe,condition,Choose find duplicates method,"We have a few methods to find duplicates incidents in Demisto.
- ml: machine learning model, trained mostly on phishing incidents.
-rules: help to find duplicate incidents when the logic in defined well - like same label or custom fields.
-text: statistics algorithm comparing text. usually useful for  phishing.",,,,,,"{'label': 'ml', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.DuplicateMethod'}, 'iscontext': True}, 'right': {'value': {'simple': 'ml'}}}]]}"
0,4,ebe7bb7e-6956-4392-83fd-265b59ba73cb,regular,Find duplicates by text,,,,,,,"{'label': 'ml', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.DuplicateMethod'}, 'iscontext': True}, 'right': {'value': {'simple': 'ml'}}}]]}"
0,5,54a58f44-4f47-452c-8a4a-c7f64d5c499a,condition,Is duplicate found,Check if any duplicate incident has been found.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isTrue', 'left': {'value': {'simple': 'isSimilarIncidentFound'}, 'iscontext': True}}], [{'operator': 'isTrue', 'left': {'value': {'simple': 'inputs.CloseAsDuplicate'}, 'iscontext': True}}]]}"
0,6,15ca6629-8830-44ec-84d4-4f3bcef19011,regular,Find similar incidents by rules,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isTrue', 'left': {'value': {'simple': 'isSimilarIncidentFound'}, 'iscontext': True}}], [{'operator': 'isTrue', 'left': {'value': {'simple': 'inputs.CloseAsDuplicate'}, 'iscontext': True}}]]}"
0,7,ee12b870-3892-4dd8-8635-0c5f13b30ea3,regular,Find duplicates by ml,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isTrue', 'left': {'value': {'simple': 'isSimilarIncidentFound'}, 'iscontext': True}}], [{'operator': 'isTrue', 'left': {'value': {'simple': 'inputs.CloseAsDuplicate'}, 'iscontext': True}}]]}"
0,8,857267ed-a8bf-4d65-8a80-967656990b57,regular,Close investigation as duplicate,Close the investigation as duplicate to one of the incidents that has been found.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isTrue', 'left': {'value': {'simple': 'isSimilarIncidentFound'}, 'iscontext': True}}], [{'operator': 'isTrue', 'left': {'value': {'simple': 'inputs.CloseAsDuplicate'}, 'iscontext': True}}]]}"
0,9,c1f06a79-d539-4853-8140-f1f879a8f137,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isTrue', 'left': {'value': {'simple': 'isSimilarIncidentFound'}, 'iscontext': True}}], [{'operator': 'isTrue', 'left': {'value': {'simple': 'inputs.CloseAsDuplicate'}, 'iscontext': True}}]]}"
0,0,0c9fa614-e05a-4144-8e40-6b736392a16a,start,,,,,,,,
0,2,6c68450d-d32f-4a07-8978-8df36190ada6,regular,Find duplicate incidents,Find duplicate incidents for the current incident.,,,,,,
0,3,bced6173-64c6-457c-85bd-2adf6be16c4c,regular,Close as duplicate,Close the current investigation as duplicate.,,,,,,
0,4,e1952276-e1b2-4748-8198-9bc500d5c504,condition,Is duplicate incident found?,Check if there is any duplicate incident found.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isTrue', 'left': {'value': {'simple': 'isSimilarIncidentFound'}, 'iscontext': True}}]]}"
0,5,813eba13-6ed9-4050-8d77-f9c3e0a3d07c,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isTrue', 'left': {'value': {'simple': 'isSimilarIncidentFound'}, 'iscontext': True}}]]}"
0,0,d49b7743-f43f-4677-8766-c9f16d3fc0ab,start,,,,,,,,
0,1,19915cbc-3042-425d-8254-c3be9c291076,regular,Find duplicate incidents,Find duplicate incidents using machine-learning.,,,,,,
0,2,2ffa4239-003c-490a-849e-f910383a5ae0,condition,Is duplicate candidate found?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'foundDuplicates'}, 'iscontext': True}}]]}"
0,3,4a8be468-2af6-4427-8ee8-a71d450260ee,regular,Print candidate,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'foundDuplicates'}, 'iscontext': True}}]]}"
0,4,91676756-8dd8-41fc-801e-b19c98a5b048,regular,No duplicates found,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'foundDuplicates'}, 'iscontext': True}}]]}"
0,5,fd106344-04d3-429b-8fb4-dced0a7a085f,regular,Close investigation as duplicate,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'foundDuplicates'}, 'iscontext': True}}]]}"
0,6,7cc3505f-3571-414c-88bd-a60c8a0e3919,condition,Is duplicate score above threshold?,Check if the candidate for duplicate incident score is above the threshold.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'duplicateCandidate.duplicateProbability'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.closeThreshold'}, 'iscontext': True}}]]}"
0,0,default-start,start,start_task,,,,,,,
0,2,is-email,condition,Is this an email,Checks if incident has 'Email/from' label,,,,,,
0,4,splunk-email-parser,regular,SplunkEmailParser,Parse email with splunk,,,,,,
0,6,nexpose-email-parser,regular,NexposeEmailParser,Parse email with Nexpose,,,,,,
0,8,sentinelone-email-parser,regular,Set incident type and playbook to SentinelOne,Parse email with SentinelOne,,,,,,
0,9,incident-set-phishing,regular,Set type and playbook to Phishing (default type for emails),,,,,,,
0,22,mail-classifier,title,Mail Classifier,,,,,,,
0,23,brand-classifier,title,Classify by Brand,,,,,,,
0,26,qradar-classifier,regular,QRadar Classifier,Classify incident with QRadar,,,,,,
0,27,branch-by-brand,condition,Get Brand,Prints text to war room,,,,,,
0,28,vectra-classifier,regular,Vectra Classifier ,Classify incident with Vectra,,,,,,
0,29,trend-classifier,regular,Trendmicro Classifier,Classify incident with Trendmicro,,,,,,
0,30,manually-decide,regular,Manually decide playbook,"Could not decide incident type automatically, please set playbook Manually",,,,,,
0,33,2f7ec274-84aa-4e36-80a7-bb7aa32e5560,condition,get-email-sender-map,Prints text to war room,,,,,,
0,34,incident-has-brand,condition,"Does incident include ""Brand"" label?",Check if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,35,call-enrichment,playbook,,,,,,,,
0,0,08854949-08a5-4873-8f01-b3935c78675f,start,,,,,,,,
0,1,a8430dac-8cbb-47b3-8a87-2752cab0f36c,condition,Should perform enrichment?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Enrich'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,2,145e7a29-471e-4702-8493-65b7abbea30c,regular,Choose analyst,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Enrich'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,3,09e4583d-597f-4955-897c-5bb5f24f4f57,title,Enrich indicators,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Enrich'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,4,44e6a83f-14cd-49f4-8c41-0ffde22d3c4f,playbook,,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Enrich'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,5,49cd29a6-4a83-44e6-8bdc-86136341411a,playbook,,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Enrich'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,6,0e467280-8c85-40e6-84a0-4b11305dbcd7,playbook,,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Enrich'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,7,52714931-6ca9-42ff-854f-af9d3bc9e3d0,regular,Manually review the incident,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Enrich'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,8,e39abb8a-2dbe-415e-8541-ba414ee3dfa6,regular,Close Investigation,Close the current incident,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Enrich'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,0,8d2065da-28f3-4042-81b6-ccd497f2d788,start,,start,,,,,,
0,1,8c2060b1-feed-4a00-8e1d-01d3d8ce9137,regular,List Demisto users,List all Demisto users via Demisto REST API integration,,,,,,
0,2,4d440741-9f52-4625-8b31-ad0de970fe0b,condition,Any non-SSO users?,Check if there are any users that weren't created through a SAML login i.e. users created locally in Demisto. In an all-SSO setup there shouldn't be any.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isNotEmpty', 'left': {'value': {'complex': {'root': 'DemistoUsers', 'filters': [[{'operator': 'string.isNotEqual', 'left': {'value': {'simple': 'DemistoUsers.userType'}, 'iscontext': True}, 'right': {'value': {'simple': 'SAML'}}}]]}}, 'iscontext': True}}]]}"
0,3,bc2a838b-0d3e-43d1-8dcd-3e014b6ccf3f,title,Alert and Escalate,Alert and Escalate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isNotEmpty', 'left': {'value': {'complex': {'root': 'DemistoUsers', 'filters': [[{'operator': 'string.isNotEqual', 'left': {'value': {'simple': 'DemistoUsers.userType'}, 'iscontext': True}, 'right': {'value': {'simple': 'SAML'}}}]]}}, 'iscontext': True}}]]}"
0,4,2f4d7417-f033-4c83-83b2-8a7484869a32,regular,Escalate to Critical,Set incident severity to Critical,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isNotEmpty', 'left': {'value': {'complex': {'root': 'DemistoUsers', 'filters': [[{'operator': 'string.isNotEqual', 'left': {'value': {'simple': 'DemistoUsers.userType'}, 'iscontext': True}, 'right': {'value': {'simple': 'SAML'}}}]]}}, 'iscontext': True}}]]}"
0,5,15c95532-3d62-41b0-8d97-663d17443b1b,regular,Send alert to Slack channel,Send an alert to the CSIRT slack channel,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isNotEmpty', 'left': {'value': {'complex': {'root': 'DemistoUsers', 'filters': [[{'operator': 'string.isNotEqual', 'left': {'value': {'simple': 'DemistoUsers.userType'}, 'iscontext': True}, 'right': {'value': {'simple': 'SAML'}}}]]}}, 'iscontext': True}}]]}"
0,6,fed938d2-919c-467c-8f65-4757d50d6f00,regular,Send SMS alert,Send an SMS alert using Twilio.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isNotEmpty', 'left': {'value': {'complex': {'root': 'DemistoUsers', 'filters': [[{'operator': 'string.isNotEqual', 'left': {'value': {'simple': 'DemistoUsers.userType'}, 'iscontext': True}, 'right': {'value': {'simple': 'SAML'}}}]]}}, 'iscontext': True}}]]}"
0,7,99688ee1-63c3-4e75-8148-952305bcd890,regular,Close,Auto-close this incident,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isNotEmpty', 'left': {'value': {'complex': {'root': 'DemistoUsers', 'filters': [[{'operator': 'string.isNotEqual', 'left': {'value': {'simple': 'DemistoUsers.userType'}, 'iscontext': True}, 'right': {'value': {'simple': 'SAML'}}}]]}}, 'iscontext': True}}]]}"
0,0,b914ae63-e755-4b4b-8d46-da635ed2605b,start,,,,,,,,
0,1,6705f964-a6a7-470b-8336-76be42147afa,condition,Do we have relevant files?,Check if the type or info of files is either executable or pdf,,,,,,
0,3,12cc937e-cdd5-47df-85af-11301187d67d,regular,Print that there are no relevant files to detonate,,,,,,,
0,4,fd843ede-25fb-4cc3-8611-d9d54d4e1de4,regular,SandboxDetonateFile,Detonate the file in available sandboxes.,,,,,,
0,0,d8a91f9c-40f6-48f2-8dd2-1c7e59b6abdb,start,,Detonates a file using ANYRUN,,,,,,
0,1,5ad0fc44-886e-47e0-8d7d-ff6edae126dd,regular,ANYRUN Submit File for Analysis,Submit a file or url for analysis.,,,,,,
0,2,0f91df59-058c-43e3-8338-4f6220de8cec,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,5,93fac7de-168e-4b60-8172-1d0d8cc46702,title,Done,Detonates a file using ANYRUN,,,,,,
0,6,ae212064-acba-4bbf-8356-36fa72a109aa,condition,Is there a File to detonate?,Look for files to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,7,93ed41bd-5396-498b-88e6-6576a6497e5e,condition,Is ANY.RUN sandbox enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'ANYRUN'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,bf26e230-eb55-4b32-8031-5da5dd851921,regular,ANYRUN Get Report,Get the report for a task created for a submitted file or url.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'ANYRUN'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,29dcbc1e-0bb0-45f1-82ed-eb65b6ce039d,start,,,,,,,,
0,5,3e2a6ea9-7f88-4d10-8d29-3ed2d10eba4f,condition,Is CrowdStrike enabled?,"Verify that there is a valid instance of CrowdStrike enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,e6a670a6-eff4-4b16-883b-f08e7d7e7bd3,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,7226fb9e-9b1c-4e40-8823-428a6ef19aaa,regular,CrowdStrike Scan,Download the pdf report to the War Room.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,11,8377ba6f-c57d-4cd1-8a1f-5989f89978ac,regular,Set file to context,Set the file object into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,13,ab929de2-d71d-487e-8200-68a9178aca32,regular,CrowdStrike Upload Sample,Submits a sample to CrowdStrike,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,14,a15cdef0-f6bd-48e3-8198-3f7c20e668fe,condition,Is there a file to detonate?,Asserts there's a file to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,15,a0565f2c-c720-4196-84d2-21e057c23637,condition,Is the file type supported?,Asserts the file type is supported,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,16,c6e5c638-5c9e-470c-8f57-7931c2689dba,playbook,GenericPolling,Initiated the generic polling playbook that will do the polling command,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,0,99639e9f-c42f-4241-849e-205318e76136,start,,,,,,,,
0,4,382bacc2-d6bd-4c14-8f52-4583422c52b4,regular,DetonateFile (CS Falcon Sandbox),Detonate the file in CrowdStrike Falcon Sandbox.,,,,,,
0,5,94c56870-3c61-4f5c-8816-7d412d155b5f,condition,Is CS Falcon Sandbox enabled?,Verify that there is a valid instance of CrowdStrike Falcon Sandbox enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,6,54bc8e82-f709-4686-8a24-43b6cbe9986b,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,8,49f9beb3-ca33-46ec-8221-0592122e44b8,regular,Set file to context,Set the file object into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,9,db62439a-babe-4770-86ec-9e473e10880e,condition,Is the file type supported?,Check if file type is supported.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'string.match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:exe|scr|pif|dll|com|cpl|etc|doc|docx|ppt|pps|pptx|ppsx|xls|xlsx|rtf|pub|PDF|APK|JAR|sct|lnk|chm|hta|wsf|JS|VBS|VBE|SWF|PL|PS1|PSD1|PSM1|SVG|PY|PL|ELF|EML|MSG)\\b'}}, 'ignorecase': True}, {'operator': 'string.match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:exe|scr|pif|dll|com|cpl|etc|doc|docx|ppt|pps|pptx|ppsx|xls|xlsx|rtf|pub|PDF|APK|JAR|sct|lnk|chm|hta|wsf|JS|VBS|VBE|SWF|PL|PS1|PSD1|PSM1|SVG|PY|PL|ELF|EML|MSG)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,10,abd56ee9-97d0-4f35-8f5b-ac44b78c3f0b,condition,Is there a file to detonate?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.File'}}, 'iscontext': True}}]]}"
0,0,09a1d3ca-6465-42dc-8a28-4a1d382e76ff,start,,,,,,,,
0,5,6bee82b2-c6ef-4bc4-8b43-dfa80bacd1cd,condition,Is FireEye AX enabled,Verify that there is a valid instance of FireEye AX enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Fireeye'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,c7debc9a-f9dd-427b-898a-be6814407698,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Fireeye'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,11,2dbe8904-3a0e-421d-8dd6-28d64963f65d,regular,Set file to context,Set the file object into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Fireeye'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,13,b08d6749-94f5-4d7d-8be8-f1a1ec7874aa,regular,FireEye AX Upload Sample,Submits a sample to FireEye AX,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Fireeye'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,14,4f8fafd7-ca9f-47fd-8909-5e5f8a475eb9,condition,Is there a file to detonate?,Asserts there's a file to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,15,e870c12f-520e-4a84-8e4c-6eb304a0feeb,condition,Is the file type supported?,Asserts the file type is supported,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}]]}}, 'iscontext': True}}], [{'operator': 'notEndWith', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}, 'ignorecase': True}]]}"
0,16,75d77278-0907-4f26-87dc-ad51c40cb28c,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}]]}}, 'iscontext': True}}], [{'operator': 'notEndWith', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}, 'ignorecase': True}]]}"
0,17,803f374f-daac-43d6-8483-85b6fbd56f77,regular,AX-result,Retrieve result data upon a file. NOTE - This command returns a file,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:PE32|EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}]]}}, 'iscontext': True}}], [{'operator': 'notEndWith', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}, 'ignorecase': True}]]}"
0,0,454650df-c42f-4915-84cf-9a908e1bff04,start,,Playbook start point,,,,,,
0,3,2a8f5bbb-7692-4ece-8abe-9801c7b05c3c,title,Done,Done,,,,,,
0,8,f6627718-5952-4240-8fba-104c1350e79b,playbook,Detonate File - JoeSecurity,"Detonates one or more files using the Joe Security - Joe Sandbox integration.
Returns relevant reports to the War Room and file reputations to the context data.
All file types are supported.",,,,,,
0,9,c04567fa-641d-4b51-8c94-561516554b3d,playbook,ATD - Detonate File,"Detonates a File using the McAfee Advanced Threat Defense sandbox.
Advanced Threat Defense supports the following File Types:
32-bit Portable Executables (PE)files; 64-bit PE+files
exe, sys, dll, com, scr, cpl, ocx, cgi
Microsoft Office Suite documents
doc,dotm, docx, dotx, xls, ppam, xlsx, pps, xlsb, ppsx, xlsm, ppsm, ppt, ppt, pptx, pptm, rtf, shs, xltm, sldm, xltx, sldx, xlam, thmx, docm, xar
Just Systems Ichitaro documents
jtd, jtdc
Adobe
pdf, swf
Compressed files
gz, 7z, tgz, msi, zip, lzh, cab, lzma, rar
Android application package
apk, Java, JAR, CLASS, Java Script, Java bin files
Image files
jpeg, png, gif
Other file types
cmd, ace, bat, arj, vbs, chm, xml, lnk, url, mof, htm, ocx, html, potm, eml, potx, msg, ps1, vb, reg, vba, wsc, vbe, wsf, vbs, wsh",,,,,,
0,10,e82f2557-2a9d-4e13-81b1-ad3f4d685f3d,playbook,Detonate File - ThreatGrid,Detonate one or more URLs using the Threat Grid integration. This playbook returns relevant reports to the War Room and URL reputations to the context data.,,,,,,
0,11,f1c56438-d1b6-4848-8608-c6292f3905b9,playbook,CrowdStrike Falcon Sandbox - Detonate file,"Detonate one or more files using the CrowdStrike integration. This playbook returns relevant reports to the War Room and file reputations to the context data. The detonation supports the following file types - EXE, DLL, JAR, JS, PDF, DOC, DOCX, RTF, XLS, PPT, PPTX, XML, ZIP, VBN, SEP, XZ, GZ, BZ2, TAR, MHTML, SWF, LNK, URL, MSI, JTD, JTT, JTDC, JTTC, HWP, HWT, HWPX, BAT, HTA, PS1, VBS, WSF, JSE, VBE, CHM",,,,,,
0,13,0a805640-8d5e-46d4-87f2-04a0781a6ca5,playbook,WildFire - Detonate file,"Detonate one or more files using the Wildfire integration. This playbook returns relevant reports to the War Room and file reputations to the context data.
The detonation supports the following file types -
APK, JAR, DOC, DOCX, RTF, XLS, XLSX, PPT, PPTX, XML, PE32, PDF, DMG, PKG, RAR, 7Z",,,,,,
0,14,d8093197-7aa9-4b18-8774-563225e8c72b,playbook,Detonate File - Lastline,"Detonates a File using the Lastline sandbox.
Lastline supports the following File Types:
EXE, SYS, DLL, COM, SCR, CPL, OCX, CGI, DOC, DOTM, DOCX, DOTX, XLS, PPAM, XSLX, PPS, XLSB, PPSX, XLSM, PPSM, PPT, PPTX, PPTM, RTF, SHS, XLTM, SLDM, XLTX, SLDX, XLAM, THMX, DOCM, XAR, JTD, JTDC, PDF, SWF, GZ, 7Z, TGZ, MSI, ZIP, LZH, CAB, LZMA, APK, JAR, CLASS, JPEG, PNG, GIF, CMD, ACE, BAT, ARJ, VBS, CHM, XML, LNK, URL, MOF, HTM, OCX, HTML, POTM, EML, POTX, MSG, PS, |VB, REG, VBA, WSC, VBE, WSF, VBS, WSH",,,,,,
0,15,0e879eba-0377-44bf-81c4-83468555fec4,playbook,Detonate File - Cuckoo,Detonates a file using Cuckoo sandbox,,,,,,
0,16,e69051d8-12bd-440c-85de-3f3c713d1556,playbook,Detonate File - SNDBOX,Detonates a file using SNDBOX,,,,,,
0,17,8bcf20e7-7f82-434b-8b21-200f3423a0ce,playbook,Detonate File - HybridAnalysis,Detonates a file using HybridAnalysis,,,,,,
0,18,11d549c4-31e9-4cd9-8983-9e1a1c7c4baf,playbook,Detonate File - ANYRUN,Detonates a file using ANYRUN,,,,,,
0,19,3727eda2-2c84-4730-8739-b54bc07a36c3,playbook,Detonate File - FireEye AX,Detonates a file using FireEye AX,,,,,,
0,20,77b7e144-a6a2-4e93-8e69-1160f9921573,playbook,Detonate File - VMRay,Detonates a file using VMRay,,,,,,
0,0,73eadb3f-61fa-41d5-87b3-6d6a67a04e63,start,,Playbook start point,,,,,,
0,1,14dca057-013d-468f-8ff5-e883e5169d37,playbook,WildFire - Detonate file,Detonate files through WildFire,,,,,,
0,2,09b39ec1-db04-4355-807d-4cf4f4b31e92,playbook,CrowdStrike Falcon Sandbox - Detonate file,Detonate file through CrowdStrike Falcon Sandbox,,,,,,
0,3,9db19651-009c-468f-80b3-c58efea96ed2,title,Done,Done,,,,,,
0,0,d8a91f9c-40f6-48f2-8dd2-1c7e59b6abdb,start,,Detonates a file using HybridAnalysis,,,,,,
0,1,947670cb-4e57-4b07-8501-51d0b7563d56,regular,HybridAnalysis Upload File,Upload a file using HybridAnalysis,,,,,,
0,2,3331390f-9148-4775-85f9-882c131a20ab,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,5,93fac7de-168e-4b60-8172-1d0d8cc46702,title,Done,Detonates a file using HybridAnalysis,,,,,,
0,6,cb44c359-3f5c-48a7-8af9-4ec32ff05576,condition,Is there a File to detonate?,Look for files to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File'}}, 'iscontext': True}}]]}"
0,7,a46f8449-ab10-4f43-82b5-7cfe8b5ea638,condition,Is HybridAnalysis sandbox enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Hybrid Analysis'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,6dce8e48-9eb4-425b-896c-1615bd8daefd,regular,HybridAnalysis Scan,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Hybrid Analysis'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,d8a91f9c-40f6-48f2-8dd2-1c7e59b6abdb,start,,Detonates a file using JoeSecurity,,,,,,
0,1,96f24672-03e9-4b5f-8976-44cb1a1d273e,regular,JoeSecurity Upload File,,,,,,,
0,2,caf4db14-e5d0-40f1-8f17-e9c90d20fb3d,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,5bcb48a2-b804-4fa2-8f07-4b36c8708668,regular,JoeSecurity Get Report,,,,,,,
0,5,93fac7de-168e-4b60-8172-1d0d8cc46702,title,Done,,,,,,,
0,6,f40cdb2c-ed11-4489-8977-4f6a105304d4,condition,Is there a File to detonate?,Look for files to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,7,ce04663d-aaca-47c5-8c3a-392987e23dfa,condition,Is JoeSecurity sandbox enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Joe Security'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,4f2c07a5-cb21-4680-82d6-5cdacba2bd67,regular,JoeSecurity Get Info,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Joe Security'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,9,7c9693b1-3b80-4e1e-842e-a9f0bd5f48c3,regular,Set Context,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Joe Security'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,2251b2ee-5743-45f5-81bf-7da8693c7b61,start,,-,,,,,,
0,2,36e16e34-4b51-4c85-8779-59527ffe8bd9,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,0ce1a739-c653-4186-8767-1f18d0383462,regular,Lastline Get Report,Get analysis report,,,,,,
0,5,6185e7bf-d4ea-428f-84f3-8f69c900e8e8,title,Done,finished,,,,,,
0,7,d3ca12aa-6550-4c88-81eb-e2a97b5c51b5,condition,Is Lastline sandbox enabled?,"Verify that there is a valid instance of Lastline enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Lastline'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,fea8caab-2280-4b3a-81ca-0477bc5d1854,condition,Is File type supported?,Check if file type is supported.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,11,880a4474-6ff0-4426-83c3-38bbf36f090e,regular,Set File to context,Set the file object into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,12,823f4f10-b0d8-4c6b-8bc0-b7ec01897534,condition,Is there a File to Detonate?,Checks that there is a file in the playbook’s input.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,13,cec4ac98-aed7-4400-824b-2244a72dcc1a,condition,Filter UUIDs,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Lastline', 'filters': [[{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Lastline.Submission.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Completed'}}}]], 'accessor': 'Submission.Status'}}, 'iscontext': True}}]]}"
0,15,224d3a13-cd7a-405a-8241-4624625ab3d1,regular,Lastline Upload File,Upload file for analysis,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Lastline', 'filters': [[{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Lastline.Submission.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Completed'}}}]], 'accessor': 'Submission.Status'}}, 'iscontext': True}}]]}"
0,16,457087e7-a34c-4635-86ed-0aff1ddd2c13,regular,Lastline Check Status,Check submissions status,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Lastline', 'filters': [[{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Lastline.Submission.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Completed'}}}]], 'accessor': 'Submission.Status'}}, 'iscontext': True}}]]}"
0,0,489b704c-bef9-40e7-8aa8-f74cca308a94,start,,-,,,,,,
0,2,586df0a0-fceb-41e3-8e9d-124757b4a4bb,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,b0cb6625-0e6c-44ae-835c-684b21d0a6c1,regular,McAfee ATD Get Report,Retrieve the reports from McAfee ATD.,,,,,,
0,5,e589b774-3cee-4dff-8e14-788ef3590dfa,title,Done,finished,,,,,,
0,7,fddc93e3-f6fc-481c-8696-1bdaaf591562,condition,Is McAfee ATD sandbox enabled?,"Verify that there is a valid instance of McAfee ATD enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'McAfee Advanced Threat Defense'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,ac109c6f-fb89-498f-8ba7-877e50ee9019,condition,Filter taskId,Checks that valid files only have been sent to detonation.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'ATD.Task.taskId(val != -1)'}, 'iscontext': True}}]]}"
0,9,26e0e6b7-9804-434a-85d6-bb1a8aaff27d,regular,atd-check-status,Updates the status of the tasks in the context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'ATD.Task.taskId(val != -1)'}, 'iscontext': True}}]]}"
0,10,d8e19b0c-3dfa-41f8-86fa-2d12ff711340,condition,Is File type supported?,Check if file type is supported.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,11,3814f559-a639-4e80-8d6e-c74b9e96e495,regular,Set File to context,Set the file object into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|SYS|DLL|COM|SCR|CPL|OCX|CGI|DOC|DOTM|DOCX|DOTX|XLS|PPAM|XSLX|PPS|XLSB|PPSX|XLSM|PPSM|PPT|PPTX|PPTM|RTF|SHS|XLTM|SLDM|XLTX|SLDX|XLAM|THMX|DOCM|XAR|JTD|JTDC|PDF|SWF|GZ|7Z|TGZ|MSI|ZIP|LZH|CAB|LZMA|APK|JAR|CLASS|JPEG|PNG|GIF|CMD|ACE|BAT|ARJ|VBS|CHM|XML|LNK|URL|MOF|HTM|OCX|HTML|POTM|EML|POTX|MSG|PS1|VB|REG|VBA|WSC|VBE|WSF|VBS|WSH)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,12,9b8022fc-dfd0-4806-8ead-65f53804065f,condition,Is there a File to Detonate?,Checks that there is a file in the playbook’s input.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,13,7bd95c47-0c05-49e3-80ba-43d2f0e4e2b9,regular,Set Context,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,14,6e299488-408a-4b9d-82d0-cb053caf322e,regular,Mcafee ATD Upload File,upload a file/web URL for dynamic analysis by using the provided Analyzer Profile. Only single file/web URL can be submitted at a time.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,0,489b704c-bef9-40e7-8aa8-f74cca308a94,start,,-,,,,,,
0,2,cf1337d2-c99c-450b-8901-49614b2d9c39,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,ff8f8315-a4a4-4fe8-8008-c8ed819d3787,regular,SNDBOX Get Report,Retrieve the reports from McAfee ATD.,,,,,,
0,5,e589b774-3cee-4dff-8e14-788ef3590dfa,title,Done,finished,,,,,,
0,7,638f2725-3b53-453a-8c6d-6924686d24fa,condition,Is SNDBOX enabled?,"Verify that there is a valid instance of McAfee ATD enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'SNDBOX'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,9,105ec989-1fbe-4631-8eb8-4a1e10c68c85,regular,SNDBOX Get Info,Updates the status of the tasks in the context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'SNDBOX'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,ecc6003d-d40d-48d4-85fc-b7ffa076196d,condition,Is File type supported?,Check if file type is supported.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:DOC|DOT|XLS|CSV|XLT|XLM|PPT|POT|PPS|DOCX|DOCM|DOTX|DOTM|DOTM|XLSX|XLSM|XLTX|XLTM|XLSB|XLA|XLAM|IQY|PPTX|PPTM|POTX|PPSX|XML|PE32|RTF|PDF|VBS|VBE|PS1|JS|LNK|HTML|BAT)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:DOC|DOT|XLS|CSV|XLT|XLM|PPT|POT|PPS|DOCX|DOCM|DOTX|DOTM|DOTM|XLSX|XLSM|XLTX|XLTM|XLSB|XLA|XLAM|IQY|PPTX|PPTM|POTX|PPSX|XML|PE32|RTF|PDF|VBS|VBE|PS1|JS|LNK|HTML|BAT)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:DOC|DOT|XLS|CSV|XLT|XLM|PPT|POT|PPS|DOCX|DOCM|DOTX|DOTM|DOTM|XLSX|XLSM|XLTX|XLTM|XLSB|XLA|XLAM|IQY|PPTX|PPTM|POTX|PPSX|XML|PE32|RTF|PDF|VBS|VBE|PS1|JS|LNK|HTML|BAT)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,11,3814f559-a639-4e80-8d6e-c74b9e96e495,regular,Set File to context,Set the file object into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:DOC|DOT|XLS|CSV|XLT|XLM|PPT|POT|PPS|DOCX|DOCM|DOTX|DOTM|DOTM|XLSX|XLSM|XLTX|XLTM|XLSB|XLA|XLAM|IQY|PPTX|PPTM|POTX|PPSX|XML|PE32|RTF|PDF|VBS|VBE|PS1|JS|LNK|HTML|BAT)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:DOC|DOT|XLS|CSV|XLT|XLM|PPT|POT|PPS|DOCX|DOCM|DOTX|DOTM|DOTM|XLSX|XLSM|XLTX|XLTM|XLSB|XLA|XLAM|IQY|PPTX|PPTM|POTX|PPSX|XML|PE32|RTF|PDF|VBS|VBE|PS1|JS|LNK|HTML|BAT)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:DOC|DOT|XLS|CSV|XLT|XLM|PPT|POT|PPS|DOCX|DOCM|DOTX|DOTM|DOTM|XLSX|XLSM|XLTX|XLTM|XLSB|XLA|XLAM|IQY|PPTX|PPTM|POTX|PPSX|XML|PE32|RTF|PDF|VBS|VBE|PS1|JS|LNK|HTML|BAT)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,12,9b8022fc-dfd0-4806-8ead-65f53804065f,condition,Is there a File to Detonate?,Checks that there is a file in the playbook’s input.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,13,4076e5e1-d0fc-4bb0-8008-409053367a9e,regular,Set Context,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,14,9caed2f8-0d19-4950-8c2c-5bfdf48f54b0,condition,Check finish,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'SNDBOXAnalysis', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'SNDBOXAnalysis.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'finished'}}}]]}}, 'iscontext': True}}]]}"
0,15,06783b62-db07-4a32-8b18-17b530538c51,regular,SNDBOX Upload File,Uploads the submission to SNDBOX.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'SNDBOXAnalysis', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'SNDBOXAnalysis.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'finished'}}}]]}}, 'iscontext': True}}]]}"
0,0,29dcbc1e-0bb0-45f1-82ed-eb65b6ce039d,start,,Start,,,,,,
0,5,1378d2a9-9fcc-47d0-817f-9d9145740752,condition,Is ThreatGrid enabled?,Verify that there is a valid instance of ThreatGrid is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,e6a670a6-eff4-4b16-883b-f08e7d7e7bd3,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,80dc5945-a851-469d-8445-3930393aa5d0,regular,ThreatGrid Get Samples State,Get the sample state.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,11,754b0562-8ec3-4c58-8345-748d9cd51a72,regular,Set file to context,Set the file object into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,15,97fcf073-c63a-42d4-8e65-ba6d4814d859,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,16,93e193f6-a438-4349-861c-f0f99b4b3997,condition,Is there a file to detonate?,Checks whether there's a file to detonate - if not then the detonation is skipped,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,18,5eb99a51-d296-41dd-8a6e-93fceabc767f,condition,Is the file type supported?,Will not continue the execution if file type is not supported.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:EXE|DLL|JAR|JS|PDF|DOC|DOCX|RTF|XLS|PPT|PPTX|XML|ZIP|VBN|SEP|XZ|GZ|BZ2|TAR|MHTML|SWF|LNK|URL|MSI|JTD|JTT|JTDC|JTTC|HWP|HWT|HWPX|BAT|HTA|PS1|VBS|WSF|JSE|VBE|CHM)\\b'}}, 'ignorecase': True}]]}"
0,19,701d7a32-0c81-4fd3-83c9-fbc7aa6efd30,condition,Is the file size bigger than 0?,Check that fail size is bigger than 0,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'greaterThan', 'left': {'value': {'simple': 'File.Size'}, 'iscontext': True}, 'right': {'value': {'simple': '0'}}}]]}"
0,20,4fe8b8b6-097b-42e5-8d2a-7d7693101c90,regular,ThreatGrid Upload File,Submits a sample to threat grid for analysis,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'greaterThan', 'left': {'value': {'simple': 'File.Size'}, 'iscontext': True}, 'right': {'value': {'simple': '0'}}}]]}"
0,0,56650d59-750f-49e8-8323-9a38636631f6,start,,,,,,,,
0,5,e58d872c-656f-4687-8279-50ff40cb4009,condition,Is Anomali ThreatStream v2 enabled?,Checks if there is a valid instance of the Anomali ThreatStream v2 integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Anomali ThreatStream v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,1d556414-5fc2-441e-856c-27d1d0b0c207,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Anomali ThreatStream v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,124792e1-e06a-4d0c-8dd4-2fd5fc125aee,regular,ThreatStream Get Report,Returns a report of the file or URL that was submitted to the sandbox.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Anomali ThreatStream v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,11,832bc14a-ab8f-4bd3-8acf-78789433ee61,regular,Set file to context,Set the file object into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Anomali ThreatStream v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,15,9f3fb5f2-6b4e-4694-8db1-df2211b2b0fd,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step /#2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Anomali ThreatStream v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,16,abdd7f0e-18af-4a32-8bd2-be620253a970,condition,Is there a file to detonate?,"Checks if there is a file to detonate. If no file is found, detonation is skipped.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,19,75b5f3a3-d25a-45d4-8477-76e6473d06fd,condition,Is the file size bigger than 0?,Checks if the fail size is larger than 0.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'greaterThan', 'left': {'value': {'simple': 'File.Size'}, 'iscontext': True}, 'right': {'value': {'simple': '0'}}}]]}"
0,20,78cece2d-336e-41e1-89c8-a70deb8350ff,regular,ThreatStream Upload File,Submits a file or URL to the ThreatStream-hosted Sandbox for detonation.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'greaterThan', 'left': {'value': {'simple': 'File.Size'}, 'iscontext': True}, 'right': {'value': {'simple': '0'}}}]]}"
0,0,ff6c3afb-1f37-491b-8569-f2f9d6a79ff3,start,,,,,,,,
0,2,ea5344ac-b7ac-47ea-8703-30b93a2bba43,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,4d801593-76c0-45bc-880c-46572315ab6d,regular,WildFire Get Report,Retrieve results for a file hash using WildFire,,,,,,
0,5,7cb53d1d-e613-47cd-847e-c1908e384d53,title,Done,,,,,,,
0,6,5944d365-4547-4e91-8f62-fa295fa32b38,condition,Is there a File to detonate?,Look for files to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,7,f959299e-1445-4a65-85bf-d4f70a0c7ebf,condition,Is WildFire sandbox enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire'}}}, {'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire-v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,09aec71d-10ce-419d-836b-88f9d41a52eb,condition,Is the file type supported?,Check if file type is supported,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|OOXML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|OOXML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,11,16c9088e-43fa-494a-80f2-646461c74a66,regular,Set Context,Sets a value into the context with the given context key,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|OOXML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|OOXML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,12,10704220-2fa8-487b-8908-003505fad127,regular,WildFire Upload File,Uploads a file to WildFire for analysis.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|OOXML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}, {'operator': 'match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|OOXML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,0,47b6de2e-e418-4386-8888-860bc6d48175,start,,,,,,,,
0,1,585ad15b-5cfd-45bc-8825-97fe9b0540e1,regular,Submit the file to Wildfire,Upload file to WildFire for analysis.,,,,,,
0,2,c318d399-8159-4017-830e-81956395fe21,regular,Get wildfire report in requested format,Retrieve results for a file hash using WildFire,,,,,,
0,3,20ef69c7-2840-4c83-854b-ea213c875e4b,condition,Is Wildfire Available? ,,,,,,,
0,4,294e47a9-3554-41ba-8e46-315ff451a574,title,End ,,,,,,,
0,5,9c6eb442-5350-4f44-8fc8-4a60efc85dfa,regular,Also get WildFire report as PDF,Retrieve results for a file hash using WildFire,,,,,,
0,0,29dcbc1e-0bb0-45f1-82ed-eb65b6ce039d,start,,,,,,,,
0,5,8dec7425-dcfc-4b65-8810-02604bb775be,condition,Is WildFire enabled?,"Verify that there is a valid instance of Wildfire enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,e6a670a6-eff4-4b16-883b-f08e7d7e7bd3,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,014d826b-a0a1-425d-834b-c285d71ae68e,regular,Get PDF report,Download the pdf report to the War Room.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,9,190a26ed-0c09-4567-8bc2-a9bea3f53207,condition,Is there an MD5 hash?,Checks if there is an MD5 hash in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'accessor': 'MD5'}}, 'iscontext': True}}]]}"
0,10,489aac5a-850e-4b34-86bd-1d2812088a98,condition,Is  the file type supported?,Check if file type is supported.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'string.match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|XML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}, {'operator': 'string.match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|XML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,11,a707109d-e569-4fa6-853a-30cf5b5ffb50,regular,Set file to context,Set the file object into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'string.match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|XML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}, {'operator': 'string.match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|XML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,12,24e8b68e-759f-44e5-81d7-ced51d3c6618,regular,DetonateFile (WildFire),Detonate the file in WildFire.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'string.match', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|XML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}, {'operator': 'string.match', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': '.*(?:APK|JAR|DOC|DOCX|RTF|XLS|XLSX|PPT|PPTX|XML|PE32|PDF|DMG|PKG|RAR|7Z)\\b'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,13,1c7984d0-757a-481d-8d42-93b047c636da,condition,Is there a file to detonate?,Checks that there is a file in the playbook's input.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.File'}}, 'iscontext': True}}]]}"
0,0,b04c121d-294e-4dd0-8148-d9fe0f44be04,start,,Start,,,,,,
0,1,1abf1e54-1633-41fb-80b5-00a994d7c4b5,regular,ANYRUN Submit File from URL for Analysis,Submit a file or url for analysis.,,,,,,
0,2,faf98979-d9b0-4fcd-86e5-0004f3b98603,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,371e111a-9263-4708-86ae-961495255ff9,regular,ANYRUN Get Report,Get the report for a task created for a submitted file or url.,,,,,,
0,5,7e59cb60-98d6-49a0-8c7f-522c1247ee73,title,Done,Done,,,,,,
0,6,a1d00028-5388-4ea3-8877-cb5b7fb2a5d0,condition,Is there a download URL to detonate?,Look for file URLs to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,7,57c1be55-35b0-4527-83e8-66cc23fc33c9,condition,Is ANYRUN sandbox enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'ANYRUN'}}}]], 'transformers': [{'operator': 'getField', 'args': {'field': {'value': {'simple': 'state'}}}}]}}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}"
0,0,b04c121d-294e-4dd0-8148-d9fe0f44be04,start,,,,,,,,
0,1,30046540-617f-435d-82c9-5896133731c9,regular,JoeSecurity Upload File,,,,,,,
0,2,fa0efa09-f941-4246-8d98-ca8f49bfcb9f,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,ee24b1e9-5f12-4937-8ab3-91e440ef548b,regular,JoeSecurity Get Report,,,,,,,
0,5,7e59cb60-98d6-49a0-8c7f-522c1247ee73,title,Done,,,,,,,
0,6,cae5f3d9-284f-4540-8155-670496cc11b8,condition,Is there a File to detonate?,Look for file URLs to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.FileURL'}, 'iscontext': True}}]]}"
0,7,9bd7ec07-2925-4bff-8116-3ea116ef4340,condition,Is JoeSecurity sandbox enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Joe Security'}}}]], 'transformers': [{'operator': 'getField', 'args': {'field': {'value': {'simple': 'state'}}}}]}}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}"
0,0,219dcb92-ee7d-420e-816e-3f70b24bd953,start,,,,,,,,
0,1,9a30f2f0-d0e6-44d8-883b-1eb092c13372,regular,WildFire Upload File URL,URL of remote file to be uploaded,,,,,,
0,2,4f0aa551-1874-4223-875d-9701c6192be6,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,5,11650265-0035-421f-8e92-143af887b7a7,title,Done,,,,,,,
0,6,4a6315f7-7947-4cfc-8554-4e6b3edb4478,condition,Is there a File to detonate?,Look for file URLs to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.FileURL'}, 'iscontext': True}}]]}"
0,7,2a98f575-de73-4805-874d-87f4af43d99b,condition,Is WildFire sandbox enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire'}}}]], 'transformers': [{'operator': 'getField', 'args': {'field': {'value': {'simple': 'state'}}}}]}}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}"
0,8,83af3952-dd69-4765-8662-3b5371043d46,regular,WildFire Get Report,Retrieve results for a file hash using WildFire,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire'}}}]], 'transformers': [{'operator': 'getField', 'args': {'field': {'value': {'simple': 'state'}}}}]}}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}"
0,0,23448fd0-ac86-4add-8c75-4ba42a46b482,start,,Start,,,,,,
0,1,5ad7ba28-f794-4483-8aa9-82af5bdc0fbb,regular,ANYRUN Submit URL for Analysis,Submit a file or url for analysis.,,,,,,
0,2,8c93dd33-bf2d-4d0a-8e21-e8c14d3ef936,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,5,14e8fb5f-ed61-4ceb-83b5-4f76be05996e,title,Done,Done,,,,,,
0,6,0be14bfe-7eaa-497e-8bae-22d012fb21fd,condition,Is there a URL to detonate?,Look for URLs to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.URL'}}, 'iscontext': True}}]]}"
0,7,687ef7d7-ea6f-4289-8595-9d493fd94454,condition,Is ANYRUN sandbox enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'ANYRUN'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,d69a873b-1f51-4ef9-8a5a-a7efece28f03,regular,ANYRUN Get Report,Get the report for a task created for a submitted file or url.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'ANYRUN'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,29dcbc1e-0bb0-45f1-82ed-eb65b6ce039d,start,,,,,,,,
0,5,3e2a6ea9-7f88-4d10-8d29-3ed2d10eba4f,condition,Is CrowdStrike enabled?,"Verify that there is a valid instance of CrowdStrike enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,e6a670a6-eff4-4b16-883b-f08e7d7e7bd3,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,7226fb9e-9b1c-4e40-8823-428a6ef19aaa,regular,CrowdStrike Scan,Download the pdf report to the War Room.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,13,b34f751c-44b6-4bd9-8e69-dbcb9ea04e46,regular,CrowdStrike Upload Sample,Upload samle to crowdstrike.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VxStream'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,14,6ffba508-37e1-4647-88ea-265cd5475d61,condition,Is there a URL to detonate?,Checks whether there's a file to detonate.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,16,e34dd0a0-2806-4f3e-8c17-f4a05504222d,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,0,32fe7da3-a280-49c6-83d4-6cb1fb474458,start,,Playbook start point,,,,,,
0,3,40c6a1c6-dce9-4a0b-87b8-fec50f7933ae,title,Done,Done,,,,,,
0,11,7902e341-c29c-4037-8e6a-6c2289d3806e,playbook,Detonate URL - ThreatGrid,Detonate one or more URLs using the Threat Grid integration. This playbook returns relevant reports to the War Room and URL reputations to the context data.,,,,,,
0,12,7119396c-ac89-473c-82fa-c634c25788d6,playbook,Detonate URL - McAfee ATD,Detonates a URL using the McAfee Advanced Threat Defense sandbox integration.,,,,,,
0,13,7a53b305-64ef-47c4-85f7-8ff702cb4209,playbook,Detonate URL - JoeSecurity,"Detonates one or more URLs using the Joe Security sandbox integration.
Returns relevant reports to the War Room and url reputations to the context data.",,,,,,
0,14,2555400f-2fd3-4bdc-82e4-3e5be8948952,playbook,Detonate URL - CrowdStrike,Detonate one or more files using the Wildfire integration. This playbook returns relevant reports to the War Room and file reputations to the context data.,,,,,,
0,15,4e47aa4e-bef0-4566-8aae-b249bdf06ce0,playbook,Detonate URL - Lastline,Detonates a URL using the Lastline sandbox integration.,,,,,,
0,16,317e29bb-856f-4081-8fdd-f4a189d01c90,playbook,Detonate URL - Cuckoo,Detonates a file using Cuckoo sandbox,,,,,,
0,17,a2cbc7cf-2d9e-4eda-87e9-909b88265839,playbook,Detonate URL - ANYRUN,Detonates a URL using ANYRUN sandbox,,,,,,
0,0,680422e2-0806-4f2d-8d20-bc7f2589238e,start,,,,,,,,
0,1,172af11a-ff1d-48ba-8d65-3c6f625689c5,regular,JoeSecurity Upload URL,,,,,,,
0,2,dba7628f-dc23-4f39-8024-fe36dcd71e94,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,2e8a7348-8be0-44ac-821e-66db69ba0d74,regular,JoeSecurity Get Report,,,,,,,
0,5,8424c0cf-cc75-47b6-81f8-b4b382cb2a94,title,Done,,,,,,,
0,6,c02313e8-5f5f-4612-88dd-ff62f62ba263,condition,Is there a URL to detonate?,Look for URLs to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.URL'}}, 'iscontext': True}}]]}"
0,7,250f4b2f-28ad-4d9c-8db7-01e64d60fade,condition,Is JoeSecurity sandbox enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Joe Security'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,3f645918-1a91-4ba5-8a95-5d60fb441e43,regular,JoeSecurity Get Info,Get Info,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Joe Security'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,9,9c83e0a7-8cce-4a67-8320-90f35a40d2ef,regular,Set Context,reduce context level for future filters,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Joe Security'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,703b80c2-e281-498a-8d00-2bbf1e6f2df0,start,,,,,,,,
0,1,2e2c891a-2cbf-4ebd-8164-4791a89c3310,regular,Lastline Upload URL,Submit URL for analysis.,,,,,,
0,2,44d072d8-9786-4dd9-8bcb-630c89e2b8ee,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,7685f1a2-b64e-41a7-81f8-f3830168f714,regular,Lastline Get Report,Get analysis report,,,,,,
0,5,9cf17ba9-0559-471e-8012-1abbd588a590,condition,Is there a URL to detonate?,Checks that there is a URL in the playbook’s input.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,6,686f6312-301b-461a-877c-6e4ec794393f,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,9,5305d933-86c0-46b2-8889-9c675f21f978,condition,Is Lastline sandbox enabled?,"Verify that there is a valid instance of Lastline enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Lastline'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,b5e9fe45-6986-4e58-8ba4-229eafdcf817,condition,Filter UUIDs,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Lastline', 'filters': [[{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Lastline.Submission.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Completed'}}}]], 'accessor': 'Submission.Status'}}, 'iscontext': True}}]]}"
0,11,0fd4e66e-bf5d-4df8-8522-762d9f2e2e38,regular,Lastline Check Status,Check submissions status,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Lastline', 'filters': [[{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Lastline.Submission.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Completed'}}}]], 'accessor': 'Submission.Status'}}, 'iscontext': True}}]]}"
0,0,d2f4d7dc-4562-4517-8d63-3539676ca81d,start,,-,,,,,,
0,1,1ffe1273-53cc-4196-85ee-aeb00cdc3683,regular,McAfee ATD Upload URL,Uploads the submission to McAfee ATD.,,,,,,
0,2,d774d782-52bb-4667-8842-9401535bdf2f,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,139bb8bd-8c59-483e-8632-aa1031236b24,regular,McAfee ATD Get Report,Retrieve the reports from McAfee ATD.,,,,,,
0,5,7aef66ab-1f28-4a35-89d8-173760f509c5,condition,Is there a URL to detonate?,Checks that there is a URL in the playbook’s input.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,6,586f9a47-8d2a-4ff5-8ad5-788ddc8310ed,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,8,bd6b3429-b5e0-4bf5-8aa7-5b6305b016dc,condition,Filter taskId,Checks that valid URLs only have been sent to detonation.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'ATD', 'filters': [[{'operator': 'isNotEqualNumber', 'left': {'value': {'simple': 'ATD.Task.taskId'}, 'iscontext': True}, 'right': {'value': {'simple': '-1'}}}]], 'accessor': 'Task', 'transformers': [{'operator': 'getField', 'args': {'field': {'value': {'simple': 'taskId'}}}}]}}, 'iscontext': True}}]]}"
0,9,35d8af19-10dd-43fa-855d-1a99e08bbf12,condition,Is McAfee ATD sandbox enabled?,"Verify that there is a valid instance of McAfee ATD enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'McAfee Advanced Threat Defense'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,26775dbf-fff8-41c0-8379-28d0a99b8112,regular,atd-check-status,Updates the status of the tasks in the context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'McAfee Advanced Threat Defense'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,11,230fe216-0869-44e5-885a-8f7f32e4a7fa,regular,Set Context,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'McAfee Advanced Threat Defense'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,d2f4d7dc-4562-4517-8d63-3539676ca81d,start,,start,,,,,,
0,2,a9d60056-7ef8-4164-8748-f5016616e779,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,5,574c57f0-c341-4fb0-8576-5acd9a2ba120,condition,Is there a URL to detonate?,Checks that there is a URL in the playbook’s input.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.URL'}}, 'iscontext': True}}]]}"
0,6,586f9a47-8d2a-4ff5-8ad5-788ddc8310ed,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.URL'}}, 'iscontext': True}}]]}"
0,9,20e936c1-98ba-4255-8042-101aa9bcaf5a,condition,Is Phish.AI enabled?,"Verify that there is a valid instance of McAfee ATD enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Phish.AI'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,744dfdfb-f55d-4586-8783-addf3cd6fd12,regular,Get Report URL,"Checks on url's status, e.g. completed, in progress",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Phish.AI'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,11,46100a3a-dc92-4c08-8098-8baff8320399,regular,Scan URL,Check if url is phishing and get details about the brand that is being phished,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Phish.AI'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,29dcbc1e-0bb0-45f1-82ed-eb65b6ce039d,start,,,,,,,,
0,5,cacefc85-644c-48de-8ff3-545308a282eb,condition,Is ThreatGrid enabled?,"Verify that there is a valid instance of Threat Grid enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,e6a670a6-eff4-4b16-883b-f08e7d7e7bd3,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,1c8055d2-4a2e-46cb-8022-90113cbf80c1,regular,ThreatGrid Get Samples State,Download the pdf report to the War Room.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,12,7bd8d248-92aa-4d9f-8133-a468f9c72d21,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,13,409321e3-f6ef-4943-8dae-3bf0f34b6a8d,regular,ThreatGrid Upload File,Uplads a sample to threat grid,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,14,41ac2f94-eae1-4116-8773-8912d1f99d37,regular,URL to File,Create a file from url,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Grid'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,8de349d2-da6c-44b0-80fa-9ba905fae572,start,,Start,,,,,,
0,1,ebd0e978-215d-43e5-8ceb-54384a2f99ba,regular,ThreatStream Submit URL for Analysis,Submits a file or URL to the ThreatStream-hosted Sandbox for detonation.,,,,,,
0,2,8449fa75-aa65-469c-849d-89c02cb850f4,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,5,4cd6fbcd-1b55-40ed-8dfd-c54be310bccf,title,Done,Done,,,,,,
0,6,6788a219-1746-44bf-8dfe-6b5c0ef9f311,condition,Is there a URL to detonate?,Checks if there is at least one URL to detonate.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.URL'}}, 'iscontext': True}}]]}"
0,7,569601dc-c5d2-430b-8fe7-df84b0d9c3a9,condition,Is Anomali ThreatStream v2 enabled?,Checks if there is an active instance of the Anomali ThreatStream v2 integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Anomali ThreatStream v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,a9f1b51f-cb92-456b-8597-ed0f6816bc9d,regular,ThreatStream Get Report,Returns a report of the file or URL that was submitted to the sandbox.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Anomali ThreatStream v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,971d5a83-6e4e-4e07-88cd-5eb07b1c1a79,start,,,,,,,,
0,1,06bec756-9cbc-4e58-8b49-cc82a8ffffe5,regular,WildFire Upload File URL,Uploads the URL of a remote file to WildFire for analysis.,,,,,,
0,2,93934895-c2b1-4d90-85c8-e63de67192fa,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,5,5362d80a-dc8b-414e-8fc7-2988e917d2e0,title,Done,,,,,,,
0,6,cd801c53-6ba4-4bea-830a-0788255ebd82,condition,Is there a URL to detonate?,Look for file URLs to detonate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,7,b105e8d8-c34c-4bfe-8fc5-0f1a54ceb4cd,condition,Is WildFire-v2 enabled?,Check if integration instance is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire-v2'}}}]], 'transformers': [{'operator': 'getField', 'args': {'field': {'value': {'simple': 'state'}}}}]}}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}"
0,8,72d8fa60-0340-416d-86f7-cb24751b9a42,regular,WildFire Get Report,Retrieves results for a file hash using WildFire.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire-v2'}}}]], 'transformers': [{'operator': 'getField', 'args': {'field': {'value': {'simple': 'state'}}}}]}}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}"
0,9,876f9d98-9d32-42fe-87c0-4adbb1011c6b,regular,WildFire Upload URL,Uploads a URL of a webpage to WildFire for analysis.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'WildFire-v2'}}}]], 'transformers': [{'operator': 'getField', 'args': {'field': {'value': {'simple': 'state'}}}}]}}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}"
0,11,69021f37-e6c9-4ae6-8de2-f230e96c2c2b,condition,Was file url submission successful?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'WildFire', 'accessor': 'Report.Size'}}, 'iscontext': True}}]]}"
0,0,14cac14a-3745-46d2-8ef6-da411a06da52,start,,,,,,,,
0,2,5176c141-e27d-4814-8bfd-5cd510f2373a,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,d23be093-82be-472a-85df-b01e155fe19f,regular,Get Mail results,Get the results of a given mail export,,,,,,
0,5,9ed8fed0-adb4-4d5a-8de3-4390979be049,title,Done,,,,,,,
0,15,3f8f4650-cc6f-4dde-85cf-52875002b5a1,condition,Check downloadFile,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,16,f873bc49-88c8-4095-8ab1-440e337f2b0f,regular,Get Export status to context,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,17,b77d974e-d9c0-4ace-87e1-4344eb70c3e9,regular,Download Export file,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,18,29cf7602-509a-49b1-8a73-558783b23992,condition,Check if status COMPLETED,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'GoogleVault', 'accessor': 'Matter.Export.Status'}}, 'iscontext': True}, 'right': {'value': {'simple': 'COMPLETED'}}}]]}"
0,19,1662b04a-4594-48d7-8045-cbc5ab3e1d62,regular,Polling Timeout,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'GoogleVault', 'accessor': 'Matter.Export.Status'}}, 'iscontext': True}, 'right': {'value': {'simple': 'COMPLETED'}}}]]}"
0,20,20e92d00-1da1-4519-88a3-b94b3594631e,condition,Check Search Type,,,,,,,"{'label': 'Mail type', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.SearchtType'}}, 'iscontext': True}, 'right': {'value': {'simple': 'Mail'}}}]]}"
0,21,976638c2-22e7-400e-8a33-d35b13ad9cc5,regular,Get Groups results,Get the results of a given mail export,,,,,,"{'label': 'Mail type', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.SearchtType'}}, 'iscontext': True}, 'right': {'value': {'simple': 'Mail'}}}]]}"
0,22,b8f65130-b7ff-4a37-81c9-385a68caf2f4,regular,Get Drive results,Get the results of a given mail export,,,,,,"{'label': 'Mail type', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.SearchtType'}}, 'iscontext': True}, 'right': {'value': {'simple': 'Mail'}}}]]}"
0,23,b6a4b39d-b0b9-4914-856a-1f8365e43442,regular,Get Export status to context,,,,,,,"{'label': 'Mail type', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.SearchtType'}}, 'iscontext': True}, 'right': {'value': {'simple': 'Mail'}}}]]}"
0,0,3f6b8522-c653-4608-800d-f7da232392fb,start,,,,,,,,
0,16,7fd055ad-aeb8-476b-8ba9-ab33781d2185,condition,Is there a domain to check?,Determines whether the playbook's input contains a domain name.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Domain'}, 'iscontext': True}}]]}"
0,20,1d8b490b-45a3-4155-8773-a55a106aab5e,regular,Get domain Reputation,"Get the domain reputation from every integration that supports the `!domain`
 command.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Domain'}, 'iscontext': True}}]]}"
0,24,f6da103d-6baa-4afb-8b7d-65740714dcf2,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Domain'}, 'iscontext': True}}]]}"
0,25,5acde632-6023-47ed-8e24-44a22d0f313b,condition,Should we get the Domain Reputation?,"Should the system retrieve the domain reputation from all of the relevant integration?
Default: True
 ",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.GetReputation'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,26,5e53200b-ffd1-47f3-8cf1-1cb125623f98,condition,Is Virus Total Private API enabled?,Checks if there is an active instance of the Virus Total Private API enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,27,22c253ae-95f7-45cb-86cb-e604fe2b2c72,title,Enrich using Virus Total Private API,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,28,70059258-fba3-4615-8fe6-b36360e23e18,regular,Get report on domain,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,29,8074fcf5-1164-472b-8367-18d67bcf14ce,title,Get domain reputation,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,3f6b8522-c653-4608-800d-f7da232392fb,start,,,,,,,,
0,16,55a34733-b900-4566-88d7-30365d4e3866,condition,Are there Domains to check?,Determines whether the playbook's input contains a domain name.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Domain'}, 'iscontext': True}}], [{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.commands.name'}, 'iscontext': True}, 'right': {'value': {'simple': 'domain'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,20,eb63c499-8a19-481b-8140-aa34e63342b0,regular,Get Domain Reputation,Gets domain reputation by invoking domain related engines. Returns the domain score according to the engines.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Domain'}, 'iscontext': True}}], [{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.commands.name'}, 'iscontext': True}, 'right': {'value': {'simple': 'domain'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,24,f6da103d-6baa-4afb-8b7d-65740714dcf2,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Domain'}, 'iscontext': True}}], [{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.commands.name'}, 'iscontext': True}, 'right': {'value': {'simple': 'domain'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,0,3f6b8522-c653-4608-800d-f7da232392fb,start,,,,,,,,
0,16,b0ff1fa7-e741-4cb0-8fb6-98929d4d6e7d,condition,Is there a domain to enrich?,Checks whether the playbook's input contains at least one domain name to enrich.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Domain'}, 'iscontext': True}}]]}"
0,24,f6da103d-6baa-4afb-8b7d-65740714dcf2,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Domain'}, 'iscontext': True}}]]}"
0,26,3ab86896-10aa-45be-83cf-7dcca9b6aa92,condition,Is VirusTotal Private API enabled?,Checks if there is an active instance of the Virus Total Private API integration enabled. enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,28,a30a5504-f8f1-41cc-8dcb-bb0b2a940bc3,regular,Get VirusTotal report for domains,Gets a VirusTotal report for the specified domain.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,29,369e9301-a4f9-415f-8c45-902304453296,regular,Get domain category,Gets the category of the domain as found in Cisco Umbrella Investigation records.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,30,29cca13b-1b82-4db3-8463-2a4f537546d0,condition,Is Cisco Umbrella Investigate enabled?,Checks if there is an active instance of the Cisco Umbrella Investigate integration enabled. enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cisco Umbrella Investigate'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,10b003be-68f2-4e57-8f11-d0475f1aac42,start,,,,,,,,
0,4,01ab9a35-e60e-4331-826d-48194fb5a771,title,Done,,,,,,,
0,5,58fbce31-8318-47d5-881e-b17a428d22e0,condition,Are there Email addresses to check?,Checks that the input email address is not empty,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,7,3291020c-5ec9-4f58-8814-27c07a575dc0,regular,Check Email addresses  reputation,Get email address reputation from all supporting integrations,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,9,550ff29a-79f5-4274-847f-fabf4193d2a7,regular,Mark Email addresses as internal or external,Add to each email address a NetworkType attribute,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,10,e82515ea-9f9a-4273-8182-e6a84b24e4d6,title,Internal,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,11,d501d6f3-d086-40fa-8c28-052fc32787fb,title,External,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,12,e66c5a66-3272-4ef8-8283-b0bc74af7cd0,regular,Get Email addresses info from Active Directory,Use Active Directory to get internal email address user information,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,13,f335c2d8-9c33-4b5e-8cf6-d8ab05f9cb9a,condition,Are there external email addresses?,Check for Email Addresses with external NetworkType ,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,14,882a4290-4166-4b8a-81f9-b5d163f34f06,condition,Are there internal email addresses?,Check for Email Addresses with internal NetworkType ,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,15,ab84c271-880d-4dc8-8feb-e73c2d4004e0,regular,Check Email addresses DomainSquatting Reputation,Check if an email address's domain is trying to squat other domain using Levenshtein distance algorithm,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,16,9752ef45-8db2-45cc-80df-0926909ddf73,title,Active Directory,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,17,a030b50a-b7ba-4aba-89db-eb2a50d29e4d,condition,Is Active Directory enabled?,Check if there's an active instance of Active Directory,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,18,2a3f300c-f84f-43ac-8ec7-c98afd558416,condition,Is there a domain list input?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,19,b0e3026b-ae43-4032-8074-381bfd0f8fa3,condition,Should the system get the Email Addresses reputation?,"
Should the system retrieve the  Email Addresses reputation from all of the relevant integration?
Default: True",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.GetReputation'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,0,10b003be-68f2-4e57-8f11-d0475f1aac42,start,,,,,,,,
0,4,01ab9a35-e60e-4331-826d-48194fb5a771,title,Done,,,,,,,
0,5,58fbce31-8318-47d5-881e-b17a428d22e0,condition,Are there Email addresses to check?,Checks that the input email address is not empty,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,7,3291020c-5ec9-4f58-8814-27c07a575dc0,regular,Check Email addresses  reputation,Get email address reputation from all supporting integrations,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,9,550ff29a-79f5-4274-847f-fabf4193d2a7,regular,Mark Email addresses as internal or external,Add to each email address a NetworkType attribute,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,10,e82515ea-9f9a-4273-8182-e6a84b24e4d6,title,Internal,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,11,d501d6f3-d086-40fa-8c28-052fc32787fb,title,External,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,12,e66c5a66-3272-4ef8-8283-b0bc74af7cd0,regular,Get Email addresses info from Active Directory,Use Active Directory to get internal email address user information,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,13,f335c2d8-9c33-4b5e-8cf6-d8ab05f9cb9a,condition,Are there external email addresses?,Check for Email Addresses with external NetworkType ,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,14,882a4290-4166-4b8a-81f9-b5d163f34f06,condition,Are there internal email addresses?,Check for Email Addresses with internal NetworkType ,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,15,ab84c271-880d-4dc8-8feb-e73c2d4004e0,regular,Check Email addresses DomainSquatting Reputation,Check if an email address's domain is trying to squat other domain using Levenshtein distance algorithm,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,16,9752ef45-8db2-45cc-80df-0926909ddf73,title,Active Directory,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,17,a030b50a-b7ba-4aba-89db-eb2a50d29e4d,condition,Is Active Directory enabled?,Check if there's an active instance of Active Directory,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,18,2a3f300c-f84f-43ac-8ec7-c98afd558416,condition,Is there a domain list input?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}}]]}"
0,0,10b003be-68f2-4e57-8f11-d0475f1aac42,start,,,,,,,,
0,4,01ab9a35-e60e-4331-826d-48194fb5a771,title,Done,,,,,,,
0,5,db8113cf-a721-49a6-83dd-152e83c7d962,condition,Are there email addresses to check?,Determines whether the playbook's input contains at least one email address.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,9,17c82691-cc28-445a-8aea-129217f589d6,regular,Classify email addresses as internal or external,"Adds a NetworkType attribute to all email addresses. The NetworkType attribute determines whether the email address is an internal or external email address, according to the domains that were passed as arguments to this playbook.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,10,e82515ea-9f9a-4273-8182-e6a84b24e4d6,title,Internal,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,11,d501d6f3-d086-40fa-8c28-052fc32787fb,title,External,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,12,266c8054-586a-4b62-811b-d13147f12e54,regular,Get email address info from Active Directory,Uses Active Directory to get user information for internal email addresses.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,13,2d740d11-a326-4913-83f1-8df803c0a3eb,condition,Are there any external email addresses?,"Checks whether there is at least one email address with a NetworkType attribute set to ""Internal"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,14,e521733d-b152-4a1f-8050-e7658405a187,condition,Are there internal email addresses?,"Checks whether there are email addresses with a NetworkType attribute value of ""Internal"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,15,7d4c6562-651c-487d-834e-f3921527c76e,regular,Check email addresses for domain-squatting,Checks if an email address's domain is trying to squat other domains using Levenshtein distance algorithm.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,17,71e0fb34-e1c8-4606-8462-1f83a0a2cb56,condition,Is Active Directory Query v2 enabled?,Checks if there's an active instance of the Active Directory Query v2 integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,18,1f1a6cd8-5aaa-4b0a-8147-e91dc6beec49,condition,Is there a domain list input?,Checks if there is at least one domain to check for domain-squatting.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,20,3ecf1917-78f6-4350-84bb-704fdaa1bf05,title,No Email Addresses,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,0,10b003be-68f2-4e57-8f11-d0475f1aac42,start,,,,,,,,
0,4,01ab9a35-e60e-4331-826d-48194fb5a771,title,Done,,,,,,,
0,5,db8113cf-a721-49a6-83dd-152e83c7d962,condition,Are there email addresses to check?,Determines whether the playbook's input contains at least one email address.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,9,17c82691-cc28-445a-8aea-129217f589d6,regular,Classify email addresses as internal or external,"Adds a NetworkType attribute to all email addresses. The NetworkType attribute determines whether the email address is an internal or external email address, according to the domains that were passed as arguments to this playbook.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,10,e82515ea-9f9a-4273-8182-e6a84b24e4d6,title,Internal,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,11,d501d6f3-d086-40fa-8c28-052fc32787fb,title,External,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,12,5499e24d-dd70-4b65-88af-eeca45b06f9f,regular,Get email address info from Active Directory,Uses Active Directory to get user information for internal emails. addresses.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,13,2d740d11-a326-4913-83f1-8df803c0a3eb,condition,Are there any external email addresses?,"Checks whether there are email addresses with a NetworkType attribute value of ""External"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,14,e521733d-b152-4a1f-8050-e7658405a187,condition,Are there any internal email addresses?,"Checks whether there are email addresses with a NetworkType attribute value of ""Internal"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,15,14d9b7c3-73b3-49e7-887a-82c080a62d38,regular,Check email addresses for domain-squatting,Checks if an email address's domain is trying to squat other domains using Levenshtein distance algorithm.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,17,252874b2-867f-4406-8442-cc3999fac864,condition,Is Active Directory enabled?,Checks if there's an active instance of the Active Directory integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,18,1f1a6cd8-5aaa-4b0a-8147-e91dc6beec49,condition,Is there a domain list input?,Checks if there is at least one domain to check for domain-squatting.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,20,3ecf1917-78f6-4350-84bb-704fdaa1bf05,title,No Email Addresses,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Email'}, 'iscontext': True}, 'ignorecase': True}]]}"
0,0,5c790e9c-edcd-4ad9-8a35-05451eb582df,start,,,,,,,,
0,1,b2c6a043-bedf-40e9-8b34-064891fa6597,condition,Use D2 agent?,,,,,,,
0,2,8c9dec86-a668-4e3e-8824-075fe18330ac,playbook,D2 - Endpoint data collection,"Uses Demisto's d2 agent to collect data from an endpoint for IR purposes.

Input:
* Hostname (default: ${Endpoint.Hostname})
* OS (default: windows)
* Credentials (default: Admin)
* Path (default: None)",,,,,,
0,3,dbfc8aa8-e3e8-4b03-8a20-2dc0edf62cae,title,EDR products,,,,,,,
0,8,a726afff-a81d-4588-865c-f8085a6f41c2,title,Done,,,,,,,
0,10,3359e593-8218-4132-8a69-d48fc9aa78a7,playbook,MAR - Endpoint data collection,,,,,,,
0,11,121a30fb-c5ea-41d3-86db-e9753c08ada7,playbook,Sentinel One - Endpoint data collection,,,,,,,
0,0,1635626d-e92f-49c7-85a7-b4d1632d1e38,start,,,,,,,,
0,1,50264655-eac1-4439-809b-32f93a19c825,condition,Is Cylance Protect v2 enabled?,Checks if there is an active instance of the Cylance Protect v2 integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,2,6fc275f9-cd51-4d40-8fe4-52a92bbc6af7,regular,Get all Cylance Protect devices,Gets information about all devices that are available in Cylance Protect.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,3,ec7a9e06-60d0-4c25-8ed4-1cb9d0fe92f6,regular,Set enriched device details,"Sets the device that was enriched in another context key. That key will contain only the device that was enriched using the provided hostname, and will be the output of the playbook.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,4,83e2be36-d5ef-43df-80b3-c77e95e19780,regular,Set device list,"Sets the devices in another context key - ""CylanceProtectAllDevices"". Setting them under that key ensures proper filtering in the next tasks.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,5,8a61ee6d-786a-4ec3-8f9e-fe49f90c1930,condition,Was a device found?,Checks whether any of the hostnames for enrichment were enriched using Cylance Protect v2.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'CylanceProtectAllDevices', 'filters': [[{'operator': 'in', 'left': {'value': {'simple': 'CylanceProtectAllDevices.Hostname'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]], 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,6,3849ea50-af6b-4ce4-8c43-c76f660fa7f6,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'CylanceProtectAllDevices', 'filters': [[{'operator': 'in', 'left': {'value': {'simple': 'CylanceProtectAllDevices.Hostname'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]], 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,0,29bcd70f-1953-4061-84ce-4cde781ad9f7,start,,,,,,,,
0,1,54895e0d-9904-4e62-8f45-ebd0d17ad5c9,title,Endpoint Products,,,,,,,
0,2,69d20bc5-f201-440f-8d93-6054c33af852,condition,Is ePO enabled?,,,,,,,
0,3,e7395d7d-a2cf-44f2-8c9c-399c1fe1e390,condition,Is there an Endpoint Hostname to run on?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,4,b95011d0-fd23-4e65-8ea9-560c5aead197,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,5,c91a3fdb-160c-42d9-87ef-5fb240ad2565,regular,Get host information from ePO,ePO: Get host information,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,6,7a3a4170-f604-471b-8962-87590bb2d505,condition,Is SentinelOne enabled?,Check if there is any active instance of this brand,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,7,1b8c3de7-7fc1-4ff9-8a90-34c4750087ef,regular,Get host information from SentinelOne,SentinelOne: Get host information,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,8,2b7a6a53-6c8d-4dce-8ce6-56ae0da3a917,condition,Is Carbon Black Enterprise Response enabled?,Check if there is any active instance of this brand,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,9,2cf9473e-32de-4e15-8784-59b357c85c4e,regular,Get host information from Carbon Black Enterprise Response,Carbon Black Enterprise Response: Get host information ,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,10,86a1a174-c652-4d82-8f00-2f72d718ac7f,condition,Is CrowdStrike Falcon Host enabled?,Check if there is any active instance of this brand,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,14,feb95688-7d7c-4ed4-8eb8-5a37ed9101cf,condition,Is Cylance Protect enabled?,Check if there is any active instance of this brand,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,15,9c2a5d9a-05dd-4d63-8acd-af890eebbab5,regular,Get host information from Cylance Protect, Cylance Protect: Get host information,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,16,24d57109-73e3-4b01-822d-b40cb89af9e8,title,ePO,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,17,589ec412-b56a-42a2-87c1-09e279e28535,title,Sentinel One,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,18,6cf08862-644d-479e-89ce-f9e173a8c562,title,Carbon Black Enterprise Response,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,19,7c2eb34e-c326-438b-8a53-d57dc8872f92,title,Cylance Protect,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,20,5d371f29-3a4c-43c5-8f71-b383db2e5320,title,CrowdStrike Falcon Host,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,22,f9ed7e73-031c-41e3-8da7-ec396363d74e,condition,Is Active Directory enabled?,Check if there is any active instance of this brand,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,23,b73cced2-42a6-4e86-8b30-3c0f21e44dfa,regular,Get host information from Active Directory,Active Directory: Get host information,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,24,9706cc39-d338-44cd-8ee1-efc5ea95b04d,title,Active Directory,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,25,b743dbf9-c2c0-4529-8dad-92ffe5647134,playbook,CrowdStrike Endpoint Enrichment,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,0,29bcd70f-1953-4061-84ce-4cde781ad9f7,start,,,,,,,,
0,1,54895e0d-9904-4e62-8f45-ebd0d17ad5c9,title,Endpoint Products,,,,,,,
0,2,c9799048-288a-40cc-8d2f-c561d0ea2f6b,condition,Is McAfee ePolicy Orchestrator enabled?,Checks if there is an active instance of the McAfee ePolicy Orchestrator integration enabled. integration enabled.,,,,,,
0,3,efeca58b-3c8f-40aa-8c2e-f9e84257b1bb,condition,Is there an endpoint to enrich?,Checks whether there is at least one endpoint to enrich (by hostname).,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,4,ea90c16b-6985-4f28-816f-78608df3fe51,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,5,44a06d71-1772-47af-8d41-8c6dbdd149e7,regular,Get host information from McAfee ePO,Gets host information from McAfee ePolicy Orchestrator.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,8,9fa921fa-d196-40ba-8419-ed0c4f838ab8,condition,Is Carbon Black Enterprise Response enabled?,Checks if there is an active instance of the Carbon Black Enterprise Response integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,9,79f17c3a-2456-47d9-8e68-cc3d84ef01bd,regular,Get host information from Carbon Black Enterprise Response,Gets host information from Carbon Black Enterprise Response.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,10,216aed2b-2f34-4c5e-8c54-60b978218896,condition,Is CrowdStrike Falcon Host enabled?,Checks if there is an active instance of the CrowdStrike Falcon Host integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,16,d9d617d9-2efd-466e-8ce7-190f8db83b95,title,McAfee ePolicy Orchestrator,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,18,6cf08862-644d-479e-89ce-f9e173a8c562,title,Carbon Black Enterprise Response,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,19,471d3862-a05c-42b1-871d-c1faa2fbb7a9,title,Cylance Protect v2,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,20,5d371f29-3a4c-43c5-8f71-b383db2e5320,title,CrowdStrike Falcon Host,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,22,f7f190b9-5a39-4d8a-83a5-77d5a023f0d4,condition,Is Active Directory Query v2 enabled?,Checks if there is an active instance of the Active Directory Query v2 integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Active Directory Query v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,23,23c75906-3b4e-42e8-8e32-c883d5f06fb3,regular,Get host information from Active Directory,"Uses Active Directory to retrieve detailed information about the computer of the account specified. The computer can be specified by name, email address, or as an Active Directory Distinguished Name (DN).
If no filters are specified, returns all computers.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Active Directory Query v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,24,9706cc39-d338-44cd-8ee1-efc5ea95b04d,title,Active Directory,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Active Directory Query v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,26,c3597e3d-8bd1-460c-862f-f40421717b16,playbook,Endpoint Enrichment - Cylance Protect v2,Enriches endpoints using the Cylance Protect v2 integration.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Active Directory Query v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,27,f74a190a-1427-4557-8cf1-ff7865da3042,regular,Get Crowdstrike device ID,Gets the Crowdstrike Falcon Host device ID that corresponds to the endpoint that is being enriched. The device ID is necessary to get information about the endpoint.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Active Directory Query v2'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,28,9c60a60d-b2f3-4707-8b0f-690891e080d0,condition,Was a device ID found?,Checks whether a Crowdstrike device ID was found for the hostname that is being enriched.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'FalconHostDevices'}}, 'iscontext': True}}]]}"
0,29,477738d4-3629-410f-86bb-84181caeacd2,regular,Get host information from Crowdstrike Falcon Host,"Gets details for one or more devices, according to device ID.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'FalconHostDevices'}}, 'iscontext': True}}]]}"
0,0,29bcd70f-1953-4061-84ce-4cde781ad9f7,start,,,,,,,,
0,1,54895e0d-9904-4e62-8f45-ebd0d17ad5c9,title,Endpoint Products,,,,,,,
0,2,c9799048-288a-40cc-8d2f-c561d0ea2f6b,condition,Is McAfee ePolicy Orchestrator enabled?,Checks if there is any active instance of the McAfee ePolicy Orchestrator integration enabled.,,,,,,
0,3,efeca58b-3c8f-40aa-8c2e-f9e84257b1bb,condition,Is there an endpoint to enrich?,Checks whether there is at least one endpoint to enrich (by hostname).,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,4,b95011d0-fd23-4e65-8ea9-560c5aead197,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,5,44a06d71-1772-47af-8d41-8c6dbdd149e7,regular,Get host information from ePO,Gets host information from McAfee ePolicy Orchestrator.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,8,9cee85fe-c940-400e-88e8-b0afb46fbb36,condition,Is Carbon Black Enterprise Response enabled?,Checks if there is any active instance of the Carbon Black Enterprise integration enabled. Response.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,9,6f8c1606-b44a-4a22-863d-c90276b71cf4,regular,Get host information from Carbon Black Enterprise Response,Gets host information from Carbon Black Enterprise Response.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,10,216aed2b-2f34-4c5e-8c54-60b978218896,condition,Is CrowdStrike Falcon Host enabled?,Checks if there is any active instance of the CrowdStrike Falcon Host integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,14,1d8f2002-479e-45f0-80c2-866cea427467,condition,Is Cylance Protect enabled?,Checks if there is any active instance of the Cylance Protect integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,15,1453a615-b9c1-48bc-853a-63a71d3a145e,regular,Get host information from Cylance Protect,Gets host information from Cylance Protect.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,16,d9d617d9-2efd-466e-8ce7-190f8db83b95,title,McAfee ePolicy Orchestrator,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,18,6cf08862-644d-479e-89ce-f9e173a8c562,title,Carbon Black Enterprise Response,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,19,7c2eb34e-c326-438b-8a53-d57dc8872f92,title,Cylance Protect,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,20,5d371f29-3a4c-43c5-8f71-b383db2e5320,title,CrowdStrike Falcon Host,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,22,d55e2614-b89c-4e02-85ec-5e63ea3026aa,condition,Is Active Directory enabled?,Checks if there is any active instance of the Active Directory integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'activedir'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,23,827cb856-fb98-46fb-8932-1a2b03d3f928,regular,Get host information from Active Directory,"Use Active Directory to retrieve detailed information about a computer account. The computer can be specified by name, email address, or as an Active Directory Distinguished Name (DN).
If no filters are specified, the result will show all computers.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'activedir'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,24,9706cc39-d338-44cd-8ee1-efc5ea95b04d,title,Active Directory,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'activedir'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,25,71baffa3-cd35-4cb0-8f50-0bd4c45fbc70,playbook,CrowdStrike Endpoint Enrichment,Enrich Endpoint with CrowdStrike,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'activedir'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]]}}, 'iscontext': True}}]]}"
0,0,start-enrich,start,,,,,,,,
0,5,enrich-integ,title,Enrich with Integrations,,,,,,,
0,8,check-res,title,Check Result,,,,,,,
0,9,enrich-done,regular,Done,,,,,,,
0,10,1b38d3b8-4657-4cea-84f9-6e4ac2b5d544,condition,Do we have MD5 hashes?,,,,,,,
0,11,d2de03c7-2e14-40b0-83f6-dee616098d0e,regular,Check MD5s,,,,,,,
0,12,8c9ccba0-d9d6-477e-8774-3f6fc8624a57,condition,Do we have SHA1 hashes?,,,,,,,
0,13,b01bef15-7c9d-40a8-83e7-7fe9474399d4,regular,Check SHA1s,,,,,,,
0,14,5006c24b-1bc8-4af3-86be-0944cb97d7db,condition,Do we have SHA256 hashes?,,,,,,,
0,15,57fc5852-cd27-43ba-87fc-03f8fd220b4d,condition,Do we have IPs?,,,,,,,
0,16,5417106f-4250-4478-8ce6-5bc2465393f9,condition,Do we have URLs?,,,,,,,
0,18,c54d3c30-e2bb-47af-83a0-bfe2279edc19,regular,Check SHA256s,,,,,,,
0,19,de7cff35-df2d-4e32-8f3e-657226146b05,regular,Check IPs,,,,,,,
0,20,015bee76-dcfa-4a82-8db6-0ca8e268c7ab,regular,Check URLs,,,,,,,
0,0,8bf06fd9-9465-4a79-82cc-f44ea90e58af,start,,,,,,,,
0,2,da777ade-9576-497d-864a-11802267cf01,condition,Any malicious files detected?,,,,,,,
0,4,6e8c6fbc-ebf0-45a8-841f-29e6e259ce73,regular,Close incident,,,,,,,
0,5,c50351fa-76f1-43ce-852a-de0c66d9535b,playbook,,,,,,,,
0,6,9d489c78-8d21-4906-8121-e42a2bcfa69f,regular,DXL - Push file hashes as malicious,Deliver the specified event to the DXL fabric,,,,,,
0,0,f0825cf1-1ad4-4e7d-8153-da160deff742,start,,,,,,,,
0,2,a57644c8-775a-42ad-8800-3ac1a1d138cd,condition,Any malicious files detected?,,,,,,,
0,4,b27ad1bb-4eff-482e-82e1-ba2d4f5c2443,regular,Close incident,,,,,,,
0,6,37bc441a-8053-49ea-8abf-2ffae14fe359,regular,DXL - Push file hashes as malicious,Deliver the specified event to the DXL fabric,,,,,,
0,7,bfffbaa1-a550-47bd-8e84-e6c941cde205,playbook,,,,,,,,
0,0,cdd6228a-7feb-4386-8ab1-7dfdf77d99c2,start,,,,,,,,
0,1,92a63802-d111-4add-8e92-03f485d20bab,playbook,IP Enrichment - Generic,Enrich IP using one or more integrations,,,,,,
0,2,427040f6-9903-4122-8537-bd72d6fcdab2,playbook,URL Enrichment - Generic,Enrich URL using one or more integrations,,,,,,
0,9,7ea079dc-c904-4088-878d-908e7b5b1ab3,playbook,Email Address Enrichment - Generic,Get email address reputation using one or more integrations,,,,,,
0,10,06158760-6f5f-466e-8e57-d37f7ec29066,playbook,Endpoint Enrichment - Generic,Enrich an Endpoint Hostname using one or more integrations,,,,,,
0,11,5799a021-f77c-457b-85bc-e362b7ff4b43,playbook,Domain Enrichment - Generic,Enrich Domain using one or more integrations,,,,,,
0,12,f9ef04ef-5311-4cd3-8c5e-eff47f95b3d3,playbook,Account Enrichment - Generic,Enrich Accounts using one or more integrations,,,,,,
0,13,07d8b6e7-df26-4c17-80f0-e8bd093720e0,playbook,File Enrichment - Generic,Get file reputation using one or more integrations,,,,,,
0,14,a362425a-64c2-4d6c-8f5e-fcd9db4c4870,playbook,,Get indicators internal Dbot score,,,,,,
0,15,38007764-1687-47b1-8490-0f3cded9dc95,title,Done,,,,,,,
0,0,cdd6228a-7feb-4386-8ab1-7dfdf77d99c2,start,,,,,,,,
0,1,92a63802-d111-4add-8e92-03f485d20bab,playbook,IP Enrichment - Generic,Enrich IP using one or more integrations,,,,,,
0,2,427040f6-9903-4122-8537-bd72d6fcdab2,playbook,URL Enrichment - Generic,Enrich URL using one or more integrations,,,,,,
0,9,7ea079dc-c904-4088-878d-908e7b5b1ab3,playbook,Email Address Enrichment - Generic,Get email address reputation using one or more integrations,,,,,,
0,10,06158760-6f5f-466e-8e57-d37f7ec29066,playbook,Endpoint Enrichment - Generic,Enrich an Endpoint Hostname using one or more integrations,,,,,,
0,11,5799a021-f77c-457b-85bc-e362b7ff4b43,playbook,Domain Enrichment - Generic,Enrich Domain using one or more integrations,,,,,,
0,12,f9ef04ef-5311-4cd3-8c5e-eff47f95b3d3,playbook,Account Enrichment - Generic,Enrich Accounts using one or more integrations,,,,,,
0,13,07d8b6e7-df26-4c17-80f0-e8bd093720e0,playbook,File Enrichment - Generic,Get file reputation using one or more integrations,,,,,,
0,15,38007764-1687-47b1-8490-0f3cded9dc95,title,Done,,,,,,,
0,0,cdd6228a-7feb-4386-8ab1-7dfdf77d99c2,start,,,,,,,,
0,15,38007764-1687-47b1-8490-0f3cded9dc95,title,Done,,,,,,,
0,16,afe0c443-753d-4633-89e1-0d77dc533447,playbook,IP Enrichment - Generic v2,"Enrich IP using one or more integrations.

IP enrichment includes:
* Resolve IP to Hostname (DNS)
* Threat information
* Separate internal and external addresses
* IP reputation
* For internal addresses, get host information",,,,,,
0,18,8189698a-475c-433b-8fbf-20275b3b2084,playbook,File Enrichment - Generic v2,,,,,,,
0,19,b00cb02f-d44b-4e40-8c27-281d17a94723,playbook,URL Enrichment - Generic v2,,,,,,,
0,22,6245f7fc-b1cc-4120-81da-d3320f809b03,playbook,Domain Enrichment - Generic v2,"Enrich domains using one or more integrations.
Domain enrichment includes:
* Threat information",,,,,,
0,23,0ba8dffe-9aac-40a7-8303-ff40de2d91f9,playbook,Email Address Enrichment - Generic v2.1,,,,,,,
0,24,7f313517-52cb-4653-8c77-08819d4910f3,playbook,Account Enrichment - Generic v2.1,,,,,,,
0,25,473ab066-87e5-408d-8317-70e38ead40ca,playbook,Endpoint Enrichment - Generic v2.1,,,,,,,
0,0,cdd6228a-7feb-4386-8ab1-7dfdf77d99c2,start,,,,,,,,
0,15,38007764-1687-47b1-8490-0f3cded9dc95,title,Done,,,,,,,
0,18,8189698a-475c-433b-8fbf-20275b3b2084,playbook,File Enrichment - Generic v2,,,,,,,
0,19,b00cb02f-d44b-4e40-8c27-281d17a94723,playbook,URL Enrichment - Generic v2,,,,,,,
0,22,a0821297-87be-4b3b-86a3-c073e6bbc0bd,playbook,Domain Enrichment - Generic v2,"Enrich domains using one or more integrations.
Domain enrichment includes:
* Threat information",,,,,,
0,23,0ba8dffe-9aac-40a7-8303-ff40de2d91f9,playbook,Email Address Enrichment - Generic v2.1,,,,,,,
0,24,f8fb676b-42d5-4d3a-8513-bfc235733742,playbook,IP Enrichment - External - Generic v2,,,,,,,
0,0,54ef50e9-fe1c-4750-8c0c-0f23d1adcc2f,start,,start,,,,,,
0,1,7039555d-70e8-4c48-8629-9b8377054fe1,regular,Start compliance search,Initiates a compliance search.,,,,,,
0,2,4bca699e-9654-4bd2-8b5f-56d98abb4714,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,5b175cb9-d3f6-4b54-8eac-7f64b17abc6e,regular,Get compliance search,Gets the status and results of a compliance search.,,,,,,
0,4,ba34205c-fc58-4017-8377-cffd6187b25a,condition,Purge compliance search results?,Purge Compliance Search Results?,,,,,,
0,5,b05fb387-956b-4bd3-8250-ece9ec819df4,regular,Purge compliance search results,Purges the results found during the compliance search.,,,,,,
0,6,5558f163-14fa-47e2-824f-a59ee77f6f05,title,Done,Done,,,,,,
0,7,127a2261-119e-43d2-8e3d-14b73f72516c,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,8,d183b55d-38f2-4768-86f5-b4a935db4086,regular,Get compliance search purge status,Checks the status of the purge operation on the compliance search.,,,,,,
0,9,a17e54ba-09c7-4ec7-8350-3d64035b7eea,regular,Remove compliance search,Removes the compliance search from the Exchange Server.,,,,,,
0,0,b2850e0d-eaee-4b1d-8e45-b61bd06f6aa9,start,,,,,,,,
0,2,d693465a-260b-4aac-8a18-4a11c047481e,regular,Collect Hashes from Incident,,,,,,,
0,3,963c3996-3eaf-457c-8c93-abee20d891e2,regular,Collect URLs from Incident,,,,,,,
0,4,4fe3f22e-7bec-4ed5-841c-9cd5808daf42,regular,Collect IPs from Incident,,,,,,,
0,5,a3089d6b-fce1-4d82-84d6-ecaaf3a55d10,title,Done,,,,,,,
0,6,e4a19d6b-98be-49af-8202-fca71cfde7cd,regular,Collect Domains from Incident,,,,,,,
0,7,16f55051-63fa-467b-8533-163b68f310b5,regular,Collect Email Addresses from Incident,,,,,,,
0,0,7c475fe8-ef6f-4203-8649-88c8ee1355a4,start,,,,,,,,
0,1,7d301230-7301-4a9c-879f-2e3b4366a3d7,condition,Is there a file?,"Checks if there is a file in the playbook input.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,2,864c6f5e-7214-4a36-8c37-80f7057bd36e,regular,Set file to local context,Set the input file into local context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,3,cc0c7ac6-f764-47df-8f1e-cfbdcbd25c4e,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,4,a3d79b72-2b6b-498f-887a-d406249d18e8,title,Extract Indicators from file,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,5,5e2997db-65a5-49a7-8f9a-87892701e8fe,condition,Is there a text-based file?,Checks if there is a text-based file in context. Skips MSG and EML files.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'ASCII text'}}, 'ignorecase': True}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'news or mail'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document, No summary info'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'message/rfc822'}}}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,6,e077b5e8-a546-4da5-86ea-fb327ead5a2e,regular,Extract indicators from text-based file,Extracts indicators from text-based files.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'ASCII text'}}, 'ignorecase': True}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'news or mail'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document, No summary info'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'message/rfc822'}}}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,7,542f7e7a-6978-480e-8356-cc7cda51a6d7,condition,Is there a PDF file?,Checks if there is a PDF file in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'pdf'}}, 'ignorecase': True}], [{'operator': 'containsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'pdf'}}}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,8,34c98942-d6e9-4db6-81e9-a04339cdf58c,regular,Extract indicators from PDF file,Extracts indicators from PDF files.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'pdf'}}, 'ignorecase': True}], [{'operator': 'containsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'pdf'}}}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,9,9ba76882-583c-4eb1-8d44-6c28ddd44d13,condition,Is there a Word file?,"Checks if there is a Word file (DOC, DOCX) in context.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document'}}}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Microsoft Word'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}, 'ignorecase': True}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xls'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xlsx'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}}, {'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Excel'}}, 'ignorecase': True}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,10,c552720b-f6fc-49be-8c2a-1beb7178c737,title,No File To Parse,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document'}}}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Microsoft Word'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}, 'ignorecase': True}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xls'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xlsx'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}}, {'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Excel'}}, 'ignorecase': True}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,11,cf8a2830-ba83-43b2-802a-1b4e3281e834,regular,Extract indicators from Word file,"Extracts indicators from word files (DOC, DOCX).",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document'}}}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Microsoft Word'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}, 'ignorecase': True}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xls'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xlsx'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}}, {'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Excel'}}, 'ignorecase': True}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,0,da3a5643-2e84-43b5-8e37-60032a95355b,start,,,,,,,,
0,1,1189dbf0-6420-4533-8c76-e6cb3083e9a7,condition,Is there a file in context?,"Check if there is a file in the playbook input.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,2,49a307bb-ec5a-41bb-8f75-658e444f1f94,regular,Set file to local context,Set the input file into local context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,3,3c91d141-7645-4300-8610-51328a06369a,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,4,190a8c7e-cdaf-4b32-8e28-f93153071b5a,title,Extract Indicators from file,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,5,6dd8fd00-b025-4c12-89d5-b78e3d356be4,condition,Is there a text-based file,Check if there is a text-based file in context Skips .msg and .eml files.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'ASCII text'}}, 'ignorecase': True}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'news or mail'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document, No summary info'}}}]], 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,6,01cd1380-8b6c-4a75-8602-832daeb2bfd5,regular,Extract indicators from text-based file,Extract indicators from text-based files.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'ASCII text'}}, 'ignorecase': True}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'news or mail'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document, No summary info'}}}]], 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,7,07542fb0-0931-468e-89ab-5d6550e1f99a,condition,Is there a PDF file,Check if there is a PDF file in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'application/pdf'}}, 'ignorecase': True}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'application/pdf'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,8,458345d2-ad32-449f-8c3d-0a54c61dc24d,regular,Read PDF file,Extract indicators from PDF files.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'application/pdf'}}, 'ignorecase': True}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'application/pdf'}}, 'ignorecase': True}]], 'accessor': 'EntryID'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,0,7820586b-f2e6-4673-8dd8-08caab0d1173,start,,Start,,,,,,
0,1,7872ce6f-5e06-4c00-846b-6de0d54307b1,condition,Is there a file?,"Checks if there is a file in the playbook input.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,2,e06408f8-c0cb-4516-87c0-014108497f20,regular,Set file to local context,Set the input file into local context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,3,832242ed-942e-4094-8cf4-003921e7ef7a,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,4,ab59c7dd-3e82-4efe-8e36-d3065d88a590,title,Extract Indicators From Files,Extracts indicators from files,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'accessor': 'EntryID'}}, 'iscontext': True}}]]}"
0,5,6bc85e4c-1f70-41b7-8bec-3c6410c9ad53,condition,Is there a text-based file?,Checks if there is a text-based file in context. Skips MSG and EML files.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'ASCII text'}}, 'ignorecase': True}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rich Text Format'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'news or mail'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document, No summary info'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'message/rfc822'}}}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,6,d2c83c31-2092-4c86-81ad-359fcf0ee1e6,regular,Extract indicators from text-based file,Extracts indicators from text-based files.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'ASCII text'}}, 'ignorecase': True}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rich Text Format'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'news or mail'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document, No summary info'}}}], [{'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'message/rfc822'}}}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,7,79feacf1-749d-4213-85ce-9b87809c59cf,condition,Is there a PDF file?,Checks if there is a PDF file in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'pdf'}}, 'ignorecase': True}], [{'operator': 'containsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'pdf'}}}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,8,f954fb51-0ed0-44d2-837a-64f852f3dd9d,regular,Extract indicators from PDF file,Load a PDF file's content and metadata into context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'pdf'}}, 'ignorecase': True}], [{'operator': 'containsString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'pdf'}}}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,9,596a82ed-b1a5-4a82-8eca-c351ae07e8c3,condition,Is there a Word file?,"Checks if there is a Word file (DOC, DOCX) in context.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document'}}}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Microsoft Word'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}, 'ignorecase': True}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xls'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xlsx'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}}, {'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Excel'}}, 'ignorecase': True}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,10,371fb092-fd79-4550-8b2e-d3c945d2cc10,title,No File To Parse,No File To Parse,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document'}}}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Microsoft Word'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}, 'ignorecase': True}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xls'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xlsx'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}}, {'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Excel'}}, 'ignorecase': True}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,11,e08be4df-5efa-4f1a-834d-05a15f8fd63f,regular,Extract indicators from Word file,"Extracts indicators from word files (DOC, DOCX).",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Composite Document File V2 Document'}}}, {'operator': 'containsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Microsoft Word'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'msg'}}, 'ignorecase': True}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'eml'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xls'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}}, {'operator': 'isNotEqualString', 'left': {'value': {'simple': 'File.Extension'}, 'iscontext': True}, 'right': {'value': {'simple': 'xlsx'}}, 'ignorecase': True}], [{'operator': 'isNotExists', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}}, {'operator': 'notContainsString', 'left': {'value': {'simple': 'File.Type'}, 'iscontext': True}, 'right': {'value': {'simple': 'Excel'}}, 'ignorecase': True}]], 'accessor': 'EntryID', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,12,01853d00-5297-4e59-83fa-1aec87f7b3aa,condition,Were images extracted?,Checks whether images were extracted from PDF files.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'image/png'}}, 'ignorecase': True}, {'operator': 'isEqualString', 'left': {'value': {'simple': 'Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'image/jpg'}}, 'ignorecase': True}, {'operator': 'isEqualString', 'left': {'value': {'simple': 'Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'image/jpeg'}}, 'ignorecase': True}, {'operator': 'isEqualString', 'left': {'value': {'simple': 'Info'}, 'iscontext': True}, 'right': {'value': {'simple': 'image/gif'}}, 'ignorecase': True}]], 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,13,60827e91-7450-4f79-8e82-863488b15371,condition,Is Image OCR enabled?,Checks whether there is an active instance of the Image OCR integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Image OCR'}}}]]}}, 'iscontext': True}}]]}"
0,14,19fe4f88-c55b-4f13-814c-1ad0aae31cae,regular,Extract text from images,"Extracts text from PNG, JPEG, and GIF image files, and uses auto-extract to get reputation for indicators.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Image OCR'}}}]]}}, 'iscontext': True}}]]}"
0,0,e0772674-d7ff-43df-8075-a871655a3f9b,start,start_task,,,,,,,
0,2,cdd77c13-ca81-4c68-8679-19d08de8fb71,regular,Confirm failed login with user,Ask user regarding his/her failed login attempts,,,,,,
0,3,58679e35-4e24-4d2a-89ba-22fbd161f308,condition,Was the failed login attempt by the user?,Answer `yes` if failed login attempt made by the user,,,,,,
0,4,ce32bc35-0679-4b9b-842f-e4b0c942a157,regular,Raise Incident Severity to High,,,,,,,
0,5,987f04ae-98f1-4e27-8ef3-1a4f459acaa2,regular,Ask user should we reset her password,,,,,,,
0,6,6b4648d9-512a-417c-86e6-d468d05c5b63,condition,Should we reset the password?,Answer `yes` if password should be reset,,,,,,
0,7,a12faaf4-cbbe-49ce-8539-f4ed61279deb,regular,Expire Password,Expire user password,,,,,,
0,8,0531af1c-0b85-40c8-89c3-e1d22b064ad6,regular,Notify User on Slack,Notify user that his/her password has been reset,,,,,,
0,9,abd944e7-152b-4e45-8e2f-92cd19ea6bb4,regular,Close the incident,,,,,,,
0,0,214ebf34-1312-43ec-873d-41d45094ba22,start,,,,,,,,
0,1,4b42764c-31bd-4097-8721-159b73534347,title,Get file hash reputation,,,,,,,
0,5,61a4a533-980d-4b46-816e-75bbf2550d0a,regular,Get MD5 reputation,Get the MD5 hash reputation from every integration that supports the `!file` command.,,,,,,
0,7,66d74bf4-438c-40a8-840f-58052c181d0f,title,Done,,,,,,,
0,14,63bff973-38e4-490f-830e-b9d68f2791ad,condition,Is there an MD5 hash?,Check if there is an MD5 hash in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.MD5'}}, 'iscontext': True}}]]}"
0,15,8e16c355-ee0c-4b2b-86b1-0d2f5916430f,condition,Is there a SHA-256 hash?,Check if there is a SHA-256 hash in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256'}}, 'iscontext': True}}]]}"
0,16,092a1e7e-b7d8-4d50-8f6e-021c31701974,regular,Get SHA-256 reputation,Get the SHA-256 hash reputation from every integration that supports the `!file` command.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256'}}, 'iscontext': True}}]]}"
0,17,ceddfccc-685c-4392-8955-2c116297ca5f,condition,Is there a SHA-1 hash?,Check if there is a SHA-1 hash in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA1'}}, 'iscontext': True}}]]}"
0,18,9cd10068-c589-4c05-8a22-7ec3528b89de,regular,Get SHA-1 reputation,Get the SHA-1 hash reputation from every integration that supports the `!file` command.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA1'}}, 'iscontext': True}}]]}"
0,0,6fa65b00-15dc-4cab-8b4e-7ab8e2720215,start,,,,,,,,
0,7,d2deb7de-75cc-4f33-8ba3-6f83370096f8,title,Done,,,,,,,
0,24,9b849bc8-3a9b-46c5-802e-2fc25b7b1761,title,Threat information,,,,,,,
0,25,803cab60-a177-4bca-8890-267658a8e037,condition,Is there a SHA-256 hash?,Check if there is a SHA-256 hash in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256'}}, 'iscontext': True}}]]}"
0,26,977beaa5-2d82-4d11-815d-16c6b502b5af,title,Get threat info from Cylance Protect v2,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256'}}, 'iscontext': True}}]]}"
0,27,a385675b-4d5d-40c4-8ea3-f9658e14ef91,condition,Is Cylance Protect v2 enabled?,Checks if there is an active instance of Cylance Protect v2.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,28,5d1b9cb9-80ad-485a-80ba-e52f2bc9d2f0,regular,Get threat information from Cylance Protect v2,Get threat information from the Cylance Protect v2 integration.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,29,0357cc1e-4fed-4d34-8672-c44dde656382,playbook,File Enrichment - Virus Total private API,Get file reputation using one or more integrations,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,30,52857fb4-234a-41b3-863e-acedeb1b02b3,playbook,File Enrichment - File reputation,Get file reputation using one or more integrations,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,31,e14e2725-8611-4089-8947-4db090c13347,title,File reputation,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,214ebf34-1312-43ec-873d-41d45094ba22,start,,,,,,,,
0,1,4f88c305-19b2-4d29-8284-0fe706b0b516,title,Hash reputation,,,,,,,
0,5,6e38288d-5ef5-4291-8b4b-286c7101a2b8,regular,Check MD5s,Checks reputation of MD5,,,,,,
0,7,66d74bf4-438c-40a8-840f-58052c181d0f,title,Done,,,,,,,
0,14,e7b3a313-8f11-45ab-8b4d-2373184ed873,condition,Do we have MD5 hashes?,Checks if there MD5 hashes to check,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.MD5'}}, 'iscontext': True}}]]}"
0,15,201f454e-7e43-4b7a-86c1-cf184c3f4034,condition,Do we have SHA256 hashes?,Checks if there SHA256 hashes to check,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256'}}, 'iscontext': True}}]]}"
0,16,fa195b67-af7f-4d2c-8539-801984ffd27a,regular,Check SHA256s,Checks reputation of SHA256,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256'}}, 'iscontext': True}}]]}"
0,17,3e168b3e-a583-4ebb-8b82-5a0924d6a204,condition,Do we have SHA1 hashes?,Checks if there SHA1 hashes to check,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA1'}}, 'iscontext': True}}]]}"
0,18,689b03e9-186f-4edd-8ae2-859b957487d7,regular,Check SHA1s,Checks reputation of SHA1,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA1'}}, 'iscontext': True}}]]}"
0,0,6fa65b00-15dc-4cab-8b4e-7ab8e2720215,start,,,,,,,,
0,7,d2deb7de-75cc-4f33-8ba3-6f83370096f8,title,Done,,,,,,,
0,25,9ce11d97-a210-4566-8929-a2c7236c34dd,condition,Is there a SHA256 hash?,Check if there is a SHA256 hash in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256'}}, 'iscontext': True}}]]}"
0,27,96571487-7027-42f8-8c89-ca96f16b2a33,condition,Is Cylance Protect v2 enabled?,Checks if there is an active instance of the Cylance Protect v2 integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,28,49c6d1e2-ac63-4783-8733-794570f1bdb5,regular,Get threat information from Cylance Protect v2,Gets threat information from the Cylance Protect v2 integration.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,29,4e009c34-dfb2-4626-8c6e-b8da7850d084,playbook,File Enrichment - Virus Total Private API,Get file information using the Virus Total Private API integration.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Cylance Protect v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,6fa65b00-15dc-4cab-8b4e-7ab8e2720215,start,,,,,,,,
0,1,51eec4c5-cbce-45e7-86ab-ec78d3847158,title,Enrich using Virus Total Private API,,,,,,,
0,7,d2deb7de-75cc-4f33-8ba3-6f83370096f8,title,Done,,,,,,,
0,14,56b4d081-a669-4518-8bcd-cd8350fd69e7,condition,Is there an MD5 hash?,Check if there is an MD5 hash in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.MD5'}}, 'iscontext': True}}]]}"
0,15,041d6eb8-8fab-47a8-8fa4-8b6a6cc8d337,condition,Is there a SHA-256 hash?,Check if there is a SHA-256 hash in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256'}}, 'iscontext': True}}]]}"
0,17,ab7db8fa-4db9-40e4-87f3-ca0d04398e1d,condition,Is there a SHA-1 hash?,Check if there is a SHA-1 hash in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA1'}}, 'iscontext': True}}]]}"
0,19,f8c02720-3892-4efe-8493-3d9e8796fc16,condition,Is Virus Total Private API enabled?,Checks if there is an active instance of the Virus Total Private API enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,20,6c579c5f-03b3-4bab-8aef-3dd75da6cf5a,regular,Query file behavior based on the MD5 hash, VirusTotal runs a distributed setup of Cuckoo sandbox machines that execute the files we receive. This API allows you to retrieve the full JSON report of the file's execution as returned by the Cuckoo JSON report encoder.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,21,3c24cb3f-304a-4240-8ea7-ac55c97ad637,regular,Query file behavior based on the SHA-256 hash, VirusTotal runs a distributed setup of Cuckoo sandbox machines that execute the files we receive. This API allows you to retrieve the full JSON report of the file's execution as returned by the Cuckoo JSON report encoder.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,22,7e7f3d3a-61bf-4911-85f7-822153166249,regular,Query file behavior based on the SHA-1 hash, VirusTotal runs a distributed setup of Cuckoo sandbox machines that execute the files we receive. This API allows you to retrieve the full JSON report of the file's execution as returned by the Cuckoo JSON report encoder.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,23,c88e1f06-64f8-4c6d-8058-8eba32f3c4a6,regular,Query file report based on the MD5 hash,Retrieves a concluded file scan report for a given file.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,24,2386a69d-789a-4b40-814b-97f05751c1fb,regular,Query file report based on the SHA-256 hash,Retrieves a concluded file scan report for a given file.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,25,00d87887-ada6-4397-87eb-f42eebe12912,regular,Query file report based on the SHA-1 hash,Retrieves a concluded file scan report for a given file.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,9f52fb66-6378-4f4a-869f-570560e9450b,start,,,,,,,,
0,1,4d042443-509f-4e97-8504-fd6d52171444,collection,Notify DPO of suspected data breach,,,,,,,
0,2,66ad9306-e86d-467e-83bc-6c745c4d56ef,condition,DPO confirmed a breach happened,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.0'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,6,57e06932-cacb-4749-80d9-033400e4462a,condition,The breach is likely to result in a risk to individuals,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.1'}, 'iscontext': True}, 'right': {'value': {'simple': 'Likely'}}}]]}"
0,9,daca1250-72a6-4885-87f3-a0c6fb6fd066,title,Breach documentation process,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.1'}, 'iscontext': True}, 'right': {'value': {'simple': 'Likely'}}}]]}"
0,10,24f42185-5a48-4578-8536-5273e6a6ea93,title,No breach has occurred,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.1'}, 'iscontext': True}, 'right': {'value': {'simple': 'Likely'}}}]]}"
0,11,f0cfdc41-8bd1-4437-8f5f-b4cf5dfd1768,title,Breach report process,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.1'}, 'iscontext': True}, 'right': {'value': {'simple': 'Likely'}}}]]}"
0,15,b179ce1d-07e6-4381-8799-7ec819c5ed4c,regular,Generate breach report,"A script that automatically generates an investigation summary report. The script can also be used
in a post-processing workflow.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.1'}, 'iscontext': True}, 'right': {'value': {'simple': 'Likely'}}}]]}"
0,16,22545bce-a43f-4f41-8bb8-3b4f4465ee1c,condition,The breach poses a high risk to individuals ,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,19,aa3b5159-9eeb-49b7-88d8-f7fcfc17ae80,regular,Breach is documented in Demisto,Prints text to war room (Markdown supported),,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,20,558e7237-1588-474f-8b4c-214a68bea922,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,24,17a3040a-4af9-43b7-88b0-2c67547deb1d,regular,Update DPO Answers to incident,commands.local.cmd.set.incident,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,25,a3a32547-671f-421f-8c1e-da7f6263daa3,regular,Send information report to local supervisory authorities,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,28,7432dcf3-4ea8-43bd-8a61-bd91bc6a4d8f,regular,Notify Individuals,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,29,dc4bbf9f-9f4c-4221-86aa-7d97f182c65e,title,DPO updates report,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,30,fe520e8a-1a1a-40cb-84d8-271f13093c3c,regular,Get new report from DPO,manual task - ask user to send new report,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,33,703ee51d-4b71-480d-82c4-8eabcde3ee77,title,Contact authorities,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,34,f1ffbfe2-fcd1-45df-818e-c7f206d48a98,regular,Get Authority Contact details,"GDPR Data Protection Supervisory Authority Listing.

""'supervisory authority' means an independent public authority which is established by a Member State pursuant
 to Article 51;

'supervisory authority concerned' means a supervisory authority which is concerned by the processing of
personal data because:
(a) the controller or processor is established on the territory of the Member State of that supervisory authority;
(b) data subjects residing in the Member State of that supervisory authority are substantially affected or likely to be substantially affected by the processing; or
(c) a complaint has been lodged with that supervisory authority;""

GDPR - Art. 4 - https://gdpr-info.eu/art-4-gdpr/",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,35,f84f85f8-98ef-4b5d-89b6-1344e8c1815c,condition,Get admin approval - manual,Get admin's final approval to send the report to the authorities.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,36,1e63f1b1-99cd-45e4-88f8-ab49072c7777,regular,Send report to DPO approval,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,37,1f9453ad-30f6-4478-8ab0-3c7d6fcb3477,condition,Get DPO Approval for the report,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,38,805610b5-b97b-429b-8c6b-4f3dd46546c1,regular,Close Investigation,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'Suspected GDPR data breach.Answers.2'}, 'iscontext': True}, 'right': {'value': {'simple': 'Yes'}}}]]}"
0,0,c644af04-2cd7-4462-83e3-5f55bc12aa73,start,,-,,,,,,
0,1,c202a667-b138-4635-819f-56a7396cc7f8,regular,Schedule Polling Task,Schedule Polling Task,,,,,,
0,2,156abdbe-586e-4241-8ae6-364fe3d9d76a,condition,Waiting for polling to complete (Automated Task),This task will complete automatically when polling is complete.,,polling,,,,
0,3,bc152ecc-4c23-4296-844a-d21b32be0ec3,regular,RunPollingCommand,RunPollingCommand,,polling,,,,
0,5,778e1007-f7ea-4ff6-89c4-cffc067165c4,title,Done,Done,,polling,,,,
0,6,62b13486-ae6a-49c1-8988-16765f35f1cc,regular,Scheduled Task Failed,Scheduled Task Failed,,polling,,,,
0,0,13be4945-ec82-4790-8892-a66b8b74111c,start,,,,,,,,
0,1,795290dd-889b-4ea6-8e83-7b04252bddf2,condition,Is Carbon Black Enterprise Response enabled?,Checks if the Carbon Black Enterprise Response integration is enabled,,,,,,
0,2,d489fccb-fab0-471b-849c-3b64ab63e7ce,condition,Do we have a MD5?,Checks for MD5 in context,,,,,,
0,3,90947de7-db04-49c9-88f3-747e0ad4c026,title,Done,,,,,,,
0,4,4241ccef-7acc-49f9-8976-e97a654bf89d,regular,Get binary from MD5,,,,,,,
0,0,d947a1c1-7312-4f99-8f56-bfcb4b0c3dfe,start,,,,,,,,
0,1,bb196c7a-ff84-44c7-81fd-625038a5bcf4,condition,Is Cylance V2 Protect enabled?,"Checks if the the ""Cylance Protect"" integration is enabled",,,,,,
0,2,af2e86ff-6413-4cd8-8d5f-799edb0770e6,title,Done,,,,,,,
0,3,283e4157-b249-4d36-8a57-c2983a3d61d4,condition,Do we have a SHA256?,Checks for SHA256 in context,,,,,,
0,4,bfa8a0e5-39d1-4cae-82f5-aa6cca072232,regular,Get download link from HASH,Query Cylance Protect for HASH's link,,,,,,
0,5,a2dfc6e8-e78a-4cc0-8de5-be4a8c155931,condition,Did we get a download link?,Checks for a download link in context,,,,,,
0,6,d12daf11-c3b1-4079-8b6d-4bbc6023cc4d,regular,Download File (ZIP format),Send an HTTP request to download the zip file,,,,,,
0,7,917958d1-9c25-4f8d-84f3-5e272848d939,condition,Did we successfully download the ZIP file?,Checks for ZIP file format in context,,,,,,
0,8,5492c4d0-b0c3-4245-8c14-e43fc3ce553f,regular,Unzip File,Unzip a file using fileName or entryID to specify a file. Files unzipped will be pushed to the war room and names will be pushed to the context.,,,,,,
0,9,1a5cf78a-2b23-487e-8520-980ffc50bdf7,condition,Is Cylance V1 Protect enabled?,,,,,,,
0,10,9a83a232-86f0-419b-8c7d-f441b6f6c46e,condition,Do we have a SHA256?,Checks for SHA256 in context,,,,,,
0,11,dea0c877-321d-4efa-8dfe-d2169fa93089,regular,Get download link from HASH,Query Cylance Protect for HASH's link,,,,,,
0,12,a5416443-e7db-45d3-86eb-86810cc208d6,condition,Did we get a download link?,Checks for a download link in context,,,,,,
0,13,98e64df6-7105-455f-8298-9101e96b04a9,regular,Download File (ZIP format),Send an HTTP request to download the zip file,,,,,,
0,14,1f0dd602-7af3-4cf2-8d52-92fe5ab4ead0,condition,Did we successfully download the ZIP file?,Checks for ZIP file format in context,,,,,,
0,15,7e6d9805-2917-46d9-891c-a944aa45b1f8,regular,Unzip File,Unzip a file using fileName or entryID to specify a file. Files unzipped will be pushed to the war room and names will be pushed to the context.,,,,,,
0,0,0131a1f1-22f0-489d-8c41-ec4a0e89369d,start,,,,,,,,
0,2,366fe696-1d20-4473-87b6-d0c2ce334996,playbook,Get File Sample By Hash - Cylance Protect,,,,,,,
0,3,88fbf584-4a72-4097-86e6-3d22957bdd3e,playbook,Get File Sample By Hash - Carbon Black Enterprise Response,,,,,,,
0,4,905fca17-4fc2-4efb-8db3-322ff915dee8,title,Done,,,,,,,
0,0,13be4945-ec82-4790-8892-a66b8b74111c,start,,,,,,,,
0,1,132bed20-21ec-467b-8e47-acbb3883e1df,condition,Is Carbon Black Enterprise Response enabled?,Checks if the Carbon Black Enterprise Response integration is enabled,,,,,,
0,2,b7efedda-4f0f-4997-8db3-de7dc3707896,condition,Do we have a MD5?,Checks for MD5 in context,,,,,,
0,3,90947de7-db04-49c9-88f3-747e0ad4c026,title,Done,,,,,,,
0,4,31f102b5-5108-4f19-865e-cfc50b7793d8,regular,Get binary from MD5,,,,,,,
0,0,d947a1c1-7312-4f99-8f56-bfcb4b0c3dfe,start,,,,,,,,
0,1,089ff858-05b2-4570-81aa-d395dae91017,condition,Is Cylance Protect enabled?,"Checks if the the ""Cylance Protect"" integration is enabled",,,,,,
0,2,af2e86ff-6413-4cd8-8d5f-799edb0770e6,title,Done,,,,,,,
0,3,80b8842e-e1d1-4556-80fd-8e86357eeeac,condition,Do we have a SHA256?,Checks for SHA256 in context,,,,,,
0,4,12699c68-681e-4974-8fde-3175b0fc1269,regular,Get download link from HASH,Query Cylance Protect for HASH's link,,,,,,
0,5,da389084-d70d-4404-88d6-7b68c2052c05,condition,Did we get a download link?,Checks for a download link in context,,,,,,
0,6,f9168f7d-2271-4272-81a6-ee3a7bb7d9a1,regular,Download File (ZIP format),Send an HTTP request to download the zip file,,,,,,
0,7,086b406d-2bb7-4708-86d1-203ea607e2f2,condition,Did we successfully download the ZIP file?,Checks for ZIP file format in context,,,,,,
0,8,ba1c029c-be3c-4c66-863a-65c338b92a35,regular,Unzip File,Unzip a file using fileName or entryID to specify a file. Files unzipped will be pushed to the war room and names will be pushed to the context.,,,,,,
0,0,38a19f0d-fa42-4db5-8bd8-e787836d6a64,start,,,,,,,,
0,1,2b67ca26-e093-4dca-8aed-c0d490b74b91,playbook,,,,,,,,
0,3,a986e95e-6e50-454b-8667-f3995523b3e4,playbook,,,,,,,,
0,0,6b09e12d-a699-4b98-8f93-0ee2fb3904df,start,,,,,,,,
0,1,40ec070b-2ab3-432a-86fa-eb02b381398a,condition,Is Carbon Black Enterprise Response enabled?,Check if  Carbon Black Enterprise Response active in the system.,,,,,,
0,3,347006fd-60f5-4233-8c40-9b941735dd2a,title,Done,,,,,,,
0,4,6361a341-4a5c-4735-8ffe-ce13d9539b91,regular,Get File,Use Carbon black Response Live session to retrieve a file from an endpoint. Endpoint needs to have a CbResponse sensor deployed.,,,,,,
0,5,69aeb053-04ea-4853-872a-adf410c08c5e,condition,Is there a file path and hostname?,Checks if a file path exists in playbook inputs.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Path'}, 'iscontext': True}}], [{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}]]}"
0,0,62c65b41-e6f2-42d5-8abf-a3c971ae42b0,start,,,,,,,,
0,3,a5a0b6b9-bd4d-42e6-8e96-5a5daeb0d5a5,regular,Add the endpoint as a System to this incident,Add the relevant endpoint to the System,,,,,,
0,7,ba4872a3-3460-470f-81cd-14afaacd29d8,condition,Does Hostname and filepath exists?,Check if there is hostname and file path to get.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}], [{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Path'}, 'iscontext': True}}]]}"
0,11,9f3aab69-b584-4929-815c-0579eb307807,regular,d2 agent - Collect file from endpoint,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}], [{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Path'}, 'iscontext': True}}]]}"
0,12,642cf7ac-e922-4379-8656-55c1eb4de929,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Hostname'}, 'iscontext': True}}], [{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.Path'}, 'iscontext': True}}]]}"
0,0,5d887731-fb71-4226-872c-a9e8dbddac42,start,,,,,,,,
0,1,8adb1ff3-5400-4f88-8a2b-4511ae8303f5,condition,Use D2 agent?,Yes if we want to use D2 agent to get the file,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'inputs.UseD2'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}}]]}"
0,8,f81d6908-8ce9-452b-8dde-689f44256933,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'inputs.UseD2'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}}]]}"
0,10,487eeea9-469f-4725-8695-e25a6ce9c0fc,playbook,Get File Sample From Path - D2,"Returns a file sample to the war-room from a path on an endpoint using Demisto Dissolvable Agent (D2)

Input:
* Credentials - credentials to use when trying to deploy Demisto Dissolvable Agent (D2)  (default: Admin)
* ${Endpoint.Hostname} - deploy agent on target endpoint
* ${File.Path} - file's path to collect",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'inputs.UseD2'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}}]]}"
0,11,33162da0-6e16-4324-8e6e-bcbd0e74f463,title,Use 3rd party products,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'inputs.UseD2'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}}]]}"
0,12,6689a943-ee94-437a-868b-0c6971de86f4,playbook,Get File Sample From Path - Carbon Black Enterprise Response,Returns a file sample to the war-room from a path on an endpoint using Carbon Black Enterprise Response,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'inputs.UseD2'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}}]]}"
0,0,5607d1c6-85b0-4181-8b10-bb3a5b113c6f,start,,,,,,,,
0,1,03f2c080-1995-42fc-82ce-16d474fb5438,condition,Is EWS v2 enabled?,"Verifies that there is an active instance of the EWS v2 integration enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'EWS v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,2,d2eca123-db35-4b27-88d8-a8b77ffd6784,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'EWS v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,3,b2617aaf-5e54-43f5-89fe-82fc78cd099b,condition,Verify required inputs,Verify that the required input values for retrieving the original email exists.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.InReplyTo'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.ThreadTopic'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.Mailbox'}}, 'iscontext': True}}]]}"
0,4,f3c1bfda-b3c0-4c7c-8fce-fb180ff6fd07,regular,Search for messages by Thread-Topic,Retrieve all messages found in the thread of the forwarded email.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.InReplyTo'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.ThreadTopic'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.Mailbox'}}, 'iscontext': True}}]]}"
0,5,25f6439f-778f-45a5-841a-53efe77d590c,condition,Was a matching email found?,Verify that an email object with a Message-Id that matches the InReplayTo ID of the forwarded email was found.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'EWSItem', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'EWSItem.messageId'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.InReplyTo'}, 'iscontext': True}}]], 'accessor': 'messageId'}}, 'iscontext': True}}]]}"
0,6,c729f95f-bc75-477e-8000-14c99346873d,regular,Set context,Set email object to context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'EWSItem', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'EWSItem.messageId'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.InReplyTo'}, 'iscontext': True}}]], 'accessor': 'messageId'}}, 'iscontext': True}}]]}"
0,7,6f28ff90-80ff-414e-819b-310a51183da4,regular,Get original email,Get the original email from the EWS server.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'EWSItem', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'EWSItem.messageId'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.InReplyTo'}, 'iscontext': True}}]], 'accessor': 'messageId'}}, 'iscontext': True}}]]}"
0,8,8764cbb0-dd56-4095-8df2-e77035713e2e,regular,Delete old context,Delete the email objects from context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'EWSItem', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'EWSItem.messageId'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.InReplyTo'}, 'iscontext': True}}]], 'accessor': 'messageId'}}, 'iscontext': True}}]]}"
0,9,fab3c34b-010a-4203-830a-7dbf0dde26e5,regular,Set output,Set the playbook outputs to context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'EWSItem', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'EWSItem.messageId'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.InReplyTo'}, 'iscontext': True}}]], 'accessor': 'messageId'}}, 'iscontext': True}}]]}"
0,10,75ab61a9-a6cf-4d74-842f-67436507b8f4,condition,Was the original email found?,Verifies that the original email is in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'EWS', 'accessor': 'Items.itemId'}}, 'iscontext': True}}]]}"
0,11,427d5e37-2e56-4522-8e69-caabe8fd70d9,regular,Get attachments of the original email,"Retrieve the attachments of the original email from EWS, including file attachments and item attachments (other email, calendar item, etc.).",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'EWS', 'accessor': 'Items.itemId'}}, 'iscontext': True}}]]}"
0,0,d7920fee-8ada-4d48-8197-2e08d19a54dc,start,,,,,,,,
0,3,b52aade3-aa90-4343-8417-d4aa26803d62,title,Done,,,,,,,
0,6,eaebbf2e-aa04-4581-8157-2f55adc08880,playbook,Get Original Message - Gmail,,,,,,,
0,7,96353c64-dc04-4475-89a8-f0f90922090f,playbook,Get Original Email - EWS,"Use this playbook to retrieve the original email in the thread, including headers and attahcments, when the reporting user forwarded the original email not as an attachment.

You must have the necessary permissions in the EWS integration to execute global search: eDiscovery",,,,,,
0,0,d8403573-b211-4d44-885c-a365045c61a2,start,,,,,,,,
0,2,81842102-b7a7-4202-8319-54c4b8660756,condition,Is Gmail enabled?,"Verifies that there is an active instance of the Gmail integration enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Gmail'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,3,185c00fb-4375-4607-8b99-7538c88315bc,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Gmail'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,cc460fc4-1d86-464c-8853-e996eed85049,regular,Retrieve the forwarded email from Gmail,Get the data and metadata of the forwarded email from the Gmail service.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Gmail'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,5,18de5315-16b2-4d5c-8a81-2c50623ea89d,condition,Was the original email retrieved?,Verify that there is a Gmail email object in the context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Gmail', 'accessor': 'ID'}}, 'iscontext': True}}]]}"
0,6,c09ebecb-9dc8-4e00-8fe4-0dbf0cd27d32,condition,Was the forwarded email data retrieved?,Verify that the InReplyTo and Subject fields are in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'GmailSubject'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'simple': 'InReplyTo'}, 'iscontext': True}}]]}"
0,7,ea86d0cc-f9dc-4496-812c-bd3f5c52d08c,regular,Set context,Set the InReplyTo field to context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'GmailSubject'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'simple': 'InReplyTo'}, 'iscontext': True}}]]}"
0,8,13ee64a0-66aa-4265-8995-62cf1f44982c,regular,Search for original email,Search Gmail for the original email.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'GmailSubject'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'simple': 'InReplyTo'}, 'iscontext': True}}]]}"
0,9,4bf99d41-0f5c-4f08-8c98-785cb0e5503d,regular,Set context,Set the Subject field to context stripped of all prefixes.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'GmailSubject'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'simple': 'InReplyTo'}, 'iscontext': True}}]]}"
0,10,4dbd3cc6-ae7c-4de5-89d2-b3e1b47acec5,regular,Delete old context,Delete the forwarded Gmail email object from context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'GmailSubject'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'simple': 'InReplyTo'}, 'iscontext': True}}]]}"
0,12,7e75aef4-9998-407c-8ace-b342f3ef812f,regular,Set context,Set the original email to context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'GmailSubject'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'simple': 'InReplyTo'}, 'iscontext': True}}]]}"
0,13,29868c31-fc31-4b25-8523-5a9c937af420,regular,Get attachments of the original email,Retrieve the attachments of the original email from Gmail.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'GmailSubject'}}, 'iscontext': True}}], [{'operator': 'isExists', 'left': {'value': {'simple': 'InReplyTo'}, 'iscontext': True}}]]}"
0,14,0ce28338-abb6-4b8d-8155-3444a9df6ca9,condition,Was the original email retrieved?,Verify that the original email is in context (matched by the InReplyTo ID).,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': '${.=val.Gmail.filter(g => g.Headers.filter(h => h.Name === ""Message-ID"" && h.Value == val.InReplyTo).length > 0)}'}, 'iscontext': False}}]]}"
0,15,7c1f40cb-1a0e-44dd-8d87-ff2fd67e572c,regular,Set output,Set the playbook outputs to context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': '${.=val.Gmail.filter(g => g.Headers.filter(h => h.Name === ""Message-ID"" && h.Value == val.InReplyTo).length > 0)}'}, 'iscontext': False}}]]}"
0,0,14cac14a-3745-46d2-8ef6-da411a06da52,start,,,,,,,,
0,1,4535653a-d322-4c51-8857-a50edf322136,regular,Create Drive Export,Creates a Google Vault export in order to perform search actions on emails.,,,,,,
0,2,79dff934-921d-4168-8b52-ccc0fbed0fab,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,3e6b8705-bc47-4c32-8ccd-99944b60e1d8,regular,Get Drive results,Get the results of a given mail export,,,,,,
0,5,9ed8fed0-adb4-4d5a-8de3-4390979be049,title,Done,,,,,,,
0,15,aa748877-64f6-403b-8a28-5a48d7470abf,condition,Check downloadFile,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,16,97311171-052d-4110-8cac-66da6235bd3b,regular,Get Export status to context,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,17,afc45103-f1da-466f-8950-4b4a4227378e,regular,Download Export file,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,18,0273f108-4e62-44b6-82aa-bb543619668d,condition,Check if status COMPLETED,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'GoogleVault', 'accessor': 'Matter.Export.Status'}}, 'iscontext': True}, 'right': {'value': {'simple': 'COMPLETED'}}}]]}"
0,19,75b444cb-48e7-4472-882a-ae287fd96386,regular,Polling Timeout,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'GoogleVault', 'accessor': 'Matter.Export.Status'}}, 'iscontext': True}, 'right': {'value': {'simple': 'COMPLETED'}}}]]}"
0,0,14cac14a-3745-46d2-8ef6-da411a06da52,start,,,,,,,,
0,1,40d47276-5b8c-4a16-8bfc-986b89a39382,regular,Create Group Export,Creates a Google Vault export in order to perform search actions on emails.,,,,,,
0,2,2499c394-d9b8-4fc2-8e39-006e6ed21018,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,31d85c78-3d02-4ef9-8734-3d41200a8857,regular,Get Groups results,Get the results of a given mail export,,,,,,
0,5,9ed8fed0-adb4-4d5a-8de3-4390979be049,title,Done,,,,,,,
0,15,aa748877-64f6-403b-8a28-5a48d7470abf,condition,Check downloadFile,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,16,97311171-052d-4110-8cac-66da6235bd3b,regular,Get Export status to context,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,17,afc45103-f1da-466f-8950-4b4a4227378e,regular,Download Export file,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,18,0273f108-4e62-44b6-82aa-bb543619668d,condition,Check if status COMPLETED,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'GoogleVault', 'accessor': 'Matter.Export.Status'}}, 'iscontext': True}, 'right': {'value': {'simple': 'COMPLETED'}}}]]}"
0,19,1fb0571b-bd21-423c-85ae-0f9ca53649f2,regular,Polling Timeout,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'GoogleVault', 'accessor': 'Matter.Export.Status'}}, 'iscontext': True}, 'right': {'value': {'simple': 'COMPLETED'}}}]]}"
0,0,14cac14a-3745-46d2-8ef6-da411a06da52,start,,,,,,,,
0,1,e3690834-b9f7-4574-8106-e70ec6cec8c6,regular,Create Mail Export ,Creates a Google Vault export in order to perform search actions on emails.,,,,,,
0,2,db065150-defd-4197-85cd-001dcbcd8d5f,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,84cab8e3-4c98-4931-83fa-5c13d0c55e05,regular,Get Mail results,Get the results of a given mail export,,,,,,
0,5,9ed8fed0-adb4-4d5a-8de3-4390979be049,title,Done,,,,,,,
0,15,3f8f4650-cc6f-4dde-85cf-52875002b5a1,condition,Check downloadFile,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,16,9b8234da-1a70-499b-86c8-6de0665449f9,regular,Get Export status to context,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,17,52069817-50f6-4267-80f4-7e4c94431f52,regular,Download Export file,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.downloadFile'}, 'iscontext': True}, 'right': {'value': {'simple': 'true'}}}]]}"
0,18,f04a7a20-83ae-4198-86e0-22c079cef34b,condition,Check if status COMPLETED,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'GoogleVault', 'accessor': 'Matter.Export.Status'}}, 'iscontext': True}, 'right': {'value': {'simple': 'COMPLETED'}}}]]}"
0,19,de226b27-9336-4659-823e-079c17b7873b,regular,Polling Timeout,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'GoogleVault', 'accessor': 'Matter.Export.Status'}}, 'iscontext': True}, 'right': {'value': {'simple': 'COMPLETED'}}}]]}"
0,0,9d563269-d6b7-4d77-83c8-8916860ed44b,start,,,,,,,,
0,1,4575847d-6979-4a86-8f77-ad7afcda5b01,playbook,,,,,,,,
0,2,ea507294-262f-4b30-879a-7a0d33944a0f,playbook,,,,,,,,
0,3,69cac33b-55de-4223-84f4-dea5ccca44e9,playbook,,,,,,,,
0,4,e977184e-8358-4c0e-88f5-9a0bb3b41bb6,playbook,,,,,,,,
0,0,37175990-2deb-4a44-8cdf-468f12cc97e3,start,,,,,,,,
0,1,285982a4-a0f0-44b9-8730-79b07de3cb70,regular,Collect hashes from the incident,,,,,,,
0,2,de780391-3d5e-452d-8da0-53075cc3770d,regular,Collect IPs from the incident,,,,,,,
0,3,cccb4d19-7cc7-46ee-85bd-4283b03ba932,regular,Collect URLs from the incident,,,,,,,
0,4,cb6e468c-f551-41d4-82c5-25891ed171d7,playbook,,,,,,,,
0,0,3eeea5b3-f473-4f6f-87ec-f577f4be5c94,start,,start,,,,,,
0,5,79296d69-cc45-44dd-89df-b937e2f7b8d7,condition,Is Intezer enabled,Checks if there is an instance of the Intezer integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Intezer v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,36c0f591-4ad7-4a3d-8bc3-ec036e4f76cd,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Intezer v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,13,be51ba42-9f41-4998-8033-81757c16970d,regular,Intezer - Analyze File by hash,Checks the file reputation of the uploaded file. Max file size is 20 MB.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Intezer v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,14,3480c94c-359c-4885-879f-cadcb54c02cc,condition,Is there a hash to analyze?,Checks if there is a file hash to analyze.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.hash'}}, 'iscontext': True}}]]}"
0,16,65112085-068e-4775-8a76-3618d54190f3,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.hash'}}, 'iscontext': True}}]]}"
0,17,096e3c80-e044-4349-82be-937b9f9b7388,regular,Intezer - get analysis result,Wait and get analysis results. Supports file analysis and endpoint analysis.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.hash'}}, 'iscontext': True}}]]}"
0,18,e2064e11-e8c7-4881-8328-e95a83a81a1b,condition,Was result returned?,Checks was result returned,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'DBotScore.Indicator'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.hash'}, 'iscontext': True}}, {'operator': 'isEqualString', 'left': {'value': {'simple': 'DBotScore.Vendor'}, 'iscontext': True}, 'right': {'value': {'simple': 'Intezer'}}}]]}"
0,0,7d1e59fe-b551-41d6-8337-9d0f413c1d9b,start,,start,,,,,,
0,5,f9a353d1-22d1-4c1b-81eb-a78a88c3dde1,condition,Is Intezer enabled,Checks if there is an instance of the Intezer v2 integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Intezer v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,e3072dee-dd42-416e-804e-d15c5e66ac48,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Intezer v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,13,44c99bce-45d2-4786-8fee-87fe1be01165,regular,Intezer - Analyze uploaded file,Checks the file reputation for the uploaded file. Max file size is 32 MB.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Intezer v2'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,14,bc19a3b7-7876-4f90-8ce2-cf6e1da5016d,condition,Is there a file to analyze?,Checks if there is a file to analyze.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,16,be960d68-1a06-455f-8676-5d1b04402dc5,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step \#2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,17,139f25d7-9d3b-4bf9-8e3b-10eaf6325eef,regular,Intezer - get analysis result,Wait and get analysis results. Supports file analysis and endpoint analysis.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,0,209ca9d9-6cd1-43d6-8917-34828b27d69a,start,,start,,,,,,
0,3,85dde700-9f3a-41c8-8e00-028cf4b91808,regular,Add the endpoint as a System to this incident,Adds the relevant endpoint to the System.,,,,,,
0,6,24cabd05-fad2-4940-8241-3ee3763d4f8d,regular,d2 agent - Scan host by Intezer,Runs IntezerScanHost script,,,,,,
0,7,33071f86-45fc-4c71-8fa3-ad933acbe3a8,condition,Does 'Host' input exist?,Checks if a given value exists in the context. Will return 'no' for empty empty arrays. To be used mostly with DQ and selectors.,,,,,,
0,12,3a2e28f7-a697-4281-8285-cd2dad5e7a63,title,Done,Done,,,,,,
0,15,2e1213d1-3ff8-41c7-8ec9-d1c50ced85e8,condition,Is the OS type Windows?,Checks if OS type is windows,,,,,,
0,16,98eeed9c-3ef1-4a28-8347-537ae2c48945,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,17,d9b795b6-6dfe-4dca-80d4-2b988df75f76,regular,get-analysis-result,Runs intezer-get-analysis-result command,,,,,,
0,18,60302e3d-4e42-4237-8050-eb4ae370d90e,regular,D2-remove,Runs D2Remove script,,,,,,
0,0,6635b28b-bdf1-42cf-88bc-14ad75e9ebe0,start,,,,,,,,
0,15,c8d8906f-cbf4-4ddd-84e6-1e55570d00a0,condition,Is there an external IP address?,"Checks whether the ""InRange"" attribute is set to ""no"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'no'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,24,8149db7c-af8d-41e2-85ee-c9fe2efd5040,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'no'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,27,1734f24b-0b27-431e-81b6-89997f08894c,title,Enrich external IP addresses,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'no'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,28,6b8d857a-6012-41ac-8133-999741963259,condition,Are there any IP addresses?,Determine whether the playbook's input contains at least one IP address.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,29,583bdb15-2ba1-4818-8040-960105e9c247,regular,Determine whether the IP address is internal or external,"Checks if the IP address is in the internal IP address ranges.
If internal, sets the ""InRange"" attribute to ""yes"".
If external, sets the ""InRange"" attribute to ""no"". ",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,34,607dafbe-8ee1-47ad-810a-dacf03842673,condition,Resolve the IP address?,"Checks whether the ""ResolveIP"" parameter is set to ""True"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.ResolveIP'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,35,9a9092a5-a173-4c8d-8a0c-f63960c42451,regular,IP to Hostname (DNS),Convert the IP address to a hostname using DNS query.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.ResolveIP'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,36,22f7b81d-ea1a-44b3-8b73-c628afaf5cfc,title,Enrich Using VirusTotal Private API,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.ResolveIP'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,37,0df4420b-8119-4731-8cb3-4745fd044913,condition,Is VirusTotal Private API enabled?,Checks if there is an active instance of the VirusTotal Private API integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,38,700d9287-b7b0-440b-84a0-43eb625d45eb,regular,Get IP report from VirusTotal Private API,"Retrieves a report for a given IP address.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,39,67d938bf-2bd3-4dfd-885f-8dd190cd0b93,title,No External IP Address,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,41,8828c9f9-9144-42ab-8c98-7479e8f19a04,title,Enrich Using Threat Crowd,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,42,bfd335eb-f565-4abd-87d2-6299336bc89b,condition,Is ThreatCrowd enabled?,Checks if there is an active instance of the ThreatCrowd integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Crowd'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,43,bfa43e99-360c-4f84-8e09-77a8b7ca5b52,regular,Get IP report from ThreatCrowd,"Retrieves a report for a given IP address.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Threat Crowd'}}, 'ignorecase': True}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,0,6635b28b-bdf1-42cf-88bc-14ad75e9ebe0,start,,,,,,,,
0,15,7cc4eee4-d804-45aa-8c51-06e9e5a53a64,condition,Is there an external IP address?,"Checks whether the ""InRange"" attribute is set to ""no"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'no'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,19,74889e4f-d5ea-46d2-8cfb-aac15c10a52f,regular,Check IP reputation,Get the IP reputation from every integration that supports the `!ip` command.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'no'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,24,8149db7c-af8d-41e2-85ee-c9fe2efd5040,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'no'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,26,a22c2045-33e0-4ad3-8627-15886227f805,title,Enrich internal IP addresses,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'no'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,27,1734f24b-0b27-431e-81b6-89997f08894c,title,Enrich external IP addresses,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'no'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,28,3030b8e0-e076-4309-81df-e32298eb49a6,condition,Do we have IP Addresses?,Determine whether the playbook's input contains an IP address.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,29,dfe5b434-e54a-4290-841e-073030e2af53,regular,Determine whether the IP address is internal or external,"Checks if the IP address is in the internal IP address ranges.
Adds  ""yes"" to the ""InRange"" attribute of the IP address  if it is internal. 
Adds ""no""  to the ""InRange"" attribute of the IP address  if it is external. 
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,31,e39bd0d9-0f03-4dda-8ccd-2e31340c8daa,playbook,Endpoint Enrichment - Generic,Enrich an Endpoint Hostname using one or more integrations,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,32,a3fc98dc-45c4-4885-8ba1-15249424617f,condition,Is there an internal IP address?,"Checks whether the ""InRange"" attribute is set to ""yes"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}}]]}"
0,33,2ba6b138-2faa-4c41-8b83-8bc40445e02d,title,Enrich IP address,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}, 'ignorecase': True}]], 'accessor': 'Address'}}, 'iscontext': True}}]]}"
0,34,3f405f27-26b8-4331-814b-6a5242030dca,condition,Resolve the IP address?,"Checks whether the ResolveIP parameter is set to ""True"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'inputs.ResolveIP'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,35,4199432a-7b90-4880-8381-61a1f89a5073,regular,IP to Hostname (DNS),Convert the IP address to a hostname using DNS query.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'inputs.ResolveIP'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,36,97b967b9-1fc6-425f-8204-c363fb8e974c,title,Enrich with Virus Total Private API,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'inputs.ResolveIP'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,37,2d6d9c62-3d21-423f-80f7-51f57ff3c881,condition,Is Virus Total Private API enabled?,Checks if there is an active instance of the Virus Total Private API enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,38,fce8e0ad-c5f8-47f0-8668-c9bb83c25c4e,regular,Get IP report form Virus Total Private API,"Retrieves a report for a given IP.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,6635b28b-bdf1-42cf-88bc-14ad75e9ebe0,start,,,,,,,,
0,15,ce49aa58-e77d-4c81-8546-ebf2c679562f,condition,Do we have External IP Addresses?,Checks if given IPs are not in the internal ranges using the output from the internal ranges check.,,,,,,
0,19,98bb2a4c-a10e-4451-8a9d-e1e2b682eb74,regular,Check IP reputation,Invoke IP related engines to get their DBot Score.,,,,,,
0,24,8149db7c-af8d-41e2-85ee-c9fe2efd5040,title,Done,,,,,,,
0,26,3ec45acd-e3a8-4f70-8ae0-47d32bd25c9a,title,Check internal IP addresses,,,,,,,
0,27,c57e91b0-706a-40a2-8a30-e2fb9cfabba6,title,Check external IP addresses,,,,,,,
0,28,769422b8-e388-4be4-8bd9-911fb17421f4,condition,Do we have IP Addresses?,Determine whether the playbook's input contains IP addresses.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,29,d3975b15-7b3e-44a0-8efd-9117fd6e395e,regular,Check if IPs are in internal ranges,"Returns yes if ip is in one of the ranges provided, returns no otherwise.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,0,6635b28b-bdf1-42cf-88bc-14ad75e9ebe0,start,,,,,,,,
0,24,8149db7c-af8d-41e2-85ee-c9fe2efd5040,title,Done,,,,,,,
0,25,777ec369-d05d-4f8f-8c43-8068566e3ed0,playbook,IP Enrichment - External - Generic v2,"Enrich IP using one or more integrations.

IP enrichment includes:
* Resolve IP to Hostname (DNS)
* Threat information
* Separate internal and external addresses
* IP reputation
* For internal addresses, get host information",,,,,,
0,26,6d0d48a2-7a07-400b-8f98-9c832a56ff8f,playbook,IP Enrichment - Internal - Generic v2,"Enrich IP using one or more integrations.

IP enrichment includes:
* Resolve IP to Hostname (DNS)
* Threat information
* Separate internal and external addresses
* IP reputation
* For internal addresses, get host information",,,,,,
0,0,6635b28b-bdf1-42cf-88bc-14ad75e9ebe0,start,,,,,,,,
0,24,8149db7c-af8d-41e2-85ee-c9fe2efd5040,title,Done,,,,,,,
0,26,a22c2045-33e0-4ad3-8627-15886227f805,title,Enrich internal IP addresses,,,,,,,
0,28,f52523d0-362f-4f1e-8c16-443889e17ff1,condition,Are there IP addresses?,Checks whether the playbook's input contains at least one IP address.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.IP'}, 'iscontext': True}}]]}"
0,34,22936bea-a0fc-4095-8fb7-9d74fa41159e,condition,Resolve the IP address?,"Checks whether the ResolveIP parameter is set to ""True"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.ResolveIP'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,35,edbdb306-f624-4395-84b2-7fba28c31161,regular,IP to Hostname (DNS),Convert the IP address to a hostname using DNS query.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.ResolveIP'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,39,cbcd10d8-201a-414d-8356-6006c81ed53c,condition,Is there an internal IP address?,"Checks whether the ""InRange"" attribute is set to ""yes"".",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}, 'ignorecase': True}]], 'accessor': 'Address', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,40,38e2fd1f-3863-4034-80af-14cb06cbcf25,regular,Determine whether the IP address is internal or external,"Checks if the IP address is in the internal IP address ranges.
If internal, sets the ""InRange"" attribute to ""yes"".
If external, sets the ""InRange"" attribute to ""no"". 
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}, 'ignorecase': True}]], 'accessor': 'Address', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,41,3dbd6139-a053-466c-8abf-86544d804022,title,No Internal IP Address,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}, 'ignorecase': True}]], 'accessor': 'Address', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,42,d3091e4c-f852-496d-81b1-54b37f0ae47d,playbook,Endpoint Enrichment - Generic v2,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'IP', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'IP.InRange'}, 'iscontext': True}, 'right': {'value': {'simple': 'yes'}}, 'ignorecase': True}]], 'accessor': 'Address', 'transformers': [{'operator': 'uniq'}]}}, 'iscontext': True}}]]}"
0,0,3ffe3385-a733-407d-88b8-4bc323efde75,start,start_task,,,,,,,
0,1,850c4685-415d-4625-82b4-5a71add73ddf,title,Triage,,,,,,,
0,2,1dd39fd1-72fd-4e8c-8a40-92297b9d499a,regular,Notify and involve appropriate personnel,"Depending on regulatory, compliance and legal requirements or company procedure, you may need to involve the legal department, PR department, upper management, the employee's immediate supervisor and/or other personnel.",,,,,,
0,3,d58b1e4d-b2a0-4122-8aa0-63f4adc10edc,condition,Was the incident reported by a person?,,,,,,,
0,4,a58e43b1-82d0-4ba9-8f6d-2757d4075efa,regular,Display full details for the alert,,,,,,,
0,5,f2963d5a-6d0b-4f96-8686-67c82746114d,condition,Was this person the owner of the device?,,,,,,,
0,6,69387c21-89a3-4909-8ea9-ce0c8055398d,regular,Interview reporter of the incident and document their full account,,,,,,,
0,7,e0e04bad-e371-4be7-8056-974a97634a17,regular,Retrieve equipment information for the device from ERP software,,,,,,,
0,8,2b1a676a-d81d-40fd-8a66-c2617d9b3e01,regular,Retrieve device profile from IT asset management software,,,,,,,
0,9,85c2c84c-5a80-47e8-8875-a8f5b6ea230a,regular,Retrieve employee information of the device's owner from HR software,,,,,,,
0,10,b7c1f351-0611-4f74-8106-a3ba3d8400cb,regular,Interview owner of device and document full account of the incident,"How, where and when was the device lost?
When is the last time they are certain that it was in their possession?
Do they know if it was stolen deliberately?
If so, do they know anything at all about the perpetrator?
To their knowledge, was the security of the device fully enforced at the time? Do they admit to modifying the security configuration in any way for their convenience? (Removing the screen lock, shutting down anti-malware solutions, etc.)",,,,,,
0,11,6191b9a6-ed52-461d-8d38-f6305b90d848,regular,Report theft of device to authorities (including serial numbers),,,,,,,
0,12,6ffc4cdf-0ae8-446a-8fef-f35f15ef9b2d,regular,Assess severity by reviewing device details and contents of latest backup,"What was the purpose of device?
How sensitive is the data stored on it?
What is the extent of access to corporate resources available to the device?
How well protected was the device? (Screen lock, encryption, etc.)
Did the device include any unique business data that is not backed up? How much and how important is this data?",,,,,,
0,13,6adc9ae9-f940-44e2-82e5-062b6e4aadad,title,Respond,,,,,,,
0,14,03764251-cb89-401e-871b-79e3bca916b6,condition,Does the device support remote lockdown?,,,,,,,
0,15,7cdd5619-bb34-4795-8b5b-d893f62890d9,regular,Activate remote lockdown on the device,,,,,,,
0,16,6bfd15de-613e-490b-8e91-ad67c3d6855f,condition,Is the device a mobile phone?,,,,,,,
0,17,6cfb8ea1-d144-449c-854e-3c8cbc9138d5,regular,Contact the mobile server provider to report the device as stolen,,,,,,,
0,18,4ee12420-0fe7-4c31-80e2-4232c1d1a0b2,regular,Request that the mobile service provider lock the SIM card,,,,,,,
0,19,140bf051-e77a-455a-8716-ca6714b812e0,regular,Remove the phone number from any 2-factor authentication profiles,,,,,,,
0,20,55eacd25-b076-4e40-8c4e-0640f94d1219,regular,Cancel any credit cards stored on the device,,,,,,,
0,21,a8bd072b-c2fb-4d04-83be-1be8a5827868,regular,Change password to any financial or bank account stored on the device,,,,,,,
0,22,1a83ba02-3043-423b-8f6e-b91e3ed5de09,regular,Disable compromised AD user account(s),"Block access to the compromised user account in AD pending investigation and cleanup, after which the account will be reinstated by an Active Directory administrator with the required permissions.",,,,,,
0,23,5d152b2c-067d-47ec-829b-fa56b8960307,regular,Revoke VPN credentials,,,,,,,
0,24,222681ac-e463-4e2c-8f9f-213531fc8bb5,regular,Revoke DLP keys/credentials so documents on the device cannot be decrypted,,,,,,,
0,25,343dc3dd-5001-49de-8034-abf4a9e4c849,regular,Change account passwords for any cloud-based solutions used by the organization,"Some accounts do not reside on systems managed by employees but the Incident Response staff must be able to revoke, lock or rotate credentials to cloud accounts containing organizational information assets.",,,,,,
0,26,8b83a98e-4916-4a76-80e5-8736a5a207ba,regular,Instruct owner to change passwords for any personal accounts,"Personal email, social media, LinkedIn profile - these are in the control of the employee and they must be involved in order to change passwords. IT/Security staff can help to expedite.

This is not only for the benefit of the employee - there is a real danger to the organization: access to these accounts could allow the thief to convincingly impersonate the owner of the device in order to engage in Social Engineering against our other employees and further attack the organization.",,,,,,
0,27,bd9b46ea-07eb-46ee-8308-46888a11640b,regular,"Lock / Rotate any other compromised accounts, keys and credentials","If the machine contained any authentication keys, accounts to internal company resources and information systems, these should be locked and revoked, and reinstated later with new passwords.",,,,,,
0,28,2964e242-127e-4c35-8b4c-87210110e1d4,condition,Was the device managed by an MDM solution?,,,,,,,
0,29,11b2fd90-a311-43cc-884b-61b813f42871,regular,Mark the device as stolen in MDM,,,,,,,
0,30,9fdc659a-7a71-497b-86b5-9df7d296e64f,condition,Did the device have tracking software installed?,,,,,,,
0,31,d9a9e283-da65-4c51-8b71-8d4ae30a5cde,regular,Remotely activate tracking software on the device,,,,,,,
0,32,f926807b-f376-4b87-8719-d07f790e6b94,regular,Periodically check if tracking software became active and sent results,"If the thief wiped the device or kept it isolated and unable to communicate, the tracking software may not be able to report.",,,,,,
0,33,353aafad-f461-4556-8bb3-047b8bd4d0f3,condition,Does the device support remote wiping?,,,,,,,
0,34,41d383ca-bb97-4a56-8431-913c7a84571a,condition,Did the device contain any unique critical business data?,Check with owner and backup records if there is any indication that the device contained crucial data and no copies of that data can be recovered from other company servers or backups.,,,,,,
0,35,d10fca7f-ae27-4826-8695-5fdc4057b3d1,regular,Remotely wipe the device,,,,,,,
0,36,40aae724-fa93-4bc4-8aa8-2bd9b6c0f5c7,condition,Was the device encrypted and turned off at the time of theft?,,,,,,,
0,37,186926f8-d32d-4eb2-8c5b-fe51e56c13e6,regular,Remotely wipe the device,If the device was unencrypted the risk of confidential data leaking is too great and we should wipe immediately.,,,,,,
0,38,b17974fa-4c9c-44ab-8fe2-2a61b89fcc31,regular,Escalate the decision to management,The decision needs to be made whether the data on the device is important enough to defer wiping in the off chance that we can retrieve the device.,,,,,,
0,39,6a1e822a-db19-4ce6-8a91-920d3ba295c3,condition,Did management decide to wipe the device?,,,,,,,
0,40,17ae1afa-f97e-4346-87c8-32b92e5186a3,regular,Document the decision including written authorization to not wipe,,,,,,,
0,41,cd7480e8-b360-4bf4-8330-2e4b8764b214,regular,Remotely wipe the device,,,,,,,
0,42,91929b2e-11a6-4882-8948-7095ac0d5a52,regular,Remove the stolen device from the organization's domain(s),,,,,,,
0,43,338b43c9-b630-4501-88c8-12ee2929609d,regular,Remove the device's MAC address from any whitelists,,,,,,,
0,44,c3235bb8-65cb-4636-8bdc-5672b358fdcc,regular,Blacklist the stolen device in WiFi and NAC,Ensure that the thief cannot use the device to infiltrate our network.,,,,,,
0,45,bb6645c4-0c69-4448-809f-b429273b2543,regular,Insert device's MAC address to network security watchlists,If the thief attempts to use the device to access the network we want to block it and get an immediate critical alert to the SOC.,,,,,,
0,46,b37ade68-25c6-45a4-85e7-249c77347bbc,condition,Is the organization using an enterprise WiFi solution with individual auth?,,,,,,,
0,47,4893a678-7b19-4231-8fb0-0c7bf54d93b5,regular,Send a memo to users of the affected WiFi network(s) with new password,"Must be in a way that the thief will not see - a medium where the compromised account used on the device had already been locked, SMS after the compromised SIM had been locked, etc.",,,,,,
0,48,b0ce366b-64a7-40bd-8fef-1f08371b084f,regular,Change the WiFi passwords for all networks accessible from the compromised device,,,,,,,
0,49,bdd320bd-25c0-474c-846b-c189391e8b8d,regular,Revoke WiFi credentials,,,,,,,
0,50,cd286bd9-00a9-44e5-83b6-781f3e01c3ba,title,Final steps,,,,,,,
0,51,efc412a5-a348-4072-8e8f-959e3aa3a482,regular,Check with owner if they were using a common password shared with other users,"If, to their knowledge, other employees or accounts are using the same password (e.g. a password common across the organization), those accounts may be in danger of compromise. This is true even if these accounts were never accessed from the stolen device.

The attacker may try the passwords stored in the device on other employees' accounts. In many cases it is not possible to retrieve the clear text version of the password but some advanced attacks allow attacker to try the password hash or other representation against other accounts.",,,,,,
0,52,c2c42f58-b862-4443-8073-2b8b4c322f04,regular,Open a ticket for procurement to mark the device as stolen in ERP software,,,,,,,
0,53,6bbe97d0-af99-43da-88be-ae84ec0c2267,regular,Open a ticket for new device to be supplied and provisioned by IT,,,,,,,
0,54,a5a8e072-2d12-46ad-8448-1c958924aa4d,regular,Issue report to CISO by email,,,,,,,
0,0,8b39414f-fe78-4ae6-8ac6-2f13a86f1d22,start,start_task,,,,,,,
0,1,81a539cd-6e78-4b61-880c-8c8e2e175748,title,Initial Triage,,,,,,,
0,3,2b1a676a-d81d-40fd-8a66-c2617d9b3e01,regular,Retrieve device profile from IT asset management software,,,,,,,
0,4,7871d191-1fa1-438e-8ebd-7f1a3c47926a,regular,Retrieve employee information of the machine's owner from HR software,,,,,,,
0,5,4af9306c-9545-455b-840f-11f78528471d,regular,Review incident details,"Understand initial context of investigation. If any data is missing, collect it.
* system name
* people involved
* usernames involved
* initial severity as reported
* initial known events and the time of occurrence",,,,,,
0,6,cd85115e-4379-4319-853b-f518e9aa98bc,regular,Assess severity,"Based on the end user affected, and other information assess and change the severity if needed. ",,,,,,
0,7,bad41bb4-018b-47bb-8d0d-81831bb09ed7,regular,Notify head of IR team via Slack and Email,Notify that we are investigating a suspicious workstation ,,,,,,
0,8,8135a8aa-6d2c-4cf1-80c4-c5cf4bf136a8,regular,Assign and involve appropriate personnel,Invite the relevant users for investigation - malware expert and network experts if needed. ,,,,,,
0,9,257c9d0c-7451-41b5-8dcc-788f14d219f8,title,Review monitoring data,,,,,,,
0,10,0547ea00-5d6d-4234-83ee-47b25b6243fa,condition,Is Carbon Black available?,,,,,,,
0,11,55dad16e-31b0-4f56-8c98-4e0cf181a5fc,regular,Query Carbon Black for events around the time of the incident,,,,,,,
0,12,4451d7c1-6ba4-41b5-8d9b-f85bc0be115e,condition,Is ProtectWise available?,,,,,,,
0,13,13fc59c2-b4b4-4520-882a-c0a062d7cd4c,regular,Retrieve observations related to the investigated machine,,,,,,,
0,14,4845f050-3621-49bf-8c43-0fbbb89fccbc,regular,Retrieve events related to the investigated machine,,,,,,,
0,15,a2ab2707-061d-4267-86ff-6c22f258b436,condition,Is Splunk available?,,,,,,,
0,16,72c00e35-7582-4e2e-8451-3028be309a6b,regular,Search Splunk for recent events related to the investigated machine,,,,,,,
0,17,0f276a60-c08b-4de3-8433-247cad04286c,condition,Do we have a continuous network capture of the investigated machine?,,,,,,,
0,18,6aaae678-3a19-4fa4-8c8c-aba06097817a,regular,Retrieve packet capture for last 24 hours or at most 200MB,,,,,,,
0,19,746fcae3-95db-4f12-83fe-1919ade361a0,regular,Review antivirus logs for the affected systems,,,,,,,
0,20,aaa0755f-1b8c-46b4-8880-ac5890f6f79b,regular,Search UEBA solution for the relevant user's behavior in past 24 hours,,,,,,,
0,21,728e302a-32f6-4c93-8712-eb993b585daa,regular,Search DNS server logs for investigated machine's activity,,,,,,,
0,22,33771c7a-b1c6-4af2-8fdb-86f5a9aeb1b1,regular,Search web proxy logs for recent activity from this machine,,,,,,,
0,23,35b26857-fd74-451d-8938-e47d5add5f84,regular,Search firewall logs for blocked traffic from this machine,,,,,,,
0,24,ae70f6b0-7209-478d-81c7-2c8280ceae04,title,Collect evidence from the investigated machine,,,,,,,
0,25,f7a6e782-a13d-405a-875b-ce3a5dbfaab0,condition,Is Tanium available?,,,,,,,
0,26,8203f0a5-8647-4297-8222-1ca1216fb5fb,regular,Collect system information using Tanium,,,,,,,
0,27,49b75c73-56d3-4077-84c6-54abf60e78d4,regular,Trigger a snapshot / sytem restore point of affected systems,Create complete backup of affected systems for recovery and forensics.,,,,,,
0,28,c31637b7-02f1-4868-865c-ca5d5805c46a,regular,Collect volatile system data,"Collect system data like running processes, network connections and files changed. ",,,,,,
0,29,1c695f04-34ac-4eac-8495-e6881873715c,regular,Fetch the system's security event log,,,,,,,
0,30,05339003-481a-4ba6-85cd-a4fc9a2d15a0,regular,Create memory dump of the system,In addition to a full backup create a memory dump of the system. ,,,,,,
0,31,a07ebc12-2fe8-4a94-803b-5de91ab58bb5,regular,Collect autorun data,,,,,,,
0,32,8db75f38-b006-4863-8587-3fb56ac6a1c8,regular,Collect prefetch data,,,,,,,
0,33,336842d5-ac9a-4b2f-8e88-44fc6dc1e50a,regular,Collect browser history,,,,,,,
0,34,91f9a299-dcba-42cc-83b7-2de72925da8b,regular,Collect USB device history,,,,,,,
0,35,dd777994-1a09-4240-8376-cf29fff6bf53,title,Analyze collected evidence,,,,,,,
0,36,29f3b7f7-d78f-48ab-8b14-c427b8a9021e,regular,Look for suspicious local Windows user accounts and groups,,,,,,,
0,37,dc65bda0-b8a8-43d5-894d-b0198cbf06c6,regular,Look for suspicious autorun entries,,,,,,,
0,38,562f06bb-a9ea-475b-8409-3d87bd19d1ea,regular,Review file reputation for all autorun items,,,,,,,
0,39,f07e21aa-7254-4ae1-8346-a14c5baefcf0,regular,Detonate any suspicious autorun items in sandbox,,,,,,,
0,40,e7824c43-d362-4f3c-8d0e-02d9375316d0,regular,Check processes against our arsenal of YARA signatures,,,,,,,
0,41,ea65b582-5b2f-4bee-8477-f27d059ffd18,regular,Volatility - search for malicious IP addresses in network connection artifacts,,,,,,,
0,42,cef5c9f5-6813-4c91-81e7-bf36cbeac589,regular,Volatility - Check domains in DNS cache against threat intelligence,,,,,,,
0,43,1fe6d8ac-8736-49d4-8237-8674083d9286,regular,Volatility - Search for suspicious domains in DNS cache artifacts,,,,,,,
0,44,b1de25d6-b960-4d5c-8cac-ed24ec1d1d7b,regular,Volatility - review psxview results,,,,,,,
0,45,11a98d40-72b5-4269-891d-bb72839eec63,regular,Volatility - review malfind results,,,,,,,
0,46,5d610cd9-2f2c-4d9b-8a39-7163512c5342,regular,Volatility - show list of previously run system commands,,,,,,,
0,47,b0ed2a23-e4c0-4f21-833e-10e3d63cd1e8,regular,Correlate recently created and modified files against threat intelligence,"Research current threat intelligence for file activity
",,,,,,
0,48,5633d7bf-71ae-4580-819f-6ec527c3653d,regular,Review prefetch data,,,,,,,
0,49,aa5bb718-4a92-4879-842d-4f1109a9b197,regular,Review history of connected USB drives,,,,,,,
0,50,dcd48bb4-9192-4684-80be-9d9cc9ccce0c,regular,Look for processes without executable image on disk,,,,,,,
0,51,fc64c7a0-81e6-4bad-8c1a-e53fba7ae410,regular,Look for system processes with suspicious execution times,,,,,,,
0,52,f606fe45-0b28-470e-815d-58011a976a5f,regular,Look for process names with short edit distance from known process names,These may be attempts to fool a human investigator (e.g. scvhost.exe ),,,,,,
0,53,3da9dbf5-1973-4b2e-8d6f-b245a27d9f50,regular,Check process tree and look for suspicious relations,,,,,,,
0,54,7d3de1a4-dabf-485b-87d1-b4b42de754dd,regular,Look for traces of network sniffers,,,,,,,
0,55,5f142333-7e70-4884-8fd6-aadc40fdfa54,regular,Analyze network traffic for malware activity,Analyze the network traffic from/to this system for malware activity,,,,,,
0,56,1d90dc84-7336-422d-8bee-d4d05bbfa6d6,regular,Review shellbag data,,,,,,,
0,57,02d90455-9847-4c94-8587-c808102dd7c8,regular,Look up hashes of all running processes and loaded modules to find trojanized modules,,,,,,,
0,58,3233684b-e31c-4ad8-86c4-274a6205208c,regular,Analyze network traffic for signs of intrusion,Analyze the network traffic from/to this system for signs of intrusion.,,,,,,
0,59,11df018f-d953-4597-810e-8e56ef57d5c1,regular,Look for modifications of system files,,,,,,,
0,60,bc465242-756c-44ad-8546-b004ca98190c,title,Data Leak Assessment,,,,,,,
0,61,4f517c9c-3514-40b8-863a-8a599902896f,regular,Assess history of C&C communication in network logs,,,,,,,
0,62,fc8f6c5f-8779-4f11-81a7-e2ba19afb729,regular,Assess history of local and remote file accesses by the malware,,,,,,,
0,63,e8cd12ce-0d13-40eb-8a3a-9453927b2665,regular,Assess unusual activity and data access by compromised user accounts,,,,,,,
0,64,77134e96-d810-4fe9-8573-0dae9701905c,condition,Was any sensitive information leaked?,,,,,,,
0,65,79473708-5b11-44ae-86ad-1f05ec3ae75c,regular,Notify Public Relations (PR) team,,,,,,,
0,66,2b290909-b729-46a4-8c09-212bee8f6094,title,Respond,,,,,,,
0,67,5e48a7f1-8c3d-4472-8edd-43ad2ef061ce,condition,Was malware found?,,,,,,,
0,68,79732f56-83e8-428c-8a96-c9f0e853b45f,regular,Inform user that no malware was found,,,,,,,
0,69,9a73f01e-6096-4daf-80d3-0b671e74f619,regular,Report malware sample to AV vendor,,,,,,,
0,70,490a1dcc-ec5a-439c-8812-3a2ab1e00532,regular,Disable compromised AD account(s),,,,,,,
0,71,6c53cf14-51ae-4899-8e01-714dfd00cfc7,regular,Revoke authentication keys stored on the compromised host,,,,,,,
0,72,5d152b2c-067d-47ec-829b-fa56b8960307,regular,Revoke VPN credentials,,,,,,,
0,73,8b83a98e-4916-4a76-80e5-8736a5a207ba,regular,Instruct owner to change passwords for any personal accounts,"Personal email, social media, LinkedIn profile - these are in the control of the employee and they must be involved in order to change passwords. IT/Security staff can help to expedite.

This is not only for the benefit of the employee - there is a real danger to the organization: access to these accounts could allow the thief to convincingly impersonate the owner of the device in order to engage in Social Engineering against our other employees and further attack the organization.",,,,,,
0,74,39408b0b-ff1c-448a-817d-a2b1bda82bc1,regular,Ban relevant hashes across all systems,,,,,,,
0,75,c0b9dff1-ba08-400c-8dfd-af616aad2d16,regular,Search for same malicious communications from other systems,,,,,,,
0,76,b32d3cb5-4029-413b-8b4b-52f415dab2c9,title,Remediate and wrap up,,,,,,,
0,77,5b96fdcb-14af-434b-8c89-ebbb3b344145,regular,Notify affected user,Notify affected user about the outcome of investigation.,,,,,,
0,78,35c0d3b2-d9cd-460c-88be-6d7a229e9906,regular,Provide end-user remediation guidance and link to training,,,,,,,
0,79,f68ec944-041d-4288-80fd-d4593bceb52b,condition,Is the identified malware known? (with automated remediation steps),,,,,,,
0,80,f13d62e8-15a2-4240-8245-9537c0c7aa83,regular,Document manual remediation steps,,,,,,,
0,81,91223da8-3e5b-432e-85d6-b05a8e614f83,regular,Trigger remediation scripts,,,,,,,
0,82,36ba1145-5eb5-4bc4-85f6-d5c9f4495cca,condition,Was remediation successful?,,,,,,,
0,83,ea16d8dc-d539-4b3e-864a-b8e34f4a2fcc,regular,Open a ticket for IT to reimage the entire system and restore from backup,,,,,,,
0,84,b32992a7-f5e0-4b95-8dd2-5c70e938c715,regular,Remove temporary containment measures,Remove the temporary containment measures that were placed.,,,,,,
0,85,01b813e8-99a6-4988-8a32-5592c61b438d,regular,Reinstate disabled user accounts with new passwords,,,,,,,
0,86,d01ad182-bf69-4edf-8021-0bf3a6521340,regular,Deploy generated IoCs in relevant controls to prevent future attacks,,,,,,,
0,87,582e26b0-93d3-44d3-8a51-975d84ccdd9f,regular,Share generated IoCs with partner organizations,,,,,,,
0,88,2b7c48b3-cf1f-4a55-86bf-290cbcdebe49,regular,Email report to CISO,,,,,,,
0,89,d98a411a-e6ca-493d-83cb-564ecec2c156,regular,Expose Configured Integrations,,,,,,,
0,0,6839ec7c-e614-4f3e-8eaf-17d155c840c2,start,,,,,,,,
0,4,2d951f6e-18e3-4618-8546-9bacc2ebac5e,title,Setup,,,,,,,
0,17,c3be8540-6c7f-440a-84c0-474f62764780,regular,Choose analyst,,,,,,,
0,30,27128b5c-e619-43d8-8913-baa519a3bd1a,title,Handover to human analyst,,,,,,,
0,31,46f2f85d-5b7a-461c-84c8-926591fd866b,regular,Manually review the incident,,,,,,,
0,32,7bb473b8-90de-490e-8adb-e19dcb67794d,regular,Close Investigation,,,,,,,
0,43,160ae532-83b9-4b75-83b4-074a4da7a886,playbook,Malware Investigation - Generic - Setup,,,,,,,
0,45,6dcf0e54-5c0c-4734-83a3-d15f83cb5360,playbook,Entity Enrichment - Generic,,,,,,,
0,46,0f80017f-66cd-410d-87b0-04cc9e3fbb74,playbook,Detonate File - Generic,,,,,,,
0,47,07dc310c-c368-4c96-878a-71a98af2c8f1,playbook,Calculate Severity - Generic,"Calculate incident severity by indicators reputation and user/endpoint membership in critical groups.

Note - current severity will be overwritten and new severity may be lower than the current one.

Playbook inputs:
* CriticalUsers - Comma separated array with usernames of critical users
* CriticalEndpoints - Comma separated array with hostnames of critical endpoints
* CriticalGroups - Comma separated array with DN of critical Active Directory groups",,,,,,
0,0,f32e3309-cd35-442c-89bb-aedad44e51bc,start,,,,,,,,
0,1,6cb37fdd-3179-44d7-8846-a16dcc2062f6,title,Validate file sample,,,,,,,
0,2,c7670e54-f3e4-4a0d-89c9-e9340888ae6b,condition,Do we have a file sample?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'filters': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.File.EntryID'}, 'iscontext': True}}]]}}, 'iscontext': True}}]]}"
0,3,3c625815-68d5-4647-8891-11ba875c03c5,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'filters': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.File.EntryID'}, 'iscontext': True}}]]}}, 'iscontext': True}}]]}"
0,5,a0a3c0b4-515b-4cf6-8347-cdb7faa041f3,playbook,Get File Sample By Hash - Generic,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.File', 'filters': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.File.EntryID'}, 'iscontext': True}}]]}}, 'iscontext': True}}]]}"
0,6,2b71b1fe-ddb3-482a-8166-a8967829aba1,condition,Did we get a file sample?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'File.EntryID'}, 'iscontext': True}}]]}}, 'iscontext': True}}]]}"
0,7,496fdc1e-a8b5-421f-8d42-a29432859fd3,title,File sample is missing,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'File.EntryID'}, 'iscontext': True}}]]}}, 'iscontext': True}}]]}"
0,8,06ca5c31-261e-40b2-826d-1e0b6b994130,regular,Manually upload file sample,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'File.EntryID'}, 'iscontext': True}}]]}}, 'iscontext': True}}]]}"
0,10,52be4e01-b393-484d-8462-fc518e9dc3c2,title,Try to get file sample,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'File.EntryID'}, 'iscontext': True}}]]}}, 'iscontext': True}}]]}"
0,11,bb16ce78-06ab-4251-81a9-4a3bcd31426e,playbook,Get File Sample From Path - Generic,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'File.EntryID'}, 'iscontext': True}}]]}}, 'iscontext': True}}]]}"
0,12,cd33187e-1841-4fc0-82d0-92a0aff2bed1,title,Validate endpoint,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'filters': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'File.EntryID'}, 'iscontext': True}}]]}}, 'iscontext': True}}]]}"
0,13,ad325a74-79b8-49d4-8332-59488cad36d1,condition,Do we have a Hostname?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Hostname'}}, 'iscontext': True}}]]}"
0,14,9df62264-a011-4474-8504-ec1eeeaeb32a,playbook,Search Endpoints By Hash - Generic,Hunt using available tools,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Hostname'}}, 'iscontext': True}}]]}"
0,15,5afea8b2-3723-4c9b-81e5-0a8565d11903,condition,Did we get a Hostname?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Endpoint', 'accessor': 'Hostname'}}, 'iscontext': True}}]]}"
0,16,91e8996a-4e32-4041-882d-f37d07c4c54c,title,Hostname is missing,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Endpoint', 'accessor': 'Hostname'}}, 'iscontext': True}}]]}"
0,17,9b2ade69-a18a-4ef6-8492-24467f71b7eb,regular,Manually enter a Hostname,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Endpoint', 'accessor': 'Hostname'}}, 'iscontext': True}}]]}"
0,18,98cf5f35-2be9-49ab-8e2f-aa6c5ab9873b,title,Check file sample results,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Endpoint', 'accessor': 'Hostname'}}, 'iscontext': True}}]]}"
0,0,6839ec7c-e614-4f3e-8eaf-17d155c840c2,start,,,,,,,,
0,4,2d951f6e-18e3-4618-8546-9bacc2ebac5e,title,Setup,,,,,,,
0,17,c3be8540-6c7f-440a-84c0-474f62764780,regular,Choose analyst,,,,,,,
0,30,27128b5c-e619-43d8-8913-baa519a3bd1a,title,Handover to human analyst,,,,,,,
0,31,46f2f85d-5b7a-461c-84c8-926591fd866b,regular,Manually review the incident,,,,,,,
0,32,7bb473b8-90de-490e-8adb-e19dcb67794d,regular,Close Investigation,,,,,,,
0,43,160ae532-83b9-4b75-83b4-074a4da7a886,playbook,Malware Investigation - Generic - Setup,,,,,,,
0,44,363fe145-ff75-49a8-808d-5a65468f185c,playbook,Extract Indicators - Generic,,,,,,,
0,45,6dcf0e54-5c0c-4734-83a3-d15f83cb5360,playbook,Entity Enrichment - Generic,,,,,,,
0,46,0f80017f-66cd-410d-87b0-04cc9e3fbb74,playbook,Detonate File - Generic,,,,,,,
0,47,07dc310c-c368-4c96-878a-71a98af2c8f1,playbook,Calculate Severity - Generic,"Calculate incident severity by indicators reputation and user/endpoint membership in critical groups.

Note - current severity will be overwritten and new severity may be lower than the current one.

Playbook inputs:
* CriticalUsers - Comma separated array with usernames of critical users
* CriticalEndpoints - Comma separated array with hostnames of critical endpoints
* CriticalGroups - Comma separated array with DN of critical Active Directory groups",,,,,,
0,0,14834984-3a59-4eed-8de7-54179611c63d,start,,,,,,,,
0,1,528a058d-8c60-46dc-80b0-8139b45eeafd,condition,is ePO enabled?,,,,,,,
0,2,5c61873e-d9e2-4967-8776-82db5c05628b,regular,Get host info from ePO,,,,,,,
0,3,fed35557-6859-44e6-817a-ee0538819714,title,Done,,,,,,,
0,4,71f42a72-b2e7-479a-86e7-bc6ff218671e,condition,is MAR enabled?,,,,,,,
0,6,d3c21d0d-fc2a-4ba5-8bb9-da70f49ae96c,regular,Get host Processes,,,,,,,
0,9,98827aec-511a-4f30-8fdb-04240496380d,regular,Get host Scheduled tasks,,,,,,,
0,10,38ad462f-1c16-4c4a-8cd8-446e19c24694,regular,Get host services,,,,,,,
0,11,6e9fb885-21b5-417d-800c-e02aa81cb91f,regular,Get host Command line history,,,,,,,
0,12,69f8efa1-8783-4165-8ce4-2f5e0f3db937,regular,"Get host ""Current flow""",,,,,,,
0,13,08612fec-a2cb-4b1c-8a10-e8148722075f,regular,Get host DNS cache,,,,,,,
0,14,5479417e-4e95-422a-8e92-4f585f40fd50,regular,Get host environment variables,,,,,,,
0,15,cd3926a0-6157-4ef3-8fd1-86b6cbd79e7c,regular,Get host local groups,,,,,,,
0,17,0287ca41-8587-4bb2-84d6-4824b5133df1,regular,Get host logged in users,,,,,,,
0,18,c781977e-2b17-4273-86c2-246912262601,regular,Get host network shares,,,,,,,
0,19,ebfbc02e-b674-4899-8586-ea8621533c3b,regular,Get host interactive sessions,,,,,,,
0,20,79f385d1-1aa0-47f9-84de-f0b579492151,regular,Get host network interfaces,,,,,,,
0,21,c35f205c-5c9a-4846-85b9-0a11e1b9f5ad,regular,Get host's connected USB Storage Devices,,,,,,,
0,22,cac5062b-32b7-4789-8f25-c28ea0e40873,regular,Get host user profiles,,,,,,,
0,23,00e3cf95-5dda-411c-8ec5-027ba3348a21,regular,Get host installed software,,,,,,,
0,24,4afc3a44-f5f9-462a-8f41-dc697c9366e2,regular,Get host Network Sessions,,,,,,,
0,25,e7fcd15d-3273-4163-803e-26d5e76f712e,regular,Get host Startup items,,,,,,,
0,26,41252036-b29b-4a75-82e7-68fe3fa9b0a5,title,Collect data from endpoint,,,,,,,
0,27,23bbdc19-0b43-4b5e-8d2b-939183909e09,title,Users and groups,,,,,,,
0,28,bf8c2f0a-d98b-4059-82db-a9f06f937177,title,Executable,,,,,,,
0,29,abee0804-81a8-45da-8fab-a3792b165c49,title,Network,,,,,,,
0,30,c5ff2c93-f30c-45eb-87b7-bcd676d1e7a2,title,Others,,,,,,,
0,0,0e3fe5d5-d93f-4ce9-8b62-685427fb9e5a,start,start_task,,,,,,,
0,1,9c37c208-6466-4564-87db-2ebcdf47c9ad,condition,Are any endpoints in ePO listed as unmanaged? ,Place the list of non-communicating endpoints in incident label epoUnmanagedEndpoints,,,,,,
0,2,956874f3-ed9f-4e74-850b-4e98a76e2ce7,regular,Check if unmanaged endpoints are in special excluded list.,"Most organizations have some excluded servers, either legacy OS, or being managed by a different security solution, etc.
Usually this list is managed in Active Directory and this task is accomplished by checking whether any computers in the unmanaged list are a member of this group.

Type in the comments the system names that need to be handled - comma separated",,,,,,
0,3,a6a568b4-7902-40da-8d7d-bb87db62debc,regular,Open ServiceNow ticket for admin to install agents,,,,,,,
0,4,1d99f9b9-166a-4248-84f6-b90c15951e33,condition,Check if there are agents which haven't communicated with ePO in the past 3 days,Type in comments the system names that need to be handled - comma separated,,,,,,
0,5,f35617e9-0a55-4967-8a2e-1c878e4711a0,regular,CloseInvestigation,,,,,,,
0,6,4a32bb9b-8d01-48f5-8685-c754b5067c09,regular,Check connectivity for each endpoint using ping,,,,,,,
0,7,b5a87844-2303-4da8-8b3f-9824047aa547,regular,Remotely check that McAfee Agent is installed and running,,,,,,,
0,8,2c6c6764-94f8-4777-836b-649ef7b51b98,regular,Remotely execute cmdagent commandline utility to force communication with ePO,,,,,,,
0,9,70cbf053-e249-48eb-823e-10c903391df5,regular,Retrieve McAfee Agent logs from non-communicating endpoints,,,,,,,
0,10,b5f717be-a4a8-4ba2-86ca-6f6e4024236c,regular,Store list of unmanaged endpoints to context key epoUnmanagedEndpoint,"Takes the comments of a given entry ID and stores them in the incident context, under a provided context key. For accessing the last executed task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for the entryId input parameter.",,,,,,
0,11,3da5d5ef-6d6a-4099-8d83-d5a33d6ef515,regular,Store non-communicating endpoints to context key epoNonCommunicatingEndpoint,"Takes the comments of a given entry ID and stores them in the incident context, under a provided context key. For accessing the last executed task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for the entryId input parameter.",,,,,,
0,0,a3d08d64-ed0b-41ff-886d-00daa3ed7c90,start,start_task,,,,,,,
0,2,cdd9fe08-f2d7-4b2f-8e62-ec21ed9e3715,regular,Retrieve ePO's current DAT version,,,,,,,
0,3,b8d7abd0-0a4f-4e52-8aac-5fd4e6949fd6,condition,Are any endpoints outdated and using an older DAT version?,Type list of systems in comments - comma separated,,,,,,
0,4,aa4a2429-7901-440e-8d5a-e46557154f5b,condition,Are any endpoints faulty and dangerously outdated?,Type system names in comments - comma separated,,,,,,
0,5,64ae7dd1-592c-4f0a-8b57-3107a6e4040a,regular,Isolate dangerous systems from network,,,,,,,
0,6,05cac450-0b26-47b5-82ab-23e64849c2c3,regular,Open ServiceNow ticket with list of problematic endpoints to be handled by the appropriate team,,,,,,,
0,7,6d0b0842-0873-4629-8e39-9b4b873f46cb,regular,Trigger signature update on outdated endpoints,,,,,,,
0,8,99679543-7b3b-4f76-8cc7-fec535710df0,regular,Display list of AV related tickets from ServiceNow,,,,,,,
0,9,8b9983e7-0454-4087-8dee-e85b4cda4ba4,regular,Close the investigation,,,,,,,
0,10,a8019bd1-dd82-4437-8b23-a38d82a0fe5e,regular,Get McAfee latest DAT Version,Check the latest DAT file in McAfee repository,,,,,,
0,11,370580ad-016e-4515-8a0e-e76cd0e55373,regular,Store system names to context key outdatedEndpoints,"Takes the comments of a given entry ID and stores them in the incident context, under a provided context key. For accessing the last executed task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for the entryId input parameter.",,,,,,
0,12,2ea4d150-6e57-4bb3-812c-2b18efa693e6,regular,Store system names to context key endpointsToIsolate,"Takes the comments of a given entry ID and stores them in the incident context, under a provided context key. For accessing the last executed task's comments, provide ${lastCompletedTaskEntries.[0]} as the value for the entryId input parameter.",,,,,,
0,13,ce5e0dfc-c502-4f3c-8569-38e2b4c7baee,regular,Set incident severity to High,"Modify incident info such as name, owner, type, etc.",,,,,,
0,0,ee018e04-2610-4998-87d0-f5217127bbad,start,start_task,,,,,,,
0,2,4d3e8911-2cd9-4f8c-89fa-1d1418bc3dfa,regular,Retrieve DAT version and date from McAfee,,,,,,,
0,4,b7e28ac8-487e-4946-8316-7361f08ac1c5,regular,Initiate update task in each local repository,,,,,,,
0,5,620023d1-63b0-4834-81a2-74dd20437dda,regular,Send report to admin with update results,,,,,,,
0,7,dccfaaf4-cca5-44d3-8818-6a5131b502ed,regular,Send email alert with list of faulty repositories to admin,,,,,,,
0,10,220a0d1d-b7cc-403f-8750-526d3bf55b51,regular,Close the investigation,,,,,,,
0,11,dd5d9578-ca9e-4a3b-8088-940627f3fe9e,regular,epo-get-current-dat,check the existing DAT file version in ePO,,,,,,
0,12,4405829c-0e70-4c29-8a33-3c17a9644b00,condition,Check if ePO has latest DAT from McAfee,Check whether the values provided in arguments are equal.,,,,,,
0,13,8de9cf55-b3d6-46d0-8aa6-3de9bcd2a64b,regular,Wait for 5 minutes,Sleep for X seconds,,,,,,
0,14,b766e4a2-8988-46e1-84ab-d91d118d48a7,regular,Get ePO current DAT version,check the existing DAT file version in ePO,,,,,,
0,15,5b82d2b7-4ac6-4759-8f19-4810dff0b0ad,condition,Check if ePO has latest DAT from McAfee,Check whether the values provided in arguments are equal.,,,,,,
0,16,5e480762-0617-4ad1-80e3-8bead4c6adf5,regular,Set incident to High severity,"Modify incident info such as name, owner, type, etc.",,,,,,
0,0,54ef50e9-fe1c-4750-8c0c-0f23d1adcc2f,start,,start,,,,,,
0,1,0380b4f9-97f5-4950-87ba-139588b099e6,regular,ews-o365-start-compliance-search,Start compliance search,,,,,,
0,2,f2775280-9f9f-4107-820b-d36851d617a2,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,5cd5158f-dade-4886-83c0-8d4b8b71783e,regular,ews-o365-get-compliance-search,Get compliance search status and results,,,,,,
0,4,ba34205c-fc58-4017-8377-cffd6187b25a,condition,Purge Compliance Search Results?,Purge Compliance Search Results?,,,,,,
0,5,58c170b4-f644-49d0-87a4-7e74525e6b1b,regular,ews-o365-purge-compliance-search-results,Purges the results found by the compliance search,,,,,,
0,6,5558f163-14fa-47e2-824f-a59ee77f6f05,title,Done,Done,,,,,,
0,7,5d7d9177-0151-4673-8ee6-dc7b7fdfebcb,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,8,fd3837a8-7a2d-494d-886e-d2d86a56ed5f,regular,ews-o365-get-compliance-search-purge-status,Check the status of the purge operation on the compliance search.,,,,,,
0,9,283a5fed-c2cb-4292-890a-98a6935f17c2,regular,ews-o365-remove-compliance-search,Remove the compliance search,,,,,,
0,0,72f6ac89-7d29-48cd-8fc8-a87a469d368e,start,,-,,,,,,
0,1,3cdca23e-0cc3-4d3f-8f27-aef7c980e40d,condition,Is Palo Alto Networks PAN-OS enabled?,Verify that there is a valid instance of Palo Alto Networks PAN-OS enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,2,e112b079-f6be-4f2e-86b3-ced990700352,regular,panorama-commit,Commit Palo Alto Firewall or Panorama,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,3,16b55e1b-edf4-4495-8acd-ec822793a904,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,384cca31-aa07-45d6-8ce9-54c2e8dc19ea,condition,Is instance Palo Alto Firewall or Panorama?,Checks if the instance is Palo Alto FIrewall or Panorama,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.FIrewall_OR_Panorama', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.FIrewall_OR_Panorama'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}"
0,5,952b0224-dd79-4eca-8721-d93bd8edd76a,title,Done,-,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.FIrewall_OR_Panorama', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.FIrewall_OR_Panorama'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}"
0,6,2ff73215-8971-475b-860e-6920fe227658,regular,panorama-push-to-device-group,Push rules from Palo Alto Panorama to the Palo Alto configured device group.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.FIrewall_OR_Panorama', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.FIrewall_OR_Panorama'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}"
0,7,d7c1b22b-2529-494e-8959-dd33edd07e6e,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.FIrewall_OR_Panorama', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.FIrewall_OR_Panorama'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}"
0,8,bd75273e-c3cd-4503-8737-856299908727,regular,panorama-commit-status,Get commit status,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.FIrewall_OR_Panorama', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.FIrewall_OR_Panorama'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}"
0,9,e96b6162-cac9-4c18-8e54-58abf62d0039,regular,panorama-push-status,Get push status,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.FIrewall_OR_Panorama', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.FIrewall_OR_Panorama'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}, 'ignorecase': True}]]}"
0,10,7fff9e78-fd85-43fe-8331-6a50191e5ffe,condition,Filter JobID,Filter JobID to validate only new push configuration JobIDs,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': ""Panorama.Commit(val.Status != 'Completed' && val.Status != 'Failed').JobID""}, 'iscontext': True}}]]}"
0,11,3123d9ad-2650-478e-8746-3401631faa14,condition,Filter JobID,Filter JobID to validate only new push configuration JobIDs,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': ""Panorama.Push(val.Status != 'Completed' && val.Status != 'Failed').JobID""}, 'iscontext': True}}]]}"
0,0,7de51952-0933-4b9c-8bf1-b9bd0a1e887d,start,,,,,,,,
0,1,99a631c1-8dd8-4a8a-8608-98f964655794,condition,Is Palo Alto Networks PAN-OS enabled?,Checks if there is a valid instance of the Palo Alto Networks PAN-OS integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,2,0c582d23-1783-4574-82db-35350df254ff,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,3,0a3a3ded-4ea5-4225-8e50-90f4d3096604,regular,panorama-query-traffic-logs,Queries traffic logs.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,a15dbada-1559-4c04-80b9-5219290608ce,regular,panorama-check-traffic-logs-status,Checks the status of a traffic logs query.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Panorama'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,5,eec80951-45c2-4823-8f68-e6a27deb77e0,condition,Filter JobID,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Panorama', 'filters': [[{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Panorama.TrafficLogs.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Completed'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Panorama.TrafficLogs.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Failed'}}}]], 'accessor': 'TrafficLogs.JobID'}}, 'iscontext': True}}]]}"
0,6,0d71170a-8e17-41f5-8d33-15294a1dcd6e,playbook,GenericPolling,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Panorama', 'filters': [[{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Panorama.TrafficLogs.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Completed'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Panorama.TrafficLogs.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Failed'}}}]], 'accessor': 'TrafficLogs.JobID'}}, 'iscontext': True}}]]}"
0,7,c70e2c02-5135-4d4a-82bd-d1e820a3aa2a,regular,panorama-get-traffic-logs,Retrieves traffic log query data by job id,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Panorama', 'filters': [[{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Panorama.TrafficLogs.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Completed'}}}], [{'operator': 'isNotEqualString', 'left': {'value': {'simple': 'Panorama.TrafficLogs.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'Failed'}}}]], 'accessor': 'TrafficLogs.JobID'}}, 'iscontext': True}}]]}"
0,0,42767ebd-7fcd-4525-859f-be9d16a8517c,start,start_task,,,,,,,
0,1,f61f3880-e5f6-4a41-8af8-3349e3ebffff,title,Engage,,,,,,,
0,3,d69a6289-b692-404c-8f90-d37d72aa265c,regular,Notify management chain,Notify appropriate people inside the organization. ,,,,,,
0,4,21cb9178-78a0-4610-801f-3bc5f808e4a2,regular,Initial triage,"1. Make sure that there is relevant information in the incident - system name, end user name and initial severity as reported.",,,,,,
0,5,b7f2e51f-a39f-4cba-881d-e7efbef2553e,title,Investigation Step 1: Initial Inspection,,,,,,,
0,6,30e833d0-8336-4ecd-8a36-a997ac1bb100,regular,Inspect the email body for malicious URLs,Check the email body attached to the incident and see if it has malicious URLs in it using threat feeds,,,,,,
0,7,0aba5f0e-c71f-4a1f-8f7a-993f727e3825,regular,Inspect the email attachments,Check the attachments with threat services to see if any of them is known bad,,,,,,
0,8,fa90abdd-2ec1-490b-8a9e-2acc6f2f721d,regular,Is the sender name or email address identified as bad by threat feeds?,Check the sender email and name against threat feed sources.,,,,,,
0,9,d9fad845-7f5b-4c79-8835-2e8358c84e04,regular,Check if the hostname is being misrepresented?,"Check if domain of sender or any hostname in the URLs inside the email body are misrepresented. See if the URL text versus the hostname shown are different by comparing the link with the text. Also carefully inspected the URLs for spelling spoofing which
 is typically a sign of phishing email.",,,,,,
0,10,5d36d65b-d63f-40b7-8167-2a341e9bed62,condition,Is this a real phishing email?,"Based on the steps above, is this really a phishing email?",,,,,,
0,11,b37377be-5c13-41f5-8635-69ea34571af7,regular,Close the investigation as false positive,Close the investigation as false positive and reply to the user sending the email that it is not malicious.,,,,,,
0,12,e76cfd73-35f3-4065-8e59-c37e365cd06c,regular,Assess severity,"Based on the end user affected, and other information assess and change the severity if needed. ",,,,,,
0,13,5445acdd-df36-403e-8635-a0cbc3bd3f04,regular,Assign and involve appropriate personnel,Invite the relevant users for investigation - malware expert and network experts if needed. ,,,,,,
0,14,eb2b0d5a-cc72-4640-8116-85750701ae1d,title,Investigation Step 2: Deeper Analysis,,,,,,,
0,15,92ae3779-12c5-4a24-827e-56e413088b80,regular,Get all the URLs from the email,,,,,,,
0,16,13e0228e-ad6a-4148-8aa6-55e8143a4620,regular,Get all the hostnames inside the email,,,,,,,
0,17,05855c19-9221-478d-8c83-4145aa2cff16,regular,Fetch all the files from the URL,Use curl or similar tool to download all the files from the URLs in the email. ,,,,,,
0,18,010895a1-9f86-4106-8e56-8f6889d5e228,condition,Are the files download malicious - hash inspection?,Check the files MD5 and SHA1 against the threat feed databases.,,,,,,
0,19,2580b31a-6c04-45b1-8752-959f66084ae3,condition,Are the files download malicious - static and dynamic analysis?,Check the files in a sandbox solution to see if they are malicious.,,,,,,
0,20,24063b39-4c30-4ef2-8e7c-36081b45faaa,condition,Is any URL malicious based on sandbox inspection?,Use Cuckoo or similar sandbox solutions for fetching the content of the URL for deeper analysis. ,,,,,,
0,21,9c572188-54b5-4d56-8e62-95ee93e3a157,regular,"Consider this email as phishing and move to ""Response Section""",,,,,,,
0,22,email_phishing,regular,"Consider this email as phishing and move to ""Response Section""",,,,,,,
0,23,ff551c65-6d74-460d-8e4d-4a5a84517e9b,regular,"Consider this email as phishing and move to ""Response Section""",,,,,,,
0,24,3b29ac0a-190d-46bf-80cf-dbc1197d2f80,title,Investigation Step 3: Is it a Campaign?,,,,,,,
0,25,78cc334d-fe36-4cb0-8e63-dbb571077edc,condition,Did we have a similar phishing email earlier?,"Search past phishing investigations for subject sender, email content and URLs.",,,,,,
0,26,ec15c113-29a0-4ab5-85fc-3fc1fbe85a70,regular,Mark this as a campaign rather than isolated incident.,,,,,,,
0,27,e3710c0f-861d-4a9a-8e89-3488f572d74e,regular,Link old and new incidents to this master incident.,Future emails with similar subject should be associated with this incident,,,,,,
0,28,0386fa2c-a246-4dd9-8592-976b630148fc,title,Respond,,,,,,,
0,29,faf506e6-c1bd-49ee-8348-bdb258984785,regular,Notify internal PR team if this is a campaign,"If we identified multiple emails with similar content, subject and identified this as a campaign, we need to notify our users. Send an email to internal communications team with the details - like sender, content etc. ",,,,,,
0,30,a0b42339-fa44-4215-8fdd-8dc900011dd8,regular,Block email on the server,"Identify the appropriate headers from the initial email beyond subject
 and sender email to make sure we can effectively block this on server. This
 task needs analysis of header to make sure we do not block other emails and
 still be effective in blocking.",,,,,,
0,31,e93a15aa-1c5d-46ff-813c-b1f6eed114f3,regular,Notify IT to update SPAM filters,Give IT the phishing email so that they can train the SPAM filter with this email to avoid future attacks. ,,,,,,
0,32,f487ba1c-d67b-40f2-8cf8-85f646b0d768,regular,Notify email security vendor,"Forward all the details to your security vendor for email security
 solution. This will help them with the future updates.",,,,,,
0,33,1b6d8f94-452c-43b2-8606-da89d3f738c8,regular,Remove email from inboxes,Work with IT to completely delete similar emails from all user inboxes. Search through the SMTP logs to find all the recipients and delete the emails. ,,,,,,
0,34,c47f9b5a-cba2-4b2c-89ca-0c1003e9c295,regular,Blackholing phishing domain on Domain Controller,"Work with IT to black hole the phishing domains (this particular
 and related ones from other emails and incidents that were marked duplicate).
 This should be blocked on the domain controller by resolving to 127.0.0.1",,,,,,
0,35,b3e805e2-2566-4f28-884d-dcc8a8fe3573,regular,Blocking download URL," 1. Try to identify a pattern in the URL. For example if the URL is: http://hackedwebsite.com/dl.php?campaign=ra&id=12731342834923919
 2. Create a reasonable regex like: ^.+/dl.php?.*campaign=ra.$
 3. Contact the proxy team to block URLs based on the pattern",,,,,,
0,36,ffa62d59-1b44-4305-8324-3cc29f4585ff,regular,Report malware sample to AV vendors,Report all the files that were downloaded from URL to AV vendor and virustotal like services.,,,,,,
0,0,ea4fb28a-8a76-4708-80c2-28f936d8bf94,start,start_task,,,,,,,
0,1,ea731eb3-f592-42f3-892a-6a7d48c42e4d,title,Triage and Engage,,,,,,,
0,4,2e0a1bd6-0e9a-4906-843c-e4652ed671f2,regular,Auto-respond to acknowledge receipt,Send an auto-response to the target telling them we are on it,,,,,,
0,13,b2b1f385-7cff-427a-8882-2c18875c9a2e,regular,Extract IP Addresses from email,,,,,,,
0,14,a846334e-5ccc-4d95-8244-d57ec36d6e2f,regular,Extract URLs from email,,,,,,,
0,23,c752c128-ee8f-4f94-877a-39bdb10a7d40,condition,Is the attachment malicious according to Sandbox report?,,,,,,,
0,28,4440a41f-7d53-4a52-86bb-85b49b6722b4,title,Manual Investigation Step 1: Initial Inspection,,,,,,,
0,30,7f2d8700-472f-4cfa-87e4-97681e5309fa,regular,Check sender domain distance,Check if the sender is trying to confuse the user with a domain that is very close to one of our own email domains,,,,,,
0,31,5778ac35-8936-4170-8cf6-8cc09c98a300,regular,Manually inspect the email for anything suspicious,"Since automatic triage did not find anything wrong, please inspect it manually and see if something stands out",,,,,,
0,32,5445acdd-df36-403e-8635-a0cbc3bd3f04,regular,Assign and involve appropriate personnel,Invite the relevant users for investigation - malware expert and network experts if needed. ,,,,,,
0,33,e76cfd73-35f3-4065-8e59-c37e365cd06c,regular,Assess severity,"Based on the end user affected, and other information assess and change the severity if needed. ",,,,,,
0,34,3e30e515-bb4e-4b65-8d8c-a21a1e380126,title,Manual Investigation Step 2: Deeper Inspection,,,,,,,
0,36,cceb5cd4-a661-434d-87d8-24b9988877c4,condition,Check if the hostname in urls is being misrepresented?,"See if the URL text versus the hostname shown are different by hovering
 over the link. Also carefully inspected the URL for spelling spoofing which
 is typically a sign of phishing email.",,,,,,
0,42,103b416e-75c9-4628-8b32-0dbab7b0f7a8,title,Response,,,,,,,
0,44,aafb8c0f-765a-4bbb-81c9-b1435b795f2e,regular,Send email to user notifying them this email is safe,,,,,,,
0,45,abf517ab-27b6-49a9-853d-41e56650a92a,regular,Close the phishing investigation,,,,,,,
0,46,8a9ba010-09e1-4aa6-810f-859ae66768e6,regular,Send email to user notifying them it's a malicious email,,,,,,,
0,55,9892f321-ad3e-45ed-8abe-a4f29f29068a,condition,Did we find an attachment inside the email and extract its hash?,,,,,,,
0,63,7b2f5045-5c2e-4db3-895b-f3cd8d51ef20,regular,Investigate further,Investigate the results of the execution,,,,,,
0,71,75e0739e-4f37-4859-8ae2-857be0d57d6c,title,Extract indicators,,,,,,,
0,72,03606952-f504-44b2-8371-5a548e395048,title,Check indicators,,,,,,,
0,81,5359d876-c7b6-495c-8249-fd87d30d5663,condition,Was any malicious indicator found?,,,,,,,
0,89,a2f77d09-4dc1-431a-8d7f-538f3b285e56,condition,Is the distance really small,,,,,,,
0,91,2e785868-8ecb-47b8-8123-66e817a31f57,regular,Review all results and decide should we close investigation,,,,,,,
0,94,bff69be5-924f-4eda-8264-83e9c2246ab6,regular,Store the sending account,,,,,,,
0,97,286c067d-78e0-4d90-8107-eec5625b4b82,playbook,,,,,,,,
0,98,6104b475-bee7-42aa-87c4-07c6e433a350,playbook,,,,,,,,
0,99,abdcdddf-7b08-4c4a-8f29-842890ee1351,playbook,,,,,,,,
0,100,27922299-5a0b-4525-8465-7c2efd9503b5,playbook,,,,,,,,
0,101,16dd2965-30b6-47dc-80bf-48f322e21e9c,playbook,,,,,,,,
0,102,c932dac2-0738-4b68-8c30-1b27aa0dcda8,regular,Search for the malicious email in other mailboxes,#NAME?,,,,,,
0,0,ea4fb28a-8a76-4708-80c2-28f936d8bf94,start,start_task,,,,,,,
0,1,ea731eb3-f592-42f3-892a-6a7d48c42e4d,title,Triage and Engage,,,,,,,
0,4,2e0a1bd6-0e9a-4906-843c-e4652ed671f2,regular,Auto-respond to acknowledge receipt,Send an auto-response to the target telling them we are on it,,,,,,
0,13,b2b1f385-7cff-427a-8882-2c18875c9a2e,regular,Extract IP Addresses from email,,,,,,,
0,14,a846334e-5ccc-4d95-8244-d57ec36d6e2f,regular,Extract URLs from email,,,,,,,
0,23,c752c128-ee8f-4f94-877a-39bdb10a7d40,condition,Is the attachment malicious according to Sandbox report?,,,,,,,
0,28,4440a41f-7d53-4a52-86bb-85b49b6722b4,title,Manual Investigation Step 1: Initial Inspection,,,,,,,
0,30,7f2d8700-472f-4cfa-87e4-97681e5309fa,regular,Check sender domain distance,Check if the sender is trying to confuse the user with a domain that is very close to one of our own email domains,,,,,,
0,31,5778ac35-8936-4170-8cf6-8cc09c98a300,regular,Manually inspect the email for anything suspicious,"Since automatic triage did not find anything wrong, please inspect it manually and see if something stands out",,,,,,
0,32,5445acdd-df36-403e-8635-a0cbc3bd3f04,regular,Assign and involve appropriate personnel,Invite the relevant users for investigation - malware expert and network experts if needed. ,,,,,,
0,33,e76cfd73-35f3-4065-8e59-c37e365cd06c,regular,Assess severity,"Based on the end user affected, and other information assess and change the severity if needed. ",,,,,,
0,34,3e30e515-bb4e-4b65-8d8c-a21a1e380126,title,Manual Investigation Step 2: Deeper Inspection,,,,,,,
0,36,cceb5cd4-a661-434d-87d8-24b9988877c4,condition,Check if the hostname in urls is being misrepresented?,"See if the URL text versus the hostname shown are different by hovering
 over the link. Also carefully inspected the URL for spelling spoofing which
 is typically a sign of phishing email.",,,,,,
0,42,103b416e-75c9-4628-8b32-0dbab7b0f7a8,title,Response,,,,,,,
0,44,aafb8c0f-765a-4bbb-81c9-b1435b795f2e,regular,Send email to user notifying them this email is safe,,,,,,,
0,45,abf517ab-27b6-49a9-853d-41e56650a92a,regular,Close the phishing investigation,,,,,,,
0,46,8a9ba010-09e1-4aa6-810f-859ae66768e6,regular,Send email to user notifying them it's a malicious email,,,,,,,
0,55,9892f321-ad3e-45ed-8abe-a4f29f29068a,condition,Did we find an attachment inside the email and extract its hash?,,,,,,,
0,63,7b2f5045-5c2e-4db3-895b-f3cd8d51ef20,regular,Investigate further,Investigate the results of the execution,,,,,,
0,71,75e0739e-4f37-4859-8ae2-857be0d57d6c,title,Extract indicators,,,,,,,
0,72,03606952-f504-44b2-8371-5a548e395048,title,Check indicators,,,,,,,
0,81,5359d876-c7b6-495c-8249-fd87d30d5663,condition,Was any malicious indicator found?,,,,,,,
0,89,a2f77d09-4dc1-431a-8d7f-538f3b285e56,condition,Is the distance really small,,,,,,,
0,91,2e785868-8ecb-47b8-8123-66e817a31f57,regular,Review all results and decide should we close investigation,,,,,,,
0,94,bff69be5-924f-4eda-8264-83e9c2246ab6,regular,Store the sending account,,,,,,,
0,97,286c067d-78e0-4d90-8107-eec5625b4b82,playbook,,,,,,,,
0,98,6104b475-bee7-42aa-87c4-07c6e433a350,playbook,,,,,,,,
0,99,abdcdddf-7b08-4c4a-8f29-842890ee1351,playbook,,,,,,,,
0,100,27922299-5a0b-4525-8465-7c2efd9503b5,playbook,,,,,,,,
0,101,16dd2965-30b6-47dc-80bf-48f322e21e9c,playbook,,,,,,,,
0,102,c932dac2-0738-4b68-8c30-1b27aa0dcda8,regular,Search for the malicious email in other mailboxes,#NAME?,,,,,,
0,0,dcbd7a1c-40ce-43f8-8081-f65c816abd4b,start,,,,,,,,
0,1,bb7ac632-1e63-40c2-8ba6-d4cc90c4e922,regular,extractIndicators,Extracts all indicators for the given input.,,,,,,
0,2,615ed3b6-e340-4065-8f4f-26d421eca88a,regular,demo-ip (Get Reputation),Gets the simulated reputation of the IP address.,,,,,,
0,4,1d8d7ac8-90d6-4f2a-8f75-7c99eaace2d4,regular,Update Incident Severity,Modify properties of an incident.,,,,,,
0,5,7159b854-7dc5-4a75-8dd2-1f4a5f02939f,regular,Investigate the incident,,,,,,,
0,7,20de2d7f-9995-4933-8f15-84ac1dcab747,regular,rasterize-email,Rasterizes an email body into an image.,,email_html_image,,,,
0,8,708bbc37-c4bd-4b18-8076-abbe52577868,regular,demo-url (Get Reputation),Gets the simulated reputation of the URL.,,email_html_image,,,,
0,9,5d7cab19-09b6-4d77-8170-5bc092fe5abe,regular,demo-domain (Get Reputation),Gets the simulated reputation of the domain.,,email_html_image,,,,
0,10,2c13c3d1-d0c4-4d16-8d8c-e77673777d27,regular,demo-email (Get Reputation),Gets the simulated reputation of the email address.,,email_html_image,,,,
0,11,f4ab78fe-aa1a-48d0-8c6c-6754f3b73cf7,regular,demo-file (MD5 hashes) (Get Reputation),Gets the simulated reputation of the MD5 hash.,,email_html_image,,,,
0,12,1cd3da3e-fa82-4741-8783-6b2557e60f41,regular,demo-file (SHA-1 hashes) (Get Reputation),Gets the simulated reputation of the SHA-1 hash.,,email_html_image,,,,
0,13,b08f45a8-b9d9-435b-82d0-abfdc1688950,regular,demo-file (SHA-256 hashes) (Get Reputation),Gets the simulated reputation of the SHA-256 hash.,,email_html_image,,,,
0,14,0a294eb3-a38e-4f38-8725-3048c65df31f,title,Done,,,email_html_image,,,,
0,0,44927568-9dcf-4acb-84c2-1466eb224729,start,,,,,,,,
0,2,c4e87e26-a8fc-473a-8f84-e63335a552e8,regular,Assign to analyst,Assign the incident to an analyst based on the analyst's organizational role.,,,,,,
0,6,c3cd10bc-d79e-4471-8b28-82613ac05418,playbook,,,,,,,,
0,7,89d7dd49-06a3-4397-8b72-f4428bf24805,regular,Manually review the incident,Review the incident to determine if the email that the user reported is malicious.,,,,,,
0,8,104d08e2-78ad-496f-81f6-f3ebe77f3b5a,regular,Close investigation,Close the investigation.,,,,,,
0,11,f90db644-38c8-4d31-840c-4b5b16069a33,title,Triage,,,,,,,
0,12,1a99d7e1-2c84-4d57-80be-0ec42482d952,regular,Store the email address of the reporting user,Store the email address of the user that reported the incident.,,,,,,
0,13,0f0f8a66-8f89-43fe-8e23-33d1d476c175,regular,Acknowledge incident was received,"Send an auto-response to user that reported the incident, informing them the incident was received and being handled.
",,,,,,
0,14,ca8ce4fe-c164-447f-872e-7a4ecf2cdbcd,playbook,Email Address Enrichment - Generic,,,,,,,
0,15,bd6e25bf-75cc-41b0-8f27-12b96b0f5ca4,condition,Is the email malicious?,Determine if the email is malicious based on the calculated severity.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,16,ac0d8fe7-8ec0-49b8-8947-75d3bb87437c,regular,Update  the user that the reported email is safe,Send an email to the user explaining that the email they reported is safe.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,17,3616a344-7c58-4ac0-86fe-bad84f58c2e2,regular,Update  the user that the reported email is malicious,Send an email to the user explaining that the email they reported is malicious.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,18,a4de0c33-52a7-42d9-8e4d-1a753a62d20e,title,Engage with User,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,22,d24700ff-dc15-4f52-8faa-ab74f7d65ae3,playbook,Detonate File - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,25,ecff99fe-b6cf-4306-8609-9ca00a5dcc8f,playbook,Entity Enrichment - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,26,87a23c95-84b5-4343-8a01-d70c6f97702a,playbook,Process Email - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,27,1b402b79-641b-4ac1-8124-80e939ae3bd4,title,Remediate,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,28,2f89f21c-0088-460a-81b2-b0c3f021b89c,playbook,Search And Delete Emails - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,29,8f9afe19-c4b2-4f86-8544-4fee8d8455d1,title,Done,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,30,50789baf-1476-467a-8386-0be463a4a460,title,Malicious,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,31,7d784d78-4fc1-4465-8a32-4c13aff74e60,title,Undetermined,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,33,6f2e21d2-2a93-433e-81f5-3c9abd359e95,condition,Is the email malicious?,Is the email that the user reported malicious?,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,34,536ca1cd-adbe-4db2-89c1-318be024fc3e,regular,Manually remediate  the incident,"Consider the following:
1. Search for and delete similar emails
2. Inform the organization about the threat
3. Hunt the relevant IOCs
4. Update proxies and firewalls as necessary
5. Block the malicious sender/ domain in the mail-gateway ",,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,35,cd577642-8baf-4aba-87d9-29f0366aa173,playbook,Extract Indicators From File - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,36,eebcf7b0-41c8-4185-8fad-977de983ab65,condition,"Execute the ""Search and Delete"" sub-playbook?","Verify that the ""Search and Delete"" parameter is set to ""True""?",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.SearchAndDelete', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.SearchAndDelete'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,37,f6b138df-f341-4cc0-8b9a-7f4ba4a06c71,condition,"Execute the ""Block Indicators"" sub-playbook?","Verify that the ""Block indicators"" parameter is set to ""True""?",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,38,cfb76a8d-e926-41a3-8036-6d4d54abf96d,playbook,Block Indicators - Generic,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,39,5ff2d707-a036-4db0-8851-ed3ec61802db,title,Start Detection Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,40,83e23120-b009-4565-8ab7-880b247aee16,title,Stop Detection Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,41,88612884-d640-4dd1-85f4-0daa684ecf99,title,Stop Detection Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,42,b7d4e2cb-4d75-4c0d-8d87-732af590173e,title,Start Remediation Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,43,f863f789-c46a-44e2-8d8b-02174df5010b,title,Stop Remediation Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,0,32d25ab2-8fa5-46cd-82df-78dc402c0150,start,,,,,,,,
0,2,762b1bb7-43ba-455a-8b71-ccc7e58ab8f5,regular,Assign to analyst,Assign the incident to an analyst based on the analyst's organizational role.,,,,,,
0,6,5882f2a4-7949-4121-8dc6-09a44bc78a48,playbook,,,,,,,,
0,7,26ed9557-a1c3-433a-8614-94e6c671d9af,regular,Manually review the incident,Review the incident to determine if the email that the user reported is malicious.,,,,,,
0,8,ea1e91fd-530c-4f2e-859a-4a4bc3b321de,regular,Close investigation,Close the investigation.,,,,,,
0,11,6b039cde-c519-4ad2-83b7-17dbefb01c7b,title,Triage,,,,,,,
0,12,36ce6034-d509-405b-8e8d-4bef662e0709,regular,Store the email address of the reporting user,Store the email address of the user that reported the incident.,,,,,,
0,13,0bc7759d-f3bb-48f7-89cc-548cd6e63779,regular,Acknowledge incident was received,"Send an auto-response to user that reported the incident, informing them the incident was received and being handled.
",,,,,,
0,14,849b0463-ea4a-4860-86b5-825e5cda8a08,playbook,Email Address Enrichment - Generic,,,,,,,
0,15,f3ddd9af-36b1-44fb-8eaf-1a71be6b34fb,condition,Is the email malicious?,Determine if the email is malicious based on the calculated severity.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,16,9fff2dfd-443c-4b97-8db1-22ff69f8360b,regular,Update  the user that the reported email is safe,Send an email to the user explaining that the email they reported is safe.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,17,c0fd6e60-203b-4039-89f9-d34f4024d349,regular,Update  the user that the reported email is malicious,Send an email to the user explaining that the email they reported is malicious.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,18,916bc6c8-6d46-4f04-8bd2-1152736b7984,title,Engage with User,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,22,ca065734-ff0b-4d84-8bfe-a93298bd34ab,playbook,Detonate File - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,25,fb79a97c-7e8d-4004-8a89-4297f9d0a9cf,playbook,Entity Enrichment - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,26,2cf1ade0-ab88-4dfd-819e-c134627edaf7,playbook,Process Email - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,27,d73d68a4-dff2-4cae-8645-972f9c328444,title,Remediate,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,28,6cc94de8-1f6c-4832-805b-43ec888fcf1b,playbook,Search And Delete Emails - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,29,e9a74030-baa8-43f9-8c35-54f8ae2d6b7b,title,Done,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,30,824c86e1-14a5-42cf-8516-e5f893558f09,title,Malicious,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,31,717e858d-5696-441b-8ff2-30f798cea618,title,Undetermined,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,33,1787361d-c8b7-4c66-89ac-9f90d340358b,condition,Is the email malicious?,Is the email that the user reported malicious?,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,34,4533b6d8-c08d-42c2-805a-e540762472fb,regular,Manually remediate  the incident,"Consider the following:
1. Search for and delete similar emails
2. Inform the organization about the threat
3. Hunt the relevant IOCs
4. Update proxies and firewalls as necessary
5. Block the malicious sender/ domain in the mail-gateway ",,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,35,524a2856-34ef-4752-862d-90daa98875ee,playbook,Extract Indicators From File - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,0,2294dbde-b75d-4632-8ca6-4ec42e2e7be9,start,,,,,,,,
0,2,dbc25dac-cf89-4d90-8ad4-94fac8d10b46,regular,Choose analyst,,,,,,,
0,6,10a9ba52-86fa-4604-8dea-1fa7045fd3f2,playbook,,,,,,,,
0,7,be3a4087-bfd2-4975-8549-5c631a0cfb6c,regular,Manually review the incident,,,,,,,
0,8,57fa5f68-9202-477a-81a7-ca2cf3e8d3e9,regular,Close investigation,,,,,,,
0,11,e723af07-00ee-4243-89ba-92f71164bc2f,title,Triage,,,,,,,
0,12,18628020-bfee-4826-8fd7-624d48981319,regular,Store the sending account,Store the sending account email address for further use,,,,,,
0,13,e34f4190-0c4e-4a70-8a7e-e2fa29177b84,regular,Auto-respond to acknowledge receipt,"Send an auto-response to the target telling them we are on it
",,,,,,
0,14,ab2a151b-758d-4581-84aa-4b5af80b681d,playbook,Email Address Enrichment - Generic,,,,,,,
0,15,407fc02c-9465-4a2e-84bf-b9d8b78b7b67,condition,Auto-respond to user based on incident severity,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,16,b8020e76-f23b-47ff-8bca-ab2726ec57eb,regular,Send email to user - email you reported is safe,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,17,dc6d53be-322c-42ef-86b3-43674b9dc3d8,regular,Send email to user - email you reported is malicious,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,18,9c7c8122-f72d-4410-8bc3-1cc1a64ddee6,title,Engage with User,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,19,c398e131-67cd-447e-8e8b-feb09501d5a4,playbook,Process Email - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,20,9ade9816-a5c9-4f6b-8252-351173d62086,playbook,Extract Indicators - Generic,Extract indicators from input data,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,21,d1d783fb-9d1d-4d5c-81ff-59866dfd2b4c,playbook,Entity Enrichment - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,22,42221d7f-3dda-45bd-80dd-ecebe1130872,playbook,Detonate File - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'number.greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,0,32d25ab2-8fa5-46cd-82df-78dc402c0150,start,,,,,,,,
0,2,17b50e98-fd3e-4410-80c7-a6095629096c,regular,Assign to analyst,Assign the incident to an analyst based on the analyst's organizational role.,,,,,,
0,6,5882f2a4-7949-4121-8dc6-09a44bc78a48,playbook,,,,,,,,
0,7,96f4ce72-93d9-45b9-8831-0cbda3396066,regular,Manually review the incident,Review the incident to determine if the email that the user reported is malicious.,,,,,,
0,8,0cead84c-7626-4cc0-839f-d1b8d5260b9c,regular,Close investigation,Close the investigation.,,,,,,
0,11,6b039cde-c519-4ad2-83b7-17dbefb01c7b,title,Triage,,,,,,,
0,12,40a1c30b-92a4-41fc-84f3-c8474693f931,regular,Store the email address of the reporting user,Store the email address of the user that reported the incident.,,,,,,
0,13,4aafb18b-b981-470e-864c-5caedb033ce0,regular,Acknowledge incident was received,"Send an auto-response to user that reported the incident, informing them the incident was received and being handled.
",,,,,,
0,14,849b0463-ea4a-4860-86b5-825e5cda8a08,playbook,Email Address Enrichment - Generic,,,,,,,
0,15,f3ddd9af-36b1-44fb-8eaf-1a71be6b34fb,condition,Is the email malicious?,Determine if the email is malicious based on the calculated severity.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,16,79084bbf-1187-4b31-82f2-8b153a093a49,regular,Update  the user that the reported email is safe,Send an email to the user explaining that the email they reported is safe.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,17,f7788586-5020-4246-8946-2021c76dc722,regular,Update  the user that the reported email is malicious,Send an email to the user explaining that the email they reported is malicious.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,18,916bc6c8-6d46-4f04-8bd2-1152736b7984,title,Engage with User,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,22,ca065734-ff0b-4d84-8bfe-a93298bd34ab,playbook,Detonate File - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,25,fb79a97c-7e8d-4004-8a89-4297f9d0a9cf,playbook,Entity Enrichment - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,26,2cf1ade0-ab88-4dfd-819e-c134627edaf7,playbook,Process Email - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,27,d73d68a4-dff2-4cae-8645-972f9c328444,title,Remediate,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,28,6cc94de8-1f6c-4832-805b-43ec888fcf1b,playbook,Search And Delete Emails - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,29,e9a74030-baa8-43f9-8c35-54f8ae2d6b7b,title,Done,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,30,824c86e1-14a5-42cf-8516-e5f893558f09,title,Malicious,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,31,717e858d-5696-441b-8ff2-30f798cea618,title,Undetermined,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,33,f59a91ed-b686-4133-8f23-13338cff2d6e,condition,Is the email malicious?,Is the email that the user reported malicious?,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,34,17f0be59-6aff-4f12-829a-395597295427,regular,Manually remediate  the incident,"Consider the following:
1. Search for and delete similar emails
2. Inform the organization about the threat
3. Hunt the relevant IOCs
4. Update proxies and firewalls as necessary
5. Block the malicious sender/ domain in the mail-gateway ",,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,35,524a2856-34ef-4752-862d-90daa98875ee,playbook,Extract Indicators From File - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,36,9aff5a75-b7eb-410a-8751-6cc749dc9df5,condition,"Execute the ""Search and Delete"" sub-playbook?","Verify that the ""Search and Delete"" parameter is set to ""True""?",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.SearchAndDelete', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.SearchAndDelete'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,37,8277280f-0c19-4d99-85c9-39e19f60bc0d,condition,"Execute the ""Block Indicators"" sub-playbook?","Verify that the ""Block indicators"" parameter is set to ""True""?",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,38,2198ea9b-926d-4f25-829e-39c390771dfb,playbook,Block Indicators - Generic,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,0,44927568-9dcf-4acb-84c2-1466eb224729,start,,,,,,,,
0,2,c4e87e26-a8fc-473a-8f84-e63335a552e8,regular,Assign to analyst,Assign the incident to an analyst based on the analyst's organizational role.,,,,,,
0,6,c3cd10bc-d79e-4471-8b28-82613ac05418,playbook,,,,,,,,
0,7,89d7dd49-06a3-4397-8b72-f4428bf24805,regular,Manually review the incident,Review the incident to determine if the email that the user reported is malicious.,,,,,,
0,8,104d08e2-78ad-496f-81f6-f3ebe77f3b5a,regular,Close investigation,Close the investigation.,,,,,,
0,11,f90db644-38c8-4d31-840c-4b5b16069a33,title,Triage,,,,,,,
0,12,1a99d7e1-2c84-4d57-80be-0ec42482d952,regular,Store the email address of the reporting user,Store the email address of the user that reported the incident.,,,,,,
0,13,0f0f8a66-8f89-43fe-8e23-33d1d476c175,regular,Acknowledge incident was received,"Send an auto-response to user that reported the incident, informing them the incident was received and being handled.
",,,,,,
0,15,bd6e25bf-75cc-41b0-8f27-12b96b0f5ca4,condition,Is the email malicious?,Determine if the email is malicious based on the calculated severity.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,16,ac0d8fe7-8ec0-49b8-8947-75d3bb87437c,regular,Update  the user that the reported email is safe,Send an email to the user explaining that the email they reported is safe.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,17,3616a344-7c58-4ac0-86fe-bad84f58c2e2,regular,Update  the user that the reported email is malicious,Send an email to the user explaining that the email they reported is malicious.,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,18,a4de0c33-52a7-42d9-8e4d-1a753a62d20e,title,Engage With User,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,22,d24700ff-dc15-4f52-8faa-ab74f7d65ae3,playbook,Detonate File - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,26,87a23c95-84b5-4343-8a01-d70c6f97702a,playbook,Process Email - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,27,1b402b79-641b-4ac1-8124-80e939ae3bd4,title,Remediate,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,28,2f89f21c-0088-460a-81b2-b0c3f021b89c,playbook,Search And Delete Emails - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,29,8f9afe19-c4b2-4f86-8544-4fee8d8455d1,title,Done,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,30,50789baf-1476-467a-8386-0be463a4a460,title,Malicious,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,31,7d784d78-4fc1-4465-8a32-4c13aff74e60,title,Undetermined,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,33,6f2e21d2-2a93-433e-81f5-3c9abd359e95,condition,Is the email malicious?,Is the email that the user reported malicious?,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,34,536ca1cd-adbe-4db2-89c1-318be024fc3e,regular,Manually remediate  the incident,"Consider the following:
1. Search for and delete similar emails
2. Inform the organization about the threat
3. Hunt the relevant IOCs
4. Update proxies and firewalls as necessary
5. Block the malicious sender/ domain in the mail-gateway ",,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,35,cd577642-8baf-4aba-87d9-29f0366aa173,playbook,Extract Indicators From File - Generic,,,,,,,"{'label': 'Malicious ', 'condition': [[{'operator': 'greaterThanOrEqual', 'left': {'value': {'simple': 'incident.severity'}, 'iscontext': True}, 'right': {'value': {'simple': '2'}}}]]}"
0,36,eebcf7b0-41c8-4185-8fad-977de983ab65,condition,"Execute the ""Search and Delete"" sub-playbook?","Verify that the ""Search and Delete"" parameter is set to ""True""?",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.SearchAndDelete', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.SearchAndDelete'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,37,f6b138df-f341-4cc0-8b9a-7f4ba4a06c71,condition,"Execute the ""Block Indicators"" sub-playbook?","Verify that the ""Block indicators"" parameter is set to ""True""?",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,38,cfb76a8d-e926-41a3-8036-6d4d54abf96d,playbook,Block Indicators - Generic,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,39,5ff2d707-a036-4db0-8851-ed3ec61802db,title,Start Detection Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,40,83e23120-b009-4565-8ab7-880b247aee16,title,Stop Detection Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,41,88612884-d640-4dd1-85f4-0daa684ecf99,title,Stop Detection Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,42,b7d4e2cb-4d75-4c0d-8d87-732af590173e,title,Start Remediation Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,43,f863f789-c46a-44e2-8d8b-02174df5010b,title,Stop Remediation Timer,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,45,c8a03d03-5ffc-43db-88c0-c4d0e562e2c2,playbook,Email Address Enrichment - Generic v2,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,46,4ca9db3c-7a8c-46fc-8a7f-9a73e61fa542,playbook,Entity Enrichment - Phishing v2,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'inputs.BlockIndicators', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.BlockIndicators'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}}, 'iscontext': True}}]]}"
0,0,6def49b7-29f8-4905-8db0-6448936126ad,start,,,,,,,,
0,1,ab28c63c-ea49-480e-858b-c6537c5f11c0,regular,Populate indicators,Populate indicators by the PhishLabs IOC  global feed.,,,,,,
0,2,58403bf5-5825-4058-8c42-6cbfdb6caac2,regular,Close investigation,Close the current incident.,,,,,,
0,3,bf18488a-3da2-4074-84f4-71d023dbb313,condition,Is PhishLabs IOC enabled?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'PhishLabs IOC'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,4682a8db-5f39-4d30-8385-3b1ead5d338b,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'PhishLabs IOC'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,6def49b7-29f8-4905-8db0-6448936126ad,start,,,,,,,,
0,1,5bf410a0-bb6f-4278-80a9-aaf0e6122344,regular,Whitelist false positives,Populate indicators by the PhishLabs IOC global feed.,,,,,,
0,2,58403bf5-5825-4058-8c42-6cbfdb6caac2,regular,Close investigation,Close the current incident.,,,,,,
0,3,bf18488a-3da2-4074-84f4-71d023dbb313,condition,Is PhishLabs IOC enabled?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'PhishLabs IOC'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,4682a8db-5f39-4d30-8385-3b1ead5d338b,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'PhishLabs IOC'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,ccd00127-175c-4a93-8edb-14e71f7d47ea,start,,,,,,,,
0,1,0a3b6760-ffc7-4a5f-8042-47e9a15402ee,condition,Do we have original emails attached?,Check if we have any attachments with relevant attachment types like eml or rfc822,,,,,,
0,2,3ad45b93-5373-4303-8a74-fcaeba4c3344,regular,Add original email details to context,,,,,,,
0,3,b7f50774-0497-4821-8910-02df73f2c91d,regular,Add original email attachments to context,,,,,,,
0,0,7c0a6113-ccc4-4b67-8ae0-5b6ebed288fb,start,,,,,,,,
0,1,51c33209-bc37-4492-87cf-8fcccf9b5dec,condition,"Does an ""Email Subject"" custom field exist?",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailsubject'}}, 'iscontext': True}}]]}"
0,2,2115cdff-522d-4787-822c-39684be05294,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailsubject'}}, 'iscontext': True}}]]}"
0,3,0c93975e-3aef-49f0-8c4e-ca0e5b837898,regular,"Set ""Email Subject""",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailsubject'}}, 'iscontext': True}}]]}"
0,5,48cda3ef-9cf7-444e-87ac-8cc1e6302f2a,condition,"Does a ""CC"" custom field exist?",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailcc'}}, 'iscontext': True}}]]}"
0,7,4a357b97-fd01-4da9-87dc-d1795652ce12,condition,"Does a ""To:"" custom field exist?",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailto'}}, 'iscontext': True}}]]}"
0,8,fa753dda-6035-42bb-8d90-18af31bd895a,regular,"Set ""To""",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailto'}}, 'iscontext': True}}]]}"
0,9,ec368e0b-8b64-49c3-8b8c-af1d7a773ad4,regular,"Set ""CC""",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailto'}}, 'iscontext': True}}]]}"
0,10,3959ccdf-067d-43ea-807d-71d3635e3978,condition,"Does a ""From:"" custom field exist?",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailfrom'}}, 'iscontext': True}}]]}"
0,11,f6b002e9-c9fe-43e6-8319-669a6697a7c6,regular,"Set ""From""",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailfrom'}}, 'iscontext': True}}]]}"
0,12,198613e7-6e07-4bd2-8085-7cda8c281351,condition,"Does a ""Body HTML"" custom field exist?",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailbodyhtml'}}, 'iscontext': True}}]]}"
0,13,4ca85e8d-5140-4bc6-8ed3-07cddb3c1eb1,regular,"Set ""Body HTML""",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailbodyhtml'}}, 'iscontext': True}}]]}"
0,14,04f3e7dd-bd46-4116-8cac-89670de53cba,condition,"Does a ""Body"" custom field exist?",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailbody'}}, 'iscontext': True}}]]}"
0,15,8712254a-0732-41a4-813a-504bc8def0e4,regular,"Set ""Body""",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailbody'}}, 'iscontext': True}}]]}"
0,16,2d95654e-96a8-4b29-8d0e-9c1bcbbfe884,condition,"Does a ""Body Format"" custom field exist?",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailbodyformat'}}, 'iscontext': True}}]]}"
0,17,db38aa5c-6c21-48b1-8289-eaabee90a7b4,regular,"Set ""Body Format""",,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'incident', 'accessor': 'emailbodyformat'}}, 'iscontext': True}}]]}"
0,0,d2585d98-8b18-443c-8f9d-fab76927940f,start,,,,,,,,
0,1,4c421b2d-b73c-42a3-8e74-c9fa804196b9,regular,Get attachments,"Get EWS email all attachments - file attachments and item attachments (other email, calendar item, etc..)",,,,,,
0,2,4e29788b-f10f-4afd-843d-954dc75bcd00,condition,"Does the item ""attachments"" exist?",Check if any item attachments exist.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'EWS.Items.ItemAttachments'}, 'iscontext': True}}]]}"
0,3,86c8a1a4-96d2-4d5b-8d24-7710318ac280,regular,Set email context key,If email attachments exist - set Email context key with the item values.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'EWS.Items.ItemAttachments'}, 'iscontext': True}}]]}"
0,5,16491843-3256-4f45-8615-a8ea30e68228,condition,Is this an EWSv2 incident?,Check if EWSv2 exist,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'EWS v2'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,14,18a0ed04-37fb-4af0-8b23-ef5468460755,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'EWS v2'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,ccd00127-175c-4a93-8edb-14e71f7d47ea,start,,,,,,,,
0,1,70863b9a-af3f-4f0a-8e91-cae2c88f5488,condition,Do we have original emails attached?,Check if we have any attachments with relevant attachment types like eml or rfc822,,,,,,
0,2,0dd910be-f198-4b5d-8dbb-8d7170049463,regular,Add original email details to context,,,,,,,
0,3,4ac2b332-b76d-463e-824e-717895c5b644,regular,Add original email attachments to context,Parses an email from an EML or MSG file and populates all relevant context data to investigate the email. Also extracts indicators from the email messages.,,,,,,
0,4,d6f90ffe-1111-447a-8755-65189ec1f6d5,condition,Is there an HTML label in the email?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}], [{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'Email.HTML'}, 'iscontext': True}}]]}"
0,5,3a4baebb-0463-442c-8971-3f681d240366,regular,Render HTML to an image,,,email_html_image,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}], [{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'Email.HTML'}, 'iscontext': True}}]]}"
0,6,dd0d5106-965e-4a81-8e67-79392ea47d7f,title,Done,,,email_html_image,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}], [{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'Email.HTML'}, 'iscontext': True}}]]}"
0,11,104966c4-8595-4a5a-8c75-c84f55e51c84,title,Advance features,,,email_html_image,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}], [{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'Email.HTML'}, 'iscontext': True}}]]}"
0,13,9d6defc4-5ef1-4523-8136-08372aa15544,regular,Set incident with the Email object data,Updates Demisto incident fields using data from the email object. Also extracts indicators from the email message.,,email_html_image,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}], [{'operator': 'isNotEmpty', 'left': {'value': {'simple': 'Email.HTML'}, 'iscontext': True}}]]}"
0,16,bc0dd5a2-6073-4f44-8abc-9bc48e3e08c1,condition,Should retrieve the original email?,"If True, retrieve the original email in the thread",,email_html_image,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.GetOriginalEmail'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,17,e6915e5d-bdca-4d59-8636-2e65b2e680e1,playbook,Get Original Email - Generic,"Use this playbook to retrieve the original email in the thread, including headers and attahcments, when the reporting user forwarded the original email not as an attachment.

You must have the necessary permissions in your email service to execute global search.

- EWS: eDiscovery
- Gmail: Google Apps Domain-Wide Delegation of Authority",,email_html_image,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'inputs.GetOriginalEmail'}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,18,9a505e0b-27c1-424a-880a-253135d80683,condition,Was the original email retrieved?,Is there an email object in the context?,,email_html_image,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'Email'}, 'iscontext': True}}]]}"
0,19,040c1852-c639-4322-80d0-e10d0dfc9b09,regular,Set incident with the Email object data,Updates Demisto incident fields using data from the email object.,,email_html_image,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'Email'}, 'iscontext': True}}]]}"
0,0,ccd00127-175c-4a93-8edb-14e71f7d47ea,start,,,,,,,,
0,1,cc8169d1-5e52-455d-8860-023d5a7cf70b,condition,Do we have original emails attached?,Check if we have any attachments with relevant attachment types like eml or rfc822,,,,,,
0,2,0dd910be-f198-4b5d-8dbb-8d7170049463,regular,Add original email details to context,,,,,,,
0,3,bd9c830c-abc5-4e0e-878f-e77493c6e92d,regular,Add original email attachments to context,,,,,,,
0,4,be6f6daf-0497-423e-8a48-d669ccad567f,condition,Is there an HTML label in the email?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}]]}"
0,5,0c8947d2-ede9-41d6-862d-1aba4611a826,regular,Render HTML to an image,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}]]}"
0,6,dd0d5106-965e-4a81-8e67-79392ea47d7f,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}]]}"
0,0,ccd00127-175c-4a93-8edb-14e71f7d47ea,start,,,,,,,,
0,1,70863b9a-af3f-4f0a-8e91-cae2c88f5488,condition,Do we have original emails attached?,Check if we have any attachments with relevant attachment types like eml or rfc822,,,,,,
0,2,0dd910be-f198-4b5d-8dbb-8d7170049463,regular,Add original email details to context,,,,,,,
0,3,4ac2b332-b76d-463e-824e-717895c5b644,regular,Add original email attachments to context,,,,,,,
0,4,be6f6daf-0497-423e-8a48-d669ccad567f,condition,Is there an HTML label in the email?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}]]}"
0,5,2373f9de-c13d-42ca-84be-8735743156e6,regular,Render HTML to an image,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}]]}"
0,6,dd0d5106-965e-4a81-8e67-79392ea47d7f,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}]]}"
0,11,104966c4-8595-4a5a-8c75-c84f55e51c84,title,Advance features,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}]]}"
0,13,42e12a9b-7195-44bc-8606-fce3495e3b04,regular,Set incident with the Email object data,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}]]}"
0,14,89a7a856-46ff-46f6-8f1c-b2f772c12881,regular,Set HTML Image custom field,Set the base64 of the rendered image to the custom field and the Summary page,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Email', 'accessor': 'HTML'}}, 'iscontext': True}}]]}"
0,15,50661f40-4640-4b90-8f01-8143cec44c79,condition,Is there a base64 encoding for the rendered image?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'Base64.encoded'}, 'iscontext': True}}]]}"
0,0,230a5fa5-ffb2-4d27-857f-647083ec27dc,start,,Start of playbook,,,,,,
0,1,c8436b25-99f9-46ec-8fe6-cc601675c5f3,regular,qradar-searches,Creates a search in QRadar using the search query,,,,,,
0,2,4dd0f61d-1391-47c3-8a9d-b5580671f092,regular,qradar-get-search,Gets search object to initialize polling playbook,,,,,,
0,3,af4d3d48-5707-4522-8fef-a6d3b393eab4,playbook,GenericPolling,Generic polling of qradar-get-search,,,,,,
0,4,6eefed42-f1f6-46d7-83b0-ecb2e47575f9,regular,qradar-get-search-results,executes qradar-get-search-results to get the search results,,,,,,
0,5,172877e1-d636-4b2a-8b3e-70dddf7ea585,title,Done,Playbook is done,,,,,,
0,6,7c323154-9752-4e8d-8e18-7d43fef89edf,condition,Is search completed?,Checks whether the search is completed,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'QRadar.Search.Status'}, 'iscontext': True}, 'right': {'value': {'simple': 'COMPLETED'}}}]]}"
0,0,608f0ec1-4001-4e68-8ead-e160f7802b35,start,,,,,,,,
0,1,e403a36f-c0fd-4ef0-8ec7-8a6683a5b0a5,condition,Is this a QRadar offense?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'QRadar'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,2,edc69a27-88bc-4edb-8fca-8a111d2b6785,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'QRadar'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,3,bbe06f8f-78a7-4de5-81ff-ff16aa98f5b6,regular,Get Offense correlations,Query QRadar for the offense correlations using the QRadar API,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'QRadar'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,324f9756-1ddb-4d58-8d45-26f892ba6759,regular,Get correlations' logs,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'QRadar'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,5,d05103bc-af8a-4d0b-80e2-a1637c45aa9c,title,Get offense information,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'QRadar'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,8dfe1ea9-0c27-4ff9-8892-ae66f014ec4b,condition,Should query for the correlations' logs?,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.GetCorrelationLogs'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,0,efaa120a-35d6-437c-8ac7-0ece067386c6,start,,,,,,,,
0,1,12b7da80-4881-428c-8d37-f513dadd6480,condition,Is this a QRadar offense?,,,,,,,
0,2,79031f54-97bb-4a27-84d1-665f762c3428,title,Done,,,,,,,
0,3,777beed6-580b-4cc6-82c6-1a23309d8313,regular,Get Offense correlations,,,,,,,
0,4,09959beb-a116-4202-8bd1-8388eac3d3b3,regular,Get correlations' logs,,,,,,,
0,5,449b51e7-fde6-49a9-8cc3-6231bcc7c358,title,Get offense information,,,,,,,
0,6,2e19a41a-872f-40ca-840d-af419b4ea32d,condition,Should query for the correlations' logs?,,,,,,,
0,0,6976d00a-5e1b-4a32-8f85-9c79656f82bc,start,start_task,,,,,,,
0,1,f61f3880-e5f6-4a41-8af8-3349e3ebffff,title,Engage,,,,,,,
0,3,d69a6289-b692-404c-8f90-d37d72aa265c,regular,Notify management chain,Notify appropriate people inside the organization. ,,,,,,
0,4,21cb9178-78a0-4610-801f-3bc5f808e4a2,regular,Initial triage,"1. Make sure that there is relevant information in the incident - system name, end user name and initial severity as reported.",,,,,,
0,5,cd85115e-4379-4319-853b-f518e9aa98bc,regular,Assess severity,"Based on the end user affected, and other information assess and change the severity if needed. ",,,,,,
0,6,8135a8aa-6d2c-4cf1-80c4-c5cf4bf136a8,regular,Assign and involve appropriate personnel,Invite the relevant users for investigation - malware expert and network experts if needed. ,,,,,,
0,7,744fdee2-aae7-4a50-8197-9e871d0661da,title,Investigation Step 1: Details for this incident,,,,,,,
0,8,e882cafd-1c86-4443-8ea8-e873d3552a0f,regular,Notify IT about the end user details for replacing device,"1. Notify IT with end user details to replace device. 
2. Hopefully there is back for end user data to be restored.",,,,,,
0,9,9bdc27f9-07d9-4d9a-83f4-f1cebfd918c5,condition,Is the incident reported by end user or an alert from SIEM (or another security product)?,,,,,,,
0,10,2438c513-4f3c-4c5a-8c2d-33fdee1b0ff0,condition,Is the incident real or a false positive?,"1. If a URL was flagged from the proxy logs or IDS or SIEM, check why: check for URL and IP reputation against threat feeds.
 2. If the alert came in from a file check (mail server or web server) - check file reputation (hash) against threat feeds like Virustotal",,,,,,
0,11,1fe0d3b3-bd1e-415f-84a3-fd57071bf1cd,regular,Mark the incident as false positive in SIEM,,,,,,,
0,12,f213bfb8-2e8d-462a-8430-ffa8afe8049c,regular,Close the issue in the incident management system,Use /investigation_close command to close the investigation.,,,,,,
0,13,43ec8c44-5322-4cae-87f8-b4bbffb38fc0,regular,Identify the affected endpoint and user,"1. Get the source IP address from the alert and add it to investigation.
2. Get the user associated with this system from domain controller and AD ",,,,,,
0,14,732dad95-6ba7-4475-8fdb-4835137f7947,regular,Inform user about Ransomeware,Call user and notify them about the incident details. ,,,,,,
0,15,862a44d2-5599-4282-883f-de1d9e1d063c,regular,Execute local containment,Ask the user to disconnect the system from network - turn wifi off if needed. ,,,,,,
0,16,794e5301-9904-4b42-8ad4-9f251c794781,regular,Document user details in investigation,"Take the following details from the end-user and register them into the ticket:
 1. Name of employee
 2. Contact details
 3. Computer name
 4. IP address

 Is the user aware he/she clicked on a suspicious link or attachment lately?",,,,,,
0,17,e08042d0-b8a1-4220-8e6e-2d0a6895bd96,regular,Collect relevant details about incident,"1. Did a window pop up with demanding a ransom?
 2. Has a text file with the instructions been placed on the Desktop?
 3. Have the file extensions been changed to .abc, .xxx or similar?
 4. Are the files unavailable?
 5. Is the user aware he/she clicked on a suspicious link or attachment lately?",,,,,,
0,18,b47fff38-a785-41d6-8049-db1ae21226fa,regular,Execute initial containment,"Ask the user to disconnect the device from the network. If the user connects to the network with a wifi, he/she must turn it off.",,,,,,
0,19,efecb59f-31c6-4416-8e3a-a00e9deafc0f,title,Investigation Step 2: Identify Source of Infection,,,,,,,
0,20,478d2a8f-2138-4b64-8555-54b3d1acfd75,regular,Option 1: Investigate whether the ransomeware has been delivered by email,,,,,,,
0,21,9a551e7e-0816-499f-8cfa-86d6584ea7f1,regular,Analyze email logs to narrow down suspicious emails,1. Go to the SIEM 2. Filter on the email logs associated with the user from the last 3 days 3. Filter again on emails where the recipient was the victim 4. Remove email logs where the sender was from within your company. 5. Export the list of emails into a CSV file. It should only contain emails sent to the victim from the Internet within the last 3 days.,,,,,,
0,22,cef1ed6a-c8e3-4b06-8ca4-4fcd15bbf067,regular,Collect and analyze suspicious emails,"1. Send the CSV file to IT Team and ask them to retrieve the full emails from the user’s inbox. Attach the cvs to the investigation as evidence.
2. Once you get the emails in a zip file, go through them to identify suspicious links or attachments.
3. Look for links that does not point to the same URL displayed on the screen (e.g. <a href=”http://malware.com”>http://www.bbc.co.uk</a>)
4. Check the domain in the ‘From:’ field correspond to the topic of the email (e.g. package delivery notification emails from UPS will not come from john@mypersonalblog.com)
5. Scan suspicious URLs as necessary with threat feeds like Virustotal, http://www.phishtank.com. If you identify suspicious URL analyze in depth in next steps. 
",,,,,,
0,23,170848e4-7295-4ebf-8e7a-0c02403a710f,regular,Analyze suspicious URLs and files collected from emails (malware playbook),"1. If you identify a suspicious URL, Download the malicious file with ‘curl’
2. Check reputation of file using virustotal and other threat feeds. 
3. Do a static and dynamic analysis of files using sandbox or SIFT workstation. 
4. If you find suspicious file, then upload to VT or other AV vendors.
",,,,,,
0,24,71148252-7dfa-442c-8d28-20cb54927a29,regular,Option 2: Investigate whether the victim’s PC has been infected by an exploit kit/drive-by download,,,,,,,
0,25,a4bc2ab7-98b8-493a-8bc2-b06430cf849e,regular,Analyze web proxy (or web gateway) logs to find suspicious URL,"1. Go to the SIEM
 2. Filter on the proxy logs from the last 3 days
 3. Filter on the username of the affected user (all users should be authenticated to the proxy)
 4. Filter out URLs that has been categorised, you should only have uncategorized URLs on your list.
 5. Export list to CSV
 6. Sort the list by URLs, remove duplicates
 7. Make sure this is attached as artifact to the investigation",,,,,,
0,26,7c9242cc-71a0-4e72-821d-226ffd2c8921,regular,Analyze the URLs from previous task for malicious URL,"1. Check Reputation of all the collected URL against threat feeds like virustotal
 2.. Search for suspicious URLs, such as:
 IP address in the URL
 Random characters in the hostname of the URL (e.g. http://asdheguhadaasd.com)
 URL contains lots of random letters and/or numbers
 WordPress sites are involved (wp-content …)
 3. Search for requests to Tor2Web (e.g. https://3fdzgtam4qk625n6.fi/)
 4. Weird User-Agent strings, such as
 IE6 (e.g. Mozilla/5.0 (compatible; MSIE 6.0; Windows NT 5.1))
 Programmatic libraries (e.g. python-requests/1.2.0)
 dJava (e.g. Java/1.6.0_13)",,,,,,
0,27,e37b3eef-ac20-4ee6-8d71-5edb5a62ee29,regular,Analyze the URL in a sandbox,"Consider deeper analysis of the URL using sandbox like Cuckoo. 
Based on the analysis here and the previous step, create the final list of malicious URL.

",,,,,,
0,28,b770133f-1b8d-4b29-8fc2-32ac77a2b1a0,regular,Get file details from web logs for downloaded files,"1. Get the hash for downloaded files. 
2. Check the reputation of files against threat feeds. 

",,,,,,
0,29,9fd3ac5d-71d7-4d85-8715-0a0b489ea248,regular,Go to : Generating IoCs from URLs and Hashes,Take the malicious URL and files from this section and generate IOC using steps in Section: Generating IoCs from URLs and Hashes,,,,,,
0,30,207c8a2d-2ec5-418c-86cf-22fa818c8cb9,title,Generating IoCs for URLs and Hashes,,,,,,,
0,31,9ac4e924-5559-455c-852c-d3a67a0a27a0,regular,Generate IOC for malicious URL from SIEM Threat Feed,"1. Get the list of flagged URLs/hashes from the Investigation Step
2. Check the URL against threat feed (virustotal, IBM Xforce).
3. Check your SIEM for threat feeds and see if there are IOC related to the URLs. 
4. Subscribe to the feed in SIEM. This will install the relevant IoCs into our SIEM automatically.
5. If none of the IoCs are on the TI feed, you need to generate IoCs manually in next step
",,,,,,
0,32,cf6fe0f5-fe53-4ba7-80c7-4d6eaf896d2a,regular,Generate IOC for malicious URL manually,"1. Go to the proxy logs again
2. Find 2-3 properties associated with the flagged URL, such as:
     The request is POST
     The User-Agent field is dodgy (Java, Python, IE6 etc.)
     URL contains more than 128 random characters
     URL contains .php
     URL contains lots of slashes (/)
     URL contains WordPress related things (wp-content)
     URL contains dodgy TLDs (for instance .tk, .ru)

3. Test your assumption on the proxy logs in the SIEM. Use your pattern and check how many false positives and true positives it produces.
4. If the pattern is good enough, append your results to the investigation. 


",,,,,,
0,33,c24a436e-71bb-48e7-89cd-8058fec1d2fb,regular,Generate IOC from phishing emails,"If you find in previous steps that source was phishing email - 

1. Find all the URLs in the email and go through the URL IOC generation steps. 
2. Find all the attachments for the email and analyze the file using file IOC generation steps. 
3. If these steps identify files or URL as malicious - 
     extract sender, sending domain and other properties to find emails. 
     use this data to block future emails.",,,,,,
0,34,a91c4be9-cf1b-40b6-861e-5cd4a620cf96,regular,Deploy the IoCs collected,"1. Deploy a new rule to the SIEM, this will alert new infection attempts in the future
 2. Mark the hashes collected as malicious in the SIEM and import this into IOC databases for your enterprise.
 2. Send the patterns to IT and ask IT to block these URLs on the proxy and web gateway",,,,,,
0,35,dcccd78c-a7c6-4a21-8024-24ec6870c979,title,Identify other affected devices,,,,,,,
0,36,fe9439ce-8a68-45dc-8a4e-71a97d98072f,regular,Identify other systems based on URL and hashes,"1. Go to SIEM and search for the URL pattern from Generating IOC step in the proxy logs in order to identify other computers already affected. 
2. Search for hashes identified in all logs and identify systems associated.
2. If you identify other affected PCs with above two steps, create new incident.

",,,,,,
0,37,e8e246cf-bf4c-47e8-89f5-4f0d1fbf0edb,regular,Create new incident with the affected systems,Create new incidents based on above steps. ,,,,,,
0,38,08e01fbf-47af-4926-8cd1-c359cfc94410,title,Respond,,,,,,,
0,39,5b96fdcb-14af-434b-8c89-ebbb3b344145,regular,Notify affected user,Notify affected user about the outcome of investigation.,,,,,,
0,40,bcc506a2-1413-43d8-8012-8c1d63f35ecc,regular,IOC deployment verification,Make sure that IOC deployment is in place. These are the IOC identified from previous steps. ,,,,,,
0,41,b32992a7-f5e0-4b95-8dd2-5c70e938c715,regular,Remove temporary containment measures,Remove the temporary containment measures that were placed.,,,,,,
0,42,35c0d3b2-d9cd-460c-88be-6d7a229e9906,regular,Provide end-user remediation guidance and link to training,,,,,,,
0,43,f68ec944-041d-4288-80fd-d4593bceb52b,condition,Is the identified malware known? (with automated remediation steps),,,,,,,
0,44,f13d62e8-15a2-4240-8245-9537c0c7aa83,regular,Document manual remediation steps,,,,,,,
0,45,91223da8-3e5b-432e-85d6-b05a8e614f83,regular,Trigger remediation scripts,,,,,,,
0,46,36ba1145-5eb5-4bc4-85f6-d5c9f4495cca,condition,Was remediation successful?,,,,,,,
0,47,c56d39eb-e583-4183-8b18-12e9d0547c17,regular,Reimage the entire system and restore from backup,,,,,,,
0,0,bba2ed1f-ba17-4fcc-81b3-990115ff1608,start,start_task,,,,,,,
0,1,a815b6ec-64bf-4a15-8314-5055c5d6d89d,title,Set up the investigation and acquire IOCs,,,,,,,
0,3,7e822405-36be-4341-857e-bcc4e6b98402,condition,Need to Load data from attached text files?,,,,,,,
0,4,ef989693-4e8e-472e-84bf-bf6566ef1851,regular,Extract hashes from text file,,,,,,,
0,5,43ddbd9e-84f5-42c1-8398-e94851c85cff,regular,Extract IP address from text file,,,,,,,
0,6,c105e3b1-8e9a-40cd-8249-5337e8417b06,title,Hunt,,,,,,,
0,38,37fc767e-b23c-463a-84da-40a94e6b1b6a,regular,Collect Hashes from incident,,,,,,,
0,39,7845e26f-f375-4a41-8720-0d186a052382,regular,Collect IPs from incident,,,,,,,
0,41,5e13d196-7f69-48e0-88d8-e9347d2b0567,regular,Load contents of attached textual files,,,,,,,
0,47,41007d8b-b092-4c62-8bb4-9176b3b8ad62,regular,Collect URLs from incident,,,,,,,
0,48,80ca226e-af97-4a74-818b-5cbc2f74e7e5,regular,Analyst work - hunt manually,,,,,,,
0,49,235f1662-0f0d-45fa-8e3f-18ee2419e1c1,playbook,,,,,,,,
0,0,391dde59-b247-4641-8ef2-24a5c11b6d39,start,,start,,,,,,
0,1,f123b950-46f6-4ffe-8ba5-3e327482cccd,regular,Start scan,Starts a scan for specified asset IP addresses and host names.,,,,,,
0,5,25518fb4-9985-4885-8d24-e3886014b9e3,title,Done,Final task,,,,,,
0,7,bcc7a757-5464-43d9-8b00-756116fae3fa,regular,nexpose-get-scan,Returns the specified scan.,,,,,,
0,8,d8fac3db-f673-4daf-8ad8-a1cb112ddd01,playbook,GenericPolling,Generic Polling Playbook,,,,,,
0,9,6d61b22a-1fbe-4ffe-866a-81b522256c65,condition,Is Nexpose enabled?,Checks wheter nexpose is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,0f6c2fdc-f87f-4397-87a7-bcc7f8a54b50,condition,Is there an ip or host to scan?,Checks whether there's an ip or an host to scan.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.IPs'}, 'iscontext': True}}, {'operator': 'isExists', 'left': {'value': {'simple': 'inputs.HostNames'}, 'iscontext': True}}]]}"
0,11,3b3f273c-1886-489d-83d7-48e1073c9880,condition,Did scan find assets?,Checks whether assets were found,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'Nexpose.Scan.Id'}, 'iscontext': True}}]]}"
0,0,c613b21c-e424-4a21-8151-1c4dc32caa7a,start,,start,,,,,,
0,1,8d8b7598-5fe9-4919-89fb-7aa5e9d66eea,regular,Start scan,Starts a scan for specified asset IP addresses and host names.,,,,,,
0,5,1c704f4c-7f5e-4225-869f-2fa09265d983,title,Done,Final task,,,,,,
0,7,e6b253fc-8cfe-4daa-8439-4e427591a9bd,regular,nexpose-get-scan,Returns the specified scan.,,,,,,
0,8,89b2d088-8a57-4f46-8496-dfcc2528b038,playbook,GenericPolling,Generic Polling Playbook,,,,,,
0,9,b97117e5-6d22-49b4-85f5-4f16ed591271,condition,Is Nexpose enabled?,Checks wether Nexpose is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,18502d56-7120-451e-85be-cee7233edfe1,condition,Did scan find assets?,Checks wether assets were found,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'Nexpose.Scan.Id'}, 'iscontext': True}}]]}"
0,0,4c53eeae-7958-4117-8776-d84f5e018bda,start,,,,,,,,
0,1,e0bc8761-e7dd-41fa-80a6-516440e7218e,regular,Search EWS for similar emails,Search all mailboxes in EWS to identify emails with similar attributes of a malicious email.,,,,,,
0,2,655f4055-484e-4068-8af2-0e4ec6f8de30,title,Build EWS query,,,,,,,
0,9,a11f4022-156a-4441-86f3-70039fac11c5,title,Search all mailboxes in EWS,,,,,,,
0,10,58c8b53f-8817-4aaa-8231-823b45d96671,regular,Build EWS query,Returns an EWS query according to the malicious email's attributes.,,,,,,
0,13,8bdae91c-64f9-4c0d-86f8-7aaf06a4a9d0,title,Delete similar emails,,,,,,,
0,14,c9048666-c30d-4305-8d49-438d141cd770,condition,Should the found emails be deleted from EWS?,"Review the EWS search results and decide whether to delete all of the emails.

Note: You cannot delete a subset of the emails.",,,,,,
0,15,24c2be15-9c43-417e-8623-ff007f5e2c64,title,Done,,,,,,,
0,16,732d5134-ac55-4a8f-8ffb-1a7c618d82d5,regular,Delete emails from EWS,Delete all similar emails from all mailboxes in EWS.,,,,,,
0,17,a34b7b16-4ed8-4c74-8fd9-62ca07a6f6bb,condition,Were similar emails found?,Did the EWS search identify emails similar to the malicious email? ,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'EWS', 'accessor': 'Items.itemId'}}, 'iscontext': True}}]]}"
0,18,a0a62307-da9a-447a-8d5f-8c63ee4b156a,condition,Is EWS v2 enabled?,"Verify that there’s a valid instance of EWS v2 enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'EWS v2'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,808e9cce-8112-49d4-8624-907a6fbeb394,start,,,,,,,,
0,1,f2699240-6fe1-40ae-8da6-8017aabf41ff,playbook,Search And Delete Emails - EWS,This playbook searches EWS to identify and delete emails with similar attributes of a malicious email.,,,,,,
0,2,88c58e53-8fe7-4ca2-8697-0ed3f67191fe,title,Done,,,,,,,
0,0,9b42ebf8-2133-4457-83ed-1d281ed7887f,start,start_task,,,,,,,
0,8,0891cd8c-8331-42ee-80d8-ec78652b7ad2,regular,Search hashes in the file catalog,Searching The file catalog for the hashes,,,,,,
0,9,255f2625-68d4-4475-81a2-663da89a39d6,regular,Check if the hashes are included in any rules,"If the hashes have been approved or blocked in the past, they will be in existing rules. It is useful to see whether the hash was in some blacklist or whitelist or a person marked them as such, possibly with a comment explaining their reasons.",,,,,,
0,10,02afb0d8-e0fd-424d-83c6-44a15204351f,condition,Is Carbon Black Protection enabled?,Is Carbon Black Protection enabled?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'carbonblackprotection'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,11,e5069a6c-2c37-4f0d-8a7b-571fdd1aa9ac,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'carbonblackprotection'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,12,57f5bcda-24a1-4387-8566-94fa8eed1155,condition,Do we have files to hunt?,Do we have files to hunt?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Hash'}}, 'iscontext': True}}]]}"
0,13,0174e70d-e14f-47cc-8c65-0b36c142ae52,regular,Get hostname and workgroup,Get hostname and workgroup,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Hash'}}, 'iscontext': True}}]]}"
0,14,accc2606-97d8-45e7-8382-8fa3a8799240,regular,Get hostname,Get hostname,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Hash'}}, 'iscontext': True}}]]}"
0,15,cecaea78-7661-4243-8f10-3f1a4aa38668,condition,Any endpoints found?,Any endpoints found?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Hash'}}, 'iscontext': True}}]]}"
0,0,edc8b672-13e8-48fa-87c9-594118876ac4,start,,Playbook start point,,,,,,
0,1,ad7dff09-2373-43ba-8a87-645fa98ca5cb,regular,Hunt MD5 Hash,Search Carbon Black for the specified MD5 hash(es),,,,,,
0,2,31e80780-a121-4f17-8c64-2880e9ea0a20,condition,Is Carbon Black enabled?,Is Carbon Black enabled?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'carbonblack'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,3,108ba97d-b9da-4162-808d-025b5f6b7986,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'carbonblack'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,4dc64cf1-acb2-47b5-87c8-88e0e90e6c11,condition,Do we have files to hunt?,Do we have files to hunt?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs', 'accessor': 'Hash'}}, 'iscontext': True}}]]}"
0,5,09e186f8-7d8d-4f32-84f8-5960a2e943af,regular,Set hostname,Set hostname,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs', 'accessor': 'Hash'}}, 'iscontext': True}}]]}"
0,6,a9c71d9b-8bec-42db-8c65-a4d047770eac,condition,Verify found file locations,Verify found file locations,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'found_file_locations'}}, 'iscontext': True}}]]}"
0,0,64d3d099-e3f0-45ae-8898-c4530cf996b9,start,,,,,,,,
0,2,5ad90257-ab46-4ecb-8b1b-668a94bb6522,condition,Are there MD5s to hunt?,Are there MD5s to hunt?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.MD5Hash'}}, 'iscontext': True}}]]}"
0,3,ce042e73-548a-4394-888e-0e36fa98bc92,condition,Are there SHA1s to hunt?,Are there SHA1s to hunt?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA1Hash'}}, 'iscontext': True}}]]}"
0,4,f3cd5ec3-a5d3-41fe-8d5b-3810cf9c8788,condition,Are there SHA256s to hunt?,Are there SHA256s to hunt?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256Hash'}}, 'iscontext': True}}]]}"
0,6,83fcfd0c-232e-415d-8aa5-3a06601c78e1,regular,Hunt for devices running MD5,Returns a list of device IDs on which an indicator ran,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256Hash'}}, 'iscontext': True}}]]}"
0,7,c25bd508-049f-4f6d-882d-f8c69723bbd3,regular,Hunt for devices accessing SHA1,Returns a list of device IDs on which an indicator ran,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256Hash'}}, 'iscontext': True}}]]}"
0,8,9dae770a-ec96-4d85-8af0-92dbd79060ac,regular,Hunt for devices accessing SHA256,Returns a list of device IDs on which an indicator ran,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256Hash'}}, 'iscontext': True}}]]}"
0,9,461f7122-3239-492d-8a80-d4a37a18c645,title,Get device details,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.SHA256Hash'}}, 'iscontext': True}}]]}"
0,14,a4f4efd7-61d9-4103-88e3-036e3f76632b,condition,Found any devices?,Found any devices?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'FalconHostDevices'}}, 'iscontext': True}}]]}"
0,15,0be18d12-04e5-4109-89ff-b8f917d9bc38,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'FalconHostDevices'}}, 'iscontext': True}}]]}"
0,16,1fbb2b6e-5cb6-42b2-8c64-0c6d8f474e9a,condition,Is FalconHost enabled?,Is FalconHost enabled?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'FalconHost'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,17,78d65ffe-90ed-4323-83dd-76ac86842582,title,Hunt for indicators,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'FalconHost'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,18,e51b7b8e-235f-4003-8ce9-0183d5ab8df5,regular,Get device hostnames,Get device hostnames,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'FalconHost'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,c485e19b-c83a-48e4-892c-8bd91e17ced2,start,,,,,,,,
0,5,f4b71101-7ae3-4ce8-87b7-10eeb13c1a79,playbook,Search Endpoints By Hash - CrowdStrike,,,,,,,
0,7,5937d882-8964-48b8-834d-1e6f3d83b189,playbook,Search Endpoints By Hash - Carbon Black Response,,,,,,,
0,8,912e992b-d3bd-4353-8177-5ea207ef2ac6,playbook,Search Endpoints By Hash - Carbon Black Protection,,,,,,,
0,9,9510dbd8-98c3-4611-802f-333acf31875b,title,MD5 Only,,,,,,,
0,10,ce67117f-133a-4da3-84be-14e4a831756a,title,MD5 / SHA1 / SHA256,,,,,,,
0,11,05df1d6e-f77e-4b06-8c62-2750064f5b00,condition,Is MD5 hash?,Is MD5 hash?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs', 'accessor': 'MD5Hash'}}, 'iscontext': True}}]]}"
0,12,f2a05482-2b17-4a09-8813-be48459935c3,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs', 'accessor': 'MD5Hash'}}, 'iscontext': True}}]]}"
0,13,a6785055-98d6-4b2e-8da8-c2e0c6b90887,playbook,Search Endpoints By Hash - TIE,"Hunt for sightings of MD5, SHA1 and/or SHA256 hashes on endpoints, using McAfee TIE (requires ePO as well).

Input:
* Hash (default, takes all deferent hashes from context)

Output:
* All agents that files with ""Hash"" has been executed on (TIE)
* Enrich Agents info from ePO",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs', 'accessor': 'MD5Hash'}}, 'iscontext': True}}]]}"
0,0,80386f11-23d2-4ca7-8e8a-efc6c7d8b797,start,,,,,,,,
0,1,f96c54b2-b8fa-48b8-8a56-56555a749c10,condition,Is TIE enabled?,Is TIE enabled?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'McAfee Threat Intelligence Exchange'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,2,b098fed0-d1ae-418c-8a37-756e1ae0cb37,condition,Is ePO enabled?,Is ePO enabled?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'epo'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,3,26ba9604-ced2-4c35-8e13-075d3ed04042,regular,List all agents that the Hash has been executed on,Get Agent GUIDS for the given hashes,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'epo'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,b000dc4b-e71b-43dc-87d3-da7fbeae2d91,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'epo'}}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,5,c7e628c9-cb07-408a-8667-8f4bb2c6d944,condition,Did we find any relevant agents?,Did we get any Agent GUIDS?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'accessor': 'References.AgentGuid'}}, 'iscontext': True}}]]}"
0,6,101e3e85-0246-4bd4-80be-2df713ee96e6,regular,Get Agent info from ePO,Get hostnames for the Agent GUIDS,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'accessor': 'References.AgentGuid'}}, 'iscontext': True}}]]}"
0,7,ef3c7391-412b-4976-8fc4-f66cbe2607c4,title,Hunt HASH in TIE,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'accessor': 'References.AgentGuid'}}, 'iscontext': True}}]]}"
0,8,4795a873-58e7-4312-83ae-bd7e29d8e8f1,title,Enrich in ePO,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'File', 'accessor': 'References.AgentGuid'}}, 'iscontext': True}}]]}"
0,9,c8baebe6-606d-4e83-88ab-09ac98b1be34,condition,Do we have any files to hunt?,Do we have any files to hunt?,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Hash'}}, 'iscontext': True}}]]}"
0,0,efefff28-b722-4f90-86cf-da4636ecf7f6,start,,,,,,,,
0,3,22f91f1b-ad02-4439-85de-444c9cc9165c,regular,Find Closed Incidents,Searches Demisto incidents to identify closed incidents.,,,,,,
0,4,b28d0033-ac09-4d02-84fc-c6d363d80f51,regular,Generate Summary Report,Generates report summaries for the passed incidents.,,,,,,
0,5,d7525c1a-713e-446c-89d3-f43963155023,regular,Email Reports,Send an email,,,,,,
0,6,93763170-619f-46dc-8b98-4036b015019d,regular,Set Report Done Label,commands.local.cmd.set.incident,,,,,,
0,8,a5d10443-87fb-403d-893a-05723bbc93c5,title,Complete,,,,,,,
0,9,58e69d68-ff03-4356-8b8f-d61f60346c81,condition,Are there relevant closed incidents?,"Checks if there are any incidents without the ReportSent label. Note that the same DT of this task is used in the ""Generate Summary Report"" task.",,,,,,
0,0,3e73293a-7cab-422a-85ea-490384fe3c88,start,,,,,,,,
0,2,ee47ccea-fdc2-4982-8b8e-77cc37a36129,regular,Clear Context,Deletes a field from context.,,,,,,
0,3,7a0c8546-6aad-4d2a-80fc-7da070c87824,regular,Close Incident,commands.local.cmd.close.inv,,,,,,
0,4,cf10b50c-b332-4c19-8961-c5ba96381228,playbook,Send Investigation Summary Reports,,,,,,,
0,0,27fc5e2d-5e47-4d5b-81ef-889cfeb1676e,start,,,,,,,,
0,1,a127bd66-2910-4a57-86b2-e0c36065263c,regular,Get  Host Agent info,,,,,,,
0,2,8a5366c2-6ab4-4eeb-8515-edde825d2f0d,condition,Did we get the Agent info?,,,,,,,
0,3,88cf0630-08b2-4ec8-8dff-a49dc81a9f8c,regular,No Agent was found,,,,,,,
0,4,85bc7a45-7439-417a-84a8-51eebf2753b3,title,Done,,,,,,,
0,5,9300a326-4267-4ade-8870-24310ab4445c,title,Collect info,,,,,,,
0,6,cdb41868-c1b9-471c-8abd-da5ca3cac6e6,regular,Get Processes,Get agent proccesses,,,,,,
0,7,d5db1794-ef8a-400b-8001-7f8f196f602e,condition,Is SentinelOne enabled?,,,,,,,
0,0,18219156-ab84-4e03-8a5d-eaf3f2b5d402,start,,,,,,,,
0,2,3533d2be-a90d-4f93-8630-c169d790254d,regular,Ask questions,Ask the server to parse the question text and choose the first parsed result as the question to run,,,,,,
0,3,d7609125-e21f-4871-8d72-518017ea0b93,regular,"Run a complex Tanium query to find all machines with processes starting with ""EC""",Ask the server to parse the question text and choose the first parsed result as the question to run,,,,,,
0,4,6553c9ee-e178-4084-8718-5e2fdc549fed,regular,Get saved question - Tanium Client Versions,Get a saved question by name or id,,,,,,
0,6,a4aaa5eb-3724-43fe-86e5-c8e7363743ed,regular,Get saved question - Running Applications,Get a saved question by name or id,,,,,,
0,7,474a6415-eb35-4137-8977-c60db94ac520,title,Querying Tanium,,,,,,,
0,8,c6202d75-3923-44df-86e6-a685195739c8,title,Deploying Actions,,,,,,,
0,9,b05fd6d0-3e6d-40a9-81b3-58888214b896,regular,Deploy a Tanium action to enable USB write protect for all hosts,Deploy a package and get the results back,,,,,,
0,0,b18f3f9d-ac23-4f58-82fb-1491f481643a,start,,start,,,,,,
0,1,670f8b6d-a797-4d7d-8452-8a40bfcf0f78,regular,Launch scan,Starts a scan for specified asset IP addresses and host names.,,,,,,
0,5,82b163e2-7cb4-470f-8e98-9eadf532fcd1,title,Done,Final task,,,,,,
0,7,dd208f98-1785-4302-8cec-6234e6370e9f,regular,Get scan report,Returns the specified scan.,,,,,,
0,8,2f2f21f2-0962-4372-857a-1284aa4326bc,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,9,0edc2a4c-4a51-46c6-8752-3a183b11e247,condition,Is Tenable.sc enabled?,Checks wether Nexpose is enabled,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Tenable.sc'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,1f950114-493a-48fb-8a08-f74880f2dbf9,condition,Did scan successfully launch?,Checks wether assets were found,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'TenableSC.ScanResults.ID'}, 'iscontext': True}}]]}"
0,0,edc11302-141f-49c1-84f2-51825c1d1077,start,,,,,,,,
0,1,31641027-ac88-46a3-8324-1c70cb265545,regular,tenable-io-launch-scan,Lauch a scan with existing or custom targets. (You can specify custom targets in the arguements of this command.),,,,,,
0,2,990ff4bf-b662-4e14-83fb-b6654144a57c,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,eb82b29d-6d43-4599-8953-19272e99be00,regular,tenable-io-get-scan-status,Check the status of a specific scan using its ID.,,,,,,
0,4,6e67b464-dd8f-4479-8ad7-017bf2c3aef1,regular,tenable-io-get-scan-report,Retrive scan-report for the given scan.,,,,,,
0,0,b79d975a-a6dc-4a66-8515-c8f4177b0a40,start,,,,,,,,
0,1,1bf80041-9e03-4daf-861c-a709df537687,condition,Is TIE enabled?,,,,,,,
0,2,992f05a8-3c0e-43bc-8f68-b40d2a9542e9,condition,Is ePO enabled?,,,,,,,
0,3,c906e63c-45c5-4540-8f42-b74db1943725,regular,List all agents that the Hash has been executed on,,,,,,,
0,4,c283821d-46ac-4b77-8728-9bc136f0c729,title,Done,,,,,,,
0,5,adfc3709-ca91-4ac0-8c2b-179c44d30403,condition,Did we find any relevant agents?,,,,,,,
0,6,6b8b1d0c-fae5-4779-83a2-9b0e5edbd983,regular,Get Agent info from ePO,,,,,,,
0,7,a08baee9-a402-4bc8-8cae-77c4c144d889,title,Hunt HASH in TIE,,,,,,,
0,8,1df1aefe-fce4-4fb8-80e0-3fbef311f772,title,Enrich in ePO,,,,,,,
0,0,69404add-8bf9-47e4-856a-6ec6bb0392ac,start,start_task,,,,,,,
0,3,298ceaf9-dc7a-42b8-8098-1dff19e59954,title,Get host Anti-malware history,,,,,,,
0,4,e6a64a93-733d-40f6-8407-639879085a0d,regular,Get host ID,"Returns the host ID

The hostname is extracted from the context item: ""incident.labels.Classifier/Hostname""
The hostID is saved to the context item: ""incident.labels.HostID""",,,,,,
0,5,f27d7ba9-428d-4f4c-8e2a-87c2edcca7aa,regular,Trendmicro AntiMalware Event Retrieve,Returns the Malware events from the past 7 days,,,,,,
0,6,d4b2f5fc-cf4b-4481-8ea0-39562a33bb3a,title,Isolate machine,,,,,,,
0,7,3c5cfe20-5678-44a6-88db-e67a3f91aedd,condition,Isolate machine?,Should the server activate a policy on the endpoint machine that will isolate it from the network?,,,,,,
0,8,bfe95a74-e98d-492e-8a64-890c502e252c,regular,Get isolation policy's ID,"Retrieve the isolation policy's ID from server

'Policy' argument is the name of the policy inside Trend Micro UI (user should add it manually).",,,,,,
0,9,222d4517-2865-4811-8a95-dc592841805f,regular,Assign Isolation policy to machine,,,,,,,
0,0,8ec1d86f-9108-44d5-8c64-49fa9294f043,start,,,,,,,,
0,16,53e529ea-dc35-4f97-84ae-f0b0d471aa8e,condition,Do we have URLs?,do we have a url to check,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,20,8fcb9133-0893-4133-8602-a26947510691,regular,Get URLs reputation,Run reputation for the given url,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,24,86cea036-b5bf-40d7-86f9-278a0e1d5557,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,25,3d331702-e1e3-4106-86dc-d88714dfc19f,condition,Is Rasterize integration enabled? ,Check if we can use rasterize,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,26,da3cf2fe-f7e1-4d46-8fb6-45739ae10f7b,regular,Get URL screenshot,Get the screenshot of the url page,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,27,a8b035c8-713a-4eb7-8e8d-fe1c5adc790a,condition,Should the system take the URLs screenshots?,"Check if the Rasterize input equals to ""True"" ",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,28,1db2760c-e81e-4a9f-80a0-84efb609d3f3,title,Enrich URLs,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,29,c5661851-815e-4a10-8476-a968c41eb6e9,title,Take Screenshots,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,30,bb725dfb-4d4c-4428-8a8c-63c117d350fa,title,URL reputation,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,31,f7cbd050-2f16-4d62-84d1-0dcef6c8a64a,title,Verify URLs,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,32,e0e0aaf2-da6f-4b4c-8fc0-87b0474c5707,regular,URL SSL Verification,Verify URL SSL certificate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,33,3f10b64b-59b0-4968-8ec6-e66911654ec0,condition,Should the system verify the URLs?,"Check if the VerifyURL input equals to ""True"" ",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.VerifyURL'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,34,a283aea5-6246-483c-893e-5ade81c0d073,condition,Should the system get the URL Reputation?,"Should the system retrieve the url reputation from all of the relevant integration?
Default: True
 ",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.GetReputation'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,35,d2ef3a60-d0bd-4368-8cb2-bfede3130f58,title,Enrich using Virus Total Private API,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.GetReputation'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,36,d28f230f-511e-490f-821c-387389336800,condition,Is Virus Total Private API enabled?,Checks if there is an active instance of the Virus Total Private API enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,37,552cab93-1b17-405d-8741-84ce788d53d9,regular,Get URL report form Virus Total Private API,"Retrieves a report for a given URL.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,5bb202fa-1827-4e39-8a73-316bf8ef7ad4,start,,,,,,,,
0,16,e3b6529a-31c3-4a37-8a9f-8982ce2bd1aa,condition,Do we have URLs?,do we have a url to check,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,20,22884d3e-bf75-482f-8dcf-514787f23c6f,regular,Get URLs reputation,Run reputation for the given url,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,24,ffb0e416-85ae-486b-8cea-2979aca56172,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,25,a1a1913e-52b1-4cc2-86e0-2e7ce6ede739,condition,Is Rasterize integration enabled? ,Check if we can use rasterize,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,26,16e5f31f-47e2-4ffc-81d7-700415cd78aa,regular,Get URL screenshot,Get the screenshot of the url page,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'simple': 'inputs.url'}, 'iscontext': True}}]]}"
0,27,9f59abc9-ab60-46a5-8c76-39a044a6b8e9,condition,Should the system take the URLs screenshots?,"Check if the Rasterize input equals to ""True"" ",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,28,50dca04a-9bf6-4f56-8d3d-50d87a1b7df2,title,Enrich URLs,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,29,551589fe-87f8-4b47-8865-304283d81363,title,Take Screenshots,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,30,3e51b603-c5de-478f-8364-86280835b671,title,URL reputation,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,31,f752ee26-6b8a-4bff-836b-21d8e3c803ec,title,Verify URLs,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,32,fc2d0d25-7f80-4202-8c44-7444ad0959cd,regular,URL SSL Verification,Verify URL SSL certificate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,33,270fb89c-f46b-4a8d-8a97-2e091fb422fd,condition,Should the system verify the URLs?,"Check if the VerifyURL input equals to ""True"" ",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'string.isEqual', 'left': {'value': {'complex': {'root': 'inputs.VerifyURL'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,0,8ec1d86f-9108-44d5-8c64-49fa9294f043,start,,,,,,,,
0,16,7bc8f493-84d1-4d5e-8bfc-64db0cab685c,condition,Are there URLs?,Determine whtether the playbook's input contains at least one URL.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,24,86cea036-b5bf-40d7-86f9-278a0e1d5557,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,25,b5ea6e49-a7eb-49d7-8398-3087829d7aee,condition,Is Rasterize integration enabled? ,Checks if there is an active instance of the Rasterize integration enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,26,16f823c3-bd44-4fa9-879c-385ac3a21582,regular,Get URL screenshot,Gets a screenshot of the URL page.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.URL'}, 'iscontext': True}}]]}"
0,27,f4894996-e946-44e3-8405-95efb847e7cb,condition,Capture screenshots of the URL?,"Checks if the playbook's Rasterize input is set to ""True"", which determines whether screenshots of the URLs are created.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,29,bf3d5a2f-6be9-4625-80df-e679e2e3e8ef,title,URL Screenshots,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,31,35491163-4370-45fb-87d1-5de849f33eb0,title,URL Verification,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,32,c1f28ba3-01a8-49c1-8526-f019649a5400,regular,Verify SSL for URLs,Verify URL SSL certificate,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.Rasterize'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,33,f2ea80eb-2dc7-4939-8962-bbbbf052af6a,condition,Verify URLs?,"Checks if the playbook's VerifyURL input is set to ""True"", to determine whether to perform SSL verification on the URLs.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.VerifyURL'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,34,aeefcfba-7860-4d19-8785-b3a80a660e4b,title,VirusTotal Private API Enrichment,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isEqualString', 'left': {'value': {'complex': {'root': 'inputs.VerifyURL'}}, 'iscontext': True}, 'right': {'value': {'simple': 'True'}}, 'ignorecase': True}]]}"
0,35,04fb60ca-4713-4a4e-854f-70f28ff6bbe0,condition,Is Virus TotalPrivate API enabled?,"Checks if there is an active instance of the VirusTotal Private API integration enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,36,42285b15-afd4-4163-8b9d-20adc26e11a9,regular,Get URL report from VirusTotal Private API,Retrieves a report from VirusTotal API for a specified URL.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,37,1515fb6b-457d-4bcd-8da5-47cec04bde81,title,No URLs,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'VirusTotal - Private API'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,c1de2f2b-64cb-4df5-8490-07c49e7255b6,start,,start,,,,,,
0,1,7421a2fc-d22a-41f9-8876-e7735d25ea6b,playbook,GenericPolling,"Use as a sub-playbook to block execution of the master playbook until a remote action is complete.
This playbook implements polling by continually running the command in Step #2 until the operation completes.
The remote action should have the following structure:

1. Initiate the operation.
2. Poll to check if the operation completed.
3. (optional) Get the results of the operation.",,,,,,
0,3,4216b614-64bb-4a43-8cd8-e24b6b85efd9,condition,Is there any active VMRay instance?,Check for active instance,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'vmray'}}}], [{'operator': 'isEqualString', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,087ea815-c0b4-4604-8b43-099927639fa9,condition,Is there any file to detonate?,Check if file exist,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,6,46c971ef-9691-4b18-888b-a8fccf7b8c7c,regular,Send file to VMRay,Submit sample to VMRay,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,7,b5eb756b-903d-4f8e-8b09-f8bcad28627c,title,Done,Done,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,8,2a0709fc-42f1-4ac8-80ef-aa53b3b65576,regular,Get sample,get sample by sample id,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,10,ca3caa5c-0828-41e1-8b12-77771fdaf140,regular,Get submission,Gets a submission result,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,11,1735cc5d-e223-47ea-8905-51616bed94f1,regular,Get analysis,Retrieves all analysis details for a specified sample.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'simple': 'inputs.File'}, 'iscontext': True}}]]}"
0,12,d9177a3a-b705-45af-8b42-7ee487c17eda,condition,Is analysis suspicious or malicious?,check term,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'VMRay', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'VMRay.Sample.Severity'}, 'iscontext': True}, 'right': {'value': {'simple': 'Malicious'}}}]], 'accessor': 'Analysis.Severity'}}, 'iscontext': True}}, {'operator': 'isExists', 'left': {'value': {'complex': {'root': 'VMRay', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'VMRay.Sample.Severity'}, 'iscontext': True}, 'right': {'value': {'simple': 'Suspicious'}}}]], 'accessor': 'Analysis.Severity'}}, 'iscontext': True}}]]}"
0,13,c935d709-7974-4075-85a5-13e24aa25cdd,regular,Get IOCs,Retrieves indicators of compropmise for a specified sample.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'VMRay', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'VMRay.Sample.Severity'}, 'iscontext': True}, 'right': {'value': {'simple': 'Malicious'}}}]], 'accessor': 'Analysis.Severity'}}, 'iscontext': True}}, {'operator': 'isExists', 'left': {'value': {'complex': {'root': 'VMRay', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'VMRay.Sample.Severity'}, 'iscontext': True}, 'right': {'value': {'simple': 'Suspicious'}}}]], 'accessor': 'Analysis.Severity'}}, 'iscontext': True}}]]}"
0,14,ba1da627-1586-48db-8717-1c98e46a6178,regular,Get Thread Indicators,Retrieves threat indicators (VTI).,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'isExists', 'left': {'value': {'complex': {'root': 'VMRay', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'VMRay.Sample.Severity'}, 'iscontext': True}, 'right': {'value': {'simple': 'Malicious'}}}]], 'accessor': 'Analysis.Severity'}}, 'iscontext': True}}, {'operator': 'isExists', 'left': {'value': {'complex': {'root': 'VMRay', 'filters': [[{'operator': 'isEqualString', 'left': {'value': {'simple': 'VMRay.Sample.Severity'}, 'iscontext': True}, 'right': {'value': {'simple': 'Suspicious'}}}]], 'accessor': 'Analysis.Severity'}}, 'iscontext': True}}]]}"
0,0,d127e66f-7ade-4b3c-8ba2-60857698d3ee,start,,,,,,,,
0,1,356935d6-9ca3-4c10-8518-ce37b1eb878b,condition,Is Nexpose enabled?,Verify that there's a valid instance of Nexpose enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,2,d0ea9b16-8e93-468a-8311-68805bbbe5e5,title,Get vulnerability details from Nexpose,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,3,d553fc72-9bac-44e3-8c03-c295acd17f44,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,4,8cff4db4-a188-42e4-84a4-d973febd4ea0,regular,Get asset information,Get asset metadata from Nexpose based on asset ID.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,5,d17a5f7c-9bc4-4448-8b62-61efa02ca003,regular,Get Vulnerability information,Get vulnerability metadata from Nexpose based on vulnerability ID.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,6,206d337a-bae4-409c-890f-6a9fc6c28a5f,title,Enrich Entities,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,7,4181e6a6-959a-472e-8e61-a254d9f5673e,playbook,CVE Enrichment - Generic,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,8,b5894d35-8b97-4469-845b-4abdc660c56a,playbook,Endpoint Enrichment - Generic,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,9,df0d00fa-f883-4c1b-816d-bacd8a184730,regular,Set custom fields,"Set the information retrieved from Nexpose into the vulnerability incident custom fields:
* Vulnerability Category
* CVE
* CVSS
* Signature",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,10,351a2cef-df14-4458-8deb-ca7c26c1b89b,title,Remediate,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,11,9a35d0f2-951b-4dfe-82ee-552342d5ed00,playbook,Calculate Severity - Generic,"Calculates and assign the incident severity based on the highest returned severity level from the following severity calculations:

* Indicators DBotScore - Calculates the incident severity level according to the highest indicator DBotScore.
* Critical assets - Determines if a critical assest is associated with the invesigation.
* 3rd-party integrations - Calculates the incident severity level according to the methodology of a 3rd-party integration.

NOTE: the new severity level overwrites the previous severity level even if the previous severity level was more severe.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,12,a469ee6e-9487-4e94-828b-72a7c5f439d9,regular,Remediate the vulnerability ,"Manually remediate the vulnerability using the remediation notes from Nexpose.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,13,3cc3fdfa-3601-49c5-82e6-56dffc6ecda1,regular,Close investigation,Close the investigation.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,0,70a808bd-c5f5-4a34-8e73-7bd426ea3c48,start,,,,,,,,
0,1,c028a317-3e87-4ee2-85c9-53754152340d,regular,Get Asset information,Get asset metadata from Qualys based on Asset ID.,,,,,,
0,2,a0bb5b2f-f89a-48ec-8cef-70477b2adf1e,regular,Get Vulnerability information,Get vulnerability metadata from Qualys based on QID.,,,,,,
0,3,f557cc38-4b4e-4beb-88fa-55a1c6cc3de6,title,Mark important notes,,,,,,,
0,4,cdbea748-55ef-48c7-8e82-df37a53667ff,title,Enrich Entities,,,,,,,
0,5,d75db3b1-aeec-44f1-88c9-fb782f8f0291,regular,Display diagnosis ,Display the diagnosis HTML in the War Room.,,,,,,
0,6,3a0acb6e-cd22-42b7-86cf-2c0c638d6e41,condition,Is there a diagnosis for the vulnerability?,Verify that there's a diagnosis for the detected vulnerability in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Qualys', 'accessor': 'Diagnosis'}}, 'iscontext': True}}]]}"
0,7,58ab86c1-fd77-4a67-8804-2e8cc87eedb4,title,Remediate,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Qualys', 'accessor': 'Diagnosis'}}, 'iscontext': True}}]]}"
0,10,01d06edb-b109-4ce1-8618-ad49f8f33648,playbook,Endpoint Enrichment - Generic,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Qualys', 'accessor': 'Diagnosis'}}, 'iscontext': True}}]]}"
0,11,60d2a53c-3ae5-453f-875a-1203347f16e7,playbook,CVE Enrichment - Generic,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Qualys', 'accessor': 'Diagnosis'}}, 'iscontext': True}}]]}"
0,12,a7ff415a-8066-4f3c-826c-5c6f840075f2,condition,Is Qualys enabled?,Verify that there's a valid instance of Qualys enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,14,65d23550-509d-4f8b-8f31-a9ec236d59d0,regular,Remediate the vulnerability ,Manually remediate the vulnerability using the remediation note from Qualys.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,15,fd70751e-253f-404b-8820-e63a3eff0d68,regular,Close Investigation,Close the investigation.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,17,2d483c30-2066-4696-82f9-781aa207df9f,title,Get incident information from Qualys,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,18,ab94f99a-9546-4837-8ed9-cfe970154bea,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,19,3e271fab-839e-4253-8aa9-f8579c607fd6,playbook,Vulnerability Management - Qualys - Add custom fields,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,20,cd0cd64a-046d-467f-836f-3afa1f8e5acf,playbook,Calculate Severity - Generic,"Calculate incident severity by indicators reputation and user/endpoint membership in critical groups.

Note - current severity will be overwritten and new severity may be lower than the current one.

Playbook inputs:
* CriticalUsers - Comma separated array with usernames of critical users
* CriticalEndpoints - Comma separated array with hostnames of critical endpoints
* CriticalGroups - Comma separated array with DN of critical Active Directory groups",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,21,e70ad3fc-4274-4b7b-8e05-564266f65b2e,condition,Is there a consequence for the vulnerability?,Verify that there's a consequence for the detected vulnerability in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Qualys', 'accessor': 'Consequence'}}, 'iscontext': True}}]]}"
0,22,85f071de-346c-4cf6-8a54-6bef8b32e3c1,regular,Display consequence,Display the remediation HTML in the War Room.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Qualys', 'accessor': 'Consequence'}}, 'iscontext': True}}]]}"
0,23,e142b442-105b-4016-8d77-40eb431e5503,condition,Is there a remediation for the vulnerability?,Verify that there's a remediation for the detected vulnerability in context.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Qualys', 'accessor': 'Solution'}}, 'iscontext': True}}]]}"
0,24,e9c369da-0f47-4243-8628-c8f959084f2d,regular,Display remediation,Display the remediation HTML in the War Room.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'Qualys', 'accessor': 'Solution'}}, 'iscontext': True}}]]}"
0,0,7c0a6113-ccc4-4b67-8ae0-5b6ebed288fb,start,,,,,,,,
0,2,2115cdff-522d-4787-822c-39684be05294,title,Done,,,,,,,
0,3,8e4fc911-843f-47ff-8a54-1b3efb8470b8,regular,"Set ""Vulnerability Category""",Populate the custom field.,,,,,,
0,8,e041a676-db54-4695-8ecd-34befbfbc79c,regular,"Set ""Signature""",Populate the custom field.,,,,,,
0,9,7c7cb394-27b8-470b-8503-fca384538827,regular,"Set ""Bugtraq""",Populate the custom field.,,,,,,
0,11,b79b6492-0fe9-47ea-8712-25e67bb05384,regular,"Set ""CVE""",Populate the custom field.,,,,,,
0,13,12f3c186-65f1-41b8-89bb-b2e47b2b358b,regular,"Set ""CVSS""",Populate the custom field.,,,,,,
0,15,e23eb213-9603-4c62-8825-9c3fb601e139,condition,"Is there a valid ""Vulnerability Category""?","Check if there’s a ""Vulnerability Category"" in the playbook inputs.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Qualys', 'accessor': 'Category'}}, 'iscontext': True}}]]}"
0,17,6c1b4f4a-5d12-4d78-81d3-02892cc3ad37,condition,"Is there a valid ""CVSS""?","Check if there’s a ""CVSS"" in the playbook inputs.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.CVE', 'accessor': 'CVSS'}}, 'iscontext': True}}]]}"
0,18,360bab9f-806f-48c0-8080-fbbbe2efd466,condition,"Is there a valid ""CVE""?","Check if there’s a ""CVE"" in the playbook inputs.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.CVE', 'accessor': 'ID'}}, 'iscontext': True}}]]}"
0,19,19976cc4-28dd-4594-8972-1c512a7dd3f5,condition,"Is there a valid ""Signature""?","Check if there’s a ""Signature"" in the playbook inputs.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Qualys', 'accessor': 'Title'}}, 'iscontext': True}}]]}"
0,20,a3def47b-593f-4a87-8ce5-356ad232dc95,condition,"Is there a valid ""Bugtraq""?","Check if there’s a ""Bugtraq"" in the playbook inputs.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'inputs.Qualys', 'accessor': 'Bugtraq.ID'}}, 'iscontext': True}}]]}"
0,0,262846f7-b22f-4bb4-8726-c0e9908239c7,start,,,,,,,,
0,1,705f459e-8a36-425a-8895-9acb80e6590a,regular,Get assets' information,Query Nexpose for the assets' information.,,,,,,
0,2,f0e9c893-d62c-44d7-8d7a-505f13d19c9c,title,Enrich assets,,,,,,,
0,3,59f0f9f6-ddfa-44ef-8768-6754855f9efb,regular,Get assets' reports,Query Nexpose for the latest assets' reports.,,,,,,
0,5,a9c0c0e6-55eb-4f19-8c8b-675bcdb21138,condition,Is Nexpose enabled?,"Verify that there is a valid instance of Nexpose enabled.
",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,6,15066fb2-3cbe-448c-8cdf-f6560d23a013,title,Close investigation,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,7,f893f0f5-10ea-43ea-8fc7-53a9e51d0e6c,title,Create incidents,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,8,8cac3cd1-2a87-45a5-8456-30991f126957,regular,Create Incidents for assets and vulnerabilities,"Create incidents based on the Nexpose asset ID and vulnerability ID.
Duplicate incidents are not created for the same asset ID and vulnerability ID.",,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,9,100c24b9-566a-4dc6-8e41-ed1de7ed8a32,regular,Close investigation,Close the investigation,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,10,d6469ba0-ed85-42d0-80e6-770fe1ca044a,title,Done,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Rapid7 Nexpose'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}, 'ignorecase': True}]]}"
0,0,44eb6f9d-29e2-449e-85fd-2077af1ff45e,start,,,,,,,,
0,2,1471cc73-16be-429c-8619-b07e7e7271ba,regular,Get Qualys reports list,Retrieve a list of all reports from Qualys. Can be filtered by the `expires_before_datetime` parameter.,,,,,,
0,3,4ae94d3c-f26b-4d09-89a7-7e2d087a5549,condition,Is there a valid report?,Check if there's a Qualys report that matches the input report name and is in XML format.,,,,,,"{'label': 'YES', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'QualysReport', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.Title'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.QualysReportTitle'}, 'iscontext': True}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.Status.State'}, 'iscontext': True}, 'right': {'value': {'simple': 'Finished'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.OutputFormat'}, 'iscontext': True}, 'right': {'value': {'simple': 'XML'}}}]], 'accessor': 'ID'}}, 'iscontext': True}}]]}"
0,5,03b60980-2f8f-4dc6-830e-781a10150988,title,Done,,,,,,,"{'label': 'YES', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'QualysReport', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.Title'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.QualysReportTitle'}, 'iscontext': True}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.Status.State'}, 'iscontext': True}, 'right': {'value': {'simple': 'Finished'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.OutputFormat'}, 'iscontext': True}, 'right': {'value': {'simple': 'XML'}}}]], 'accessor': 'ID'}}, 'iscontext': True}}]]}"
0,7,73f17571-d171-4ba5-8cd0-d4b39cfd62ab,title,Create incidents from the Qualys report,,,,,,,"{'label': 'YES', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'QualysReport', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.Title'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.QualysReportTitle'}, 'iscontext': True}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.Status.State'}, 'iscontext': True}, 'right': {'value': {'simple': 'Finished'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.OutputFormat'}, 'iscontext': True}, 'right': {'value': {'simple': 'XML'}}}]], 'accessor': 'ID'}}, 'iscontext': True}}]]}"
0,8,a898c316-7a9a-4c01-8984-e02c4a572a17,regular,Create incidents from the Qualys report,"Create incidents from a Qualys report (XML), based on the Qualys asset ID and vulnerability ID (QID).
Duplicate incidents are not created for the same asset ID and QID.",,,,,,"{'label': 'YES', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'QualysReport', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.Title'}, 'iscontext': True}, 'right': {'value': {'simple': 'inputs.QualysReportTitle'}, 'iscontext': True}}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.Status.State'}, 'iscontext': True}, 'right': {'value': {'simple': 'Finished'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'QualysReport.OutputFormat'}, 'iscontext': True}, 'right': {'value': {'simple': 'XML'}}}]], 'accessor': 'ID'}}, 'iscontext': True}}]]}"
0,10,7bd9b687-d830-4ef7-8f2c-11430ace9299,condition,Is Qualys enabled?,Verify that there's a valid instance of Qualys enabled.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,11,4e17432e-44c3-41c2-8c3a-50b477ac0d64,regular,Get report,Retrieve the report from Qualys.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,12,760d26bf-1cf0-453e-874d-6289febaf523,regular,Set context,Set the Qualys reports list into context. ,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,14,f6e8fab3-d733-4383-8969-f1db2e0850b6,regular,Close Investigation,Close the investigation.,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
0,15,d810fa86-61da-49c6-84c6-1216e66f77bb,title,Get report from Qualys,,,,,,,"{'label': 'yes', 'condition': [[{'operator': 'general.isExists', 'left': {'value': {'complex': {'root': 'modules', 'filters': [[{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.brand'}, 'iscontext': True}, 'right': {'value': {'simple': 'Qualys'}}, 'ignorecase': True}], [{'operator': 'string.isEqual', 'left': {'value': {'simple': 'modules.state'}, 'iscontext': True}, 'right': {'value': {'simple': 'active'}}, 'ignorecase': True}]], 'accessor': 'brand'}}, 'iscontext': True}}]]}"
